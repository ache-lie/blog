<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>NodeJså­¦ä¹ ç¬”è®°(ä¸‹) | acheğŸ‰</title><meta name="author" content="ache"><meta name="copyright" content="ache"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="npmä¸åŒ…åŒ…åŒ…çš„æ¥æº ä¸åŒäº Node.js ä¸­çš„å†…ç½®æ¨¡å—ä¸è‡ªå®šä¹‰æ¨¡å—ï¼ŒåŒ…æ˜¯ç”±ç¬¬ä¸‰æ–¹ä¸ªäººæˆ–å›¢é˜Ÿå¼€å‘å‡ºæ¥çš„ï¼Œå…è´¹ä¾›æ‰€æœ‰äººä½¿ç”¨ã€‚ æ³¨æ„ï¼šNode.js ä¸­çš„åŒ…éƒ½æ˜¯å…è´¹ä¸”å¼€æºçš„ï¼Œä¸éœ€è¦ä»˜è´¹å³å¯å…è´¹ä¸‹è½½ä½¿ç”¨ã€‚  ä¸ºä»€ä¹ˆéœ€è¦åŒ… ç”±äº Node.js çš„å†…ç½®æ¨¡å—ä»…æä¾›äº†ä¸€äº›åº•å±‚çš„ APIï¼Œå¯¼è‡´åœ¨åŸºäºå†…ç½®æ¨¡å—è¿›è¡Œé¡¹ç›®å¼€å‘çš„æ—¶ï¼Œæ•ˆç‡å¾ˆä½ã€‚ åŒ…æ˜¯åŸºäºå†…ç½®æ¨¡å—å°è£…å‡ºæ¥çš„ï¼Œæä¾›äº†æ›´é«˜çº§ã€æ›´æ–¹ä¾¿çš„ APIï¼Œæå¤§çš„æé«˜äº†">
<meta property="og:type" content="article">
<meta property="og:title" content="NodeJså­¦ä¹ ç¬”è®°(ä¸‹)">
<meta property="og:url" content="https://ache-lie.github.io/blog/2023/03/29/29-NodeJs-2/index.html">
<meta property="og:site_name" content="acheğŸ‰">
<meta property="og:description" content="npmä¸åŒ…åŒ…åŒ…çš„æ¥æº ä¸åŒäº Node.js ä¸­çš„å†…ç½®æ¨¡å—ä¸è‡ªå®šä¹‰æ¨¡å—ï¼ŒåŒ…æ˜¯ç”±ç¬¬ä¸‰æ–¹ä¸ªäººæˆ–å›¢é˜Ÿå¼€å‘å‡ºæ¥çš„ï¼Œå…è´¹ä¾›æ‰€æœ‰äººä½¿ç”¨ã€‚ æ³¨æ„ï¼šNode.js ä¸­çš„åŒ…éƒ½æ˜¯å…è´¹ä¸”å¼€æºçš„ï¼Œä¸éœ€è¦ä»˜è´¹å³å¯å…è´¹ä¸‹è½½ä½¿ç”¨ã€‚  ä¸ºä»€ä¹ˆéœ€è¦åŒ… ç”±äº Node.js çš„å†…ç½®æ¨¡å—ä»…æä¾›äº†ä¸€äº›åº•å±‚çš„ APIï¼Œå¯¼è‡´åœ¨åŸºäºå†…ç½®æ¨¡å—è¿›è¡Œé¡¹ç›®å¼€å‘çš„æ—¶ï¼Œæ•ˆç‡å¾ˆä½ã€‚ åŒ…æ˜¯åŸºäºå†…ç½®æ¨¡å—å°è£…å‡ºæ¥çš„ï¼Œæä¾›äº†æ›´é«˜çº§ã€æ›´æ–¹ä¾¿çš„ APIï¼Œæå¤§çš„æé«˜äº†">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s1.ax1x.com/2023/03/29/ppgU1oR.jpg">
<meta property="article:published_time" content="2023-03-29T15:00:25.000Z">
<meta property="article:modified_time" content="2023-04-05T03:31:28.452Z">
<meta property="article:author" content="ache">
<meta property="article:tag" content="NodeJs">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s1.ax1x.com/2023/03/29/ppgU1oR.jpg"><link rel="shortcut icon" href="https://s1.ax1x.com/2023/03/18/ppJu8S0.jpg"><link rel="canonical" href="https://ache-lie.github.io/blog/2023/03/29/29-NodeJs-2/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/blog/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/blog/',
  algolia: undefined,
  localSearch: {"path":"/blog/search.xml","preload":true,"languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"ç¹","msgToSimplifiedChinese":"ç®€"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":230},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"ä½ å·²åˆ‡æ¢ä¸ºç¹ä½“","cht_to_chs":"ä½ å·²åˆ‡æ¢ä¸ºç®€ä½“","day_to_night":"ä½ å·²åˆ‡æ¢ä¸ºæ·±è‰²æ¨¡å¼","night_to_day":"ä½ å·²åˆ‡æ¢ä¸ºæµ…è‰²æ¨¡å¼","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"top-right"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'NodeJså­¦ä¹ ç¬”è®°(ä¸‹)',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-04-05 11:31:28'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-double-row-display@1.00/cardlistpost.min.css"/>
<style>#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags:before {content:"\A";
  white-space: pre;}#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags > .article-meta__separator{display:none}</style>
<link rel="stylesheet" href="https://www.fomal.cc/static/css/runtime.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload="this.media='all'"><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/animate.min.css" media="print" onload="this.media='all'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.ax1x.com/2023/03/21/ppapDzD.jpg" onerror="onerror=null;src='https://s1.ax1x.com/2023/03/21/ppa9dmj.jpg'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/blog/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">8</div></a><a href="/blog/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">7</div></a><a href="/blog/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">0</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/blog/"><i class="fa-fw icon-home"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-home"></use></svg><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/blog/archives/"><i class="fa-fw icon-guidang"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-guidang"></use></svg><span> å½’æ¡£</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/blog/tags/"><i class="fa-fw icon-icon_pricetag"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-icon_pricetag"></use></svg><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/blog/categories/"><i class="fa-fw icon-fenlei"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-fenlei"></use></svg><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-liebiao"></use></svg><span> åˆ—è¡¨</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/blog/music/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-yinlehe">                   </use></svg><span> éŸ³ä¹</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/blog/movies/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-dianying">                   </use></svg><span> ç”µå½±</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/blog/comments/"><i class="fa-fw icon-liuyanban"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-liuyanban"></use></svg><span> ç•™è¨€æ¿</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/blog/link/"><i class="fa-fw icon-lianjie"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-lianjie"></use></svg><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/blog/about/"><i class="fa-fw icon-xinxingcao"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-xinxingcao"></use></svg><span> å…³äº</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://s1.ax1x.com/2023/03/29/ppgUaOe.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/blog/">acheğŸ‰</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i></a></div><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/blog/"><i class="fa-fw icon-home"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-home"></use></svg><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/blog/archives/"><i class="fa-fw icon-guidang"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-guidang"></use></svg><span> å½’æ¡£</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/blog/tags/"><i class="fa-fw icon-icon_pricetag"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-icon_pricetag"></use></svg><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/blog/categories/"><i class="fa-fw icon-fenlei"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-fenlei"></use></svg><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-liebiao"></use></svg><span> åˆ—è¡¨</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/blog/music/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-yinlehe">                   </use></svg><span> éŸ³ä¹</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/blog/movies/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-dianying">                   </use></svg><span> ç”µå½±</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/blog/comments/"><i class="fa-fw icon-liuyanban"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-liuyanban"></use></svg><span> ç•™è¨€æ¿</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/blog/link/"><i class="fa-fw icon-lianjie"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-lianjie"></use></svg><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/blog/about/"><i class="fa-fw icon-xinxingcao"></i><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-xinxingcao"></use></svg><span> å…³äº</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">NodeJså­¦ä¹ ç¬”è®°(ä¸‹)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2023-03-29T15:00:25.000Z" title="å‘è¡¨äº 2023-03-29 23:00:25">2023-03-29</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2023-04-05T03:31:28.452Z" title="æ›´æ–°äº 2023-04-05 11:31:28">2023-04-05</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">33k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>125åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="NodeJså­¦ä¹ ç¬”è®°(ä¸‹)"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><hr>
<h3 id="npmä¸åŒ…"><a href="#npmä¸åŒ…" class="headerlink" title="npmä¸åŒ…"></a>npmä¸åŒ…</h3><h4 id="åŒ…"><a href="#åŒ…" class="headerlink" title="åŒ…"></a>åŒ…</h4><h5 id="åŒ…çš„æ¥æº"><a href="#åŒ…çš„æ¥æº" class="headerlink" title="åŒ…çš„æ¥æº"></a>åŒ…çš„æ¥æº</h5><blockquote>
<p>ä¸åŒäº Node.js ä¸­çš„å†…ç½®æ¨¡å—ä¸è‡ªå®šä¹‰æ¨¡å—ï¼ŒåŒ…æ˜¯ç”±ç¬¬ä¸‰æ–¹ä¸ªäººæˆ–å›¢é˜Ÿå¼€å‘å‡ºæ¥çš„ï¼Œå…è´¹ä¾›æ‰€æœ‰äººä½¿ç”¨ã€‚ æ³¨æ„ï¼šNode.js ä¸­çš„åŒ…éƒ½æ˜¯å…è´¹ä¸”å¼€æºçš„ï¼Œä¸éœ€è¦ä»˜è´¹å³å¯å…è´¹ä¸‹è½½ä½¿ç”¨ã€‚</p>
</blockquote>
<h5 id="ä¸ºä»€ä¹ˆéœ€è¦åŒ…"><a href="#ä¸ºä»€ä¹ˆéœ€è¦åŒ…" class="headerlink" title="ä¸ºä»€ä¹ˆéœ€è¦åŒ…"></a>ä¸ºä»€ä¹ˆéœ€è¦åŒ…</h5><blockquote>
<p>ç”±äº Node.js çš„å†…ç½®æ¨¡å—ä»…æä¾›äº†ä¸€äº›åº•å±‚çš„ APIï¼Œå¯¼è‡´åœ¨åŸºäºå†…ç½®æ¨¡å—è¿›è¡Œé¡¹ç›®å¼€å‘çš„æ—¶ï¼Œæ•ˆç‡å¾ˆä½ã€‚ åŒ…æ˜¯åŸºäºå†…ç½®æ¨¡å—å°è£…å‡ºæ¥çš„ï¼Œæä¾›äº†æ›´é«˜çº§ã€æ›´æ–¹ä¾¿çš„ APIï¼Œæå¤§çš„æé«˜äº†å¼€å‘æ•ˆç‡ã€‚ åŒ…å’Œå†…ç½®æ¨¡å—ä¹‹é—´çš„å…³ç³»ï¼Œç±»ä¼¼äº jQuery å’Œ æµè§ˆå™¨å†…ç½® API ä¹‹é—´çš„å…³ç³»ã€‚</p>
</blockquote>
<h5 id="ä»å“ªé‡Œä¸‹è½½åŒ…"><a href="#ä»å“ªé‡Œä¸‹è½½åŒ…" class="headerlink" title="ä»å“ªé‡Œä¸‹è½½åŒ…"></a>ä»å“ªé‡Œä¸‹è½½åŒ…</h5><blockquote>
<p>å›½å¤–æœ‰ä¸€å®¶ IT å…¬å¸ï¼Œå«åš npm, Inc. è¿™å®¶å…¬å¸æ——ä¸‹æœ‰ä¸€ä¸ªéå¸¸è‘—åçš„ç½‘ç«™ï¼š <a target="_blank" rel="noopener" href="https://www.npmjs.com/">https://www.npmjs.com/</a> ï¼Œå®ƒæ˜¯å…¨çƒæœ€ å¤§çš„åŒ…å…±äº«å¹³å°ï¼Œä½ å¯ä»¥ä»è¿™ä¸ªç½‘ç«™ä¸Šæœç´¢åˆ°ä»»ä½•ä½ éœ€è¦çš„åŒ…ï¼Œåªè¦ä½ æœ‰è¶³å¤Ÿçš„è€å¿ƒï¼ </p>
<p>åˆ°ç›®å‰ä½ç½®ï¼Œå…¨çƒçº¦ 1100 å¤šä¸‡çš„å¼€å‘äººå‘˜ï¼Œé€šè¿‡è¿™ä¸ªåŒ…å…±äº«å¹³å°ï¼Œå¼€å‘å¹¶å…±äº«äº†è¶…è¿‡ 120 å¤šä¸‡ä¸ªåŒ… ä¾›æˆ‘ä»¬ä½¿ç”¨ã€‚ npm, Inc. å…¬å¸æä¾›äº†ä¸€ä¸ªåœ°å€ä¸º <a target="_blank" rel="noopener" href="https://registry.npmjs.org/">https://registry.npmjs.org/</a> çš„æœåŠ¡å™¨ï¼Œæ¥å¯¹å¤–å…±äº«æ‰€æœ‰çš„åŒ…ï¼Œæˆ‘ä»¬å¯ä»¥ä»è¿™ä¸ªæœåŠ¡ å™¨ä¸Šä¸‹è½½è‡ªå·±æ‰€éœ€è¦çš„åŒ…ã€‚</p>
</blockquote>
<blockquote>
<p>&#x3D;&#x3D;æ³¨æ„ï¼š&#x3D;&#x3D;</p>
<ol>
<li>ä» <a target="_blank" rel="noopener" href="https://www.npmjs.com/">https://www.npmjs.com/</a> ç½‘ç«™ä¸Šæœç´¢è‡ªå·±æ‰€éœ€è¦çš„åŒ…</li>
<li>ä» <a target="_blank" rel="noopener" href="https://registry.npmjs.org/">https://registry.npmjs.org/</a> æœåŠ¡å™¨ä¸Šä¸‹è½½è‡ªå·±éœ€è¦çš„åŒ…</li>
</ol>
</blockquote>
<h5 id="å¦‚ä½•ä¸‹è½½åŒ…"><a href="#å¦‚ä½•ä¸‹è½½åŒ…" class="headerlink" title="å¦‚ä½•ä¸‹è½½åŒ…"></a>å¦‚ä½•ä¸‹è½½åŒ…</h5><blockquote>
<p>npm, Inc. å…¬å¸æä¾›äº†ä¸€ä¸ªåŒ…ç®¡ç†å·¥å…·ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªåŒ…ç®¡ç†å·¥å…·ï¼Œä» <a target="_blank" rel="noopener" href="https://registry.npmjs.org/">https://registry.npmjs.org/</a> æœåŠ¡å™¨æŠŠéœ€è¦ çš„åŒ…ä¸‹è½½åˆ°æœ¬åœ°ä½¿ç”¨ã€‚</p>
<p> è¿™ä¸ªåŒ…ç®¡ç†å·¥å…·çš„åå­—å«åš Node Package Managerï¼ˆç®€ç§° npm åŒ…ç®¡ç†å·¥å…·ï¼‰ï¼Œè¿™ä¸ªåŒ…ç®¡ç†å·¥å…·éšç€ Node.js çš„å®‰ è£…åŒ…ä¸€èµ·è¢«å®‰è£…åˆ°äº†ç”¨æˆ·çš„ç”µè„‘ä¸Šã€‚ </p>
<p>å¤§å®¶å¯ä»¥åœ¨ç»ˆç«¯ä¸­æ‰§è¡Œ npm -v å‘½ä»¤ï¼Œæ¥æŸ¥çœ‹è‡ªå·±ç”µè„‘ä¸Šæ‰€å®‰è£…çš„ npm åŒ…ç®¡ç†å·¥å…·çš„ç‰ˆæœ¬å·ï¼š</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Microsoft Windows [ç‰ˆæœ¬ 10.0.19044.2728]</span><br><span class="line">(c) Microsoft Corporationã€‚ä¿ç•™æ‰€æœ‰æƒåˆ©ã€‚</span><br><span class="line"></span><br><span class="line">C:\Users\æŸšç¨š&gt;node -v</span><br><span class="line">v16.16.0</span><br><span class="line"></span><br><span class="line">C:\Users\æŸšç¨š&gt;</span><br></pre></td></tr></table></figure>



<h4 id="npm-åˆä½“éªŒ"><a href="#npm-åˆä½“éªŒ" class="headerlink" title="npm åˆä½“éªŒ"></a>npm åˆä½“éªŒ</h4><h5 id="æ ¼å¼åŒ–æ—¶é—´çš„ä¼ ç»Ÿåšæ³•"><a href="#æ ¼å¼åŒ–æ—¶é—´çš„ä¼ ç»Ÿåšæ³•" class="headerlink" title="æ ¼å¼åŒ–æ—¶é—´çš„ä¼ ç»Ÿåšæ³•"></a>æ ¼å¼åŒ–æ—¶é—´çš„ä¼ ç»Ÿåšæ³•</h5><blockquote>
<ol>
<li>åˆ›å»ºæ ¼å¼åŒ–æ—¶é—´çš„è‡ªå®šä¹‰æ¨¡å—</li>
<li>å®šä¹‰æ ¼å¼åŒ–æ—¶é—´çš„æ–¹æ³•</li>
<li>åˆ›å»ºè¡¥é›¶å‡½æ•°</li>
<li>ä»è‡ªå®šä¹‰æ¨¡å—ä¸­å¯¼å‡ºæ ¼å¼åŒ–æ—¶é—´çš„å‡½æ•°</li>
<li>å¯¼å…¥æ ¼å¼åŒ–æ—¶é—´çš„è‡ªå®šä¹‰æ¨¡å—</li>
<li>è°ƒç”¨æ ¼å¼åŒ–æ—¶é—´çš„å‡½æ•°</li>
</ol>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰æ ¼å¼åŒ–æ—¶é—´çš„æ–¹æ³•</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">dataFormat</span>(<span class="params">dtStr</span>)&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> dt = <span class="keyword">new</span> <span class="title class_">Date</span>(dtStr)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> y = dt.<span class="title function_">getFullYear</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> m = <span class="title function_">padZero</span>(dt.<span class="title function_">getMonth</span>() + <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> d = <span class="title function_">padZero</span>(dt.<span class="title function_">getDate</span>())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> hh = <span class="title function_">padZero</span>(dt.<span class="title function_">getHours</span>())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> mm = <span class="title function_">padZero</span>(dt.<span class="title function_">getMinutes</span>())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> ss = <span class="title function_">padZero</span>(dt.<span class="title function_">getSeconds</span>())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;y&#125;</span>-<span class="subst">$&#123;m&#125;</span>-<span class="subst">$&#123;d&#125;</span> <span class="subst">$&#123;hh&#125;</span>:<span class="subst">$&#123;mm&#125;</span>:<span class="subst">$&#123;ss&#125;</span>`</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰è¡¥é›¶çš„å‡½æ•°</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">padZero</span>(<span class="params">n</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> n &gt; <span class="number">9</span> ? n : <span class="string">&#x27;0&#x27;</span>+n</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    dataFormat</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥è‡ªå®šä¹‰çš„æ ¼å¼åŒ–æ—¶é—´çš„æ¨¡å—</span></span><br><span class="line"><span class="keyword">const</span> time = <span class="built_in">require</span>(<span class="string">&#x27;./07_dataFormatä¼ ç»Ÿåšæ³•.js&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// è°ƒç”¨æ–¹æ³•ï¼Œè¿›è¡Œæ—¶é—´çš„æ ¼å¼åŒ–</span></span><br><span class="line"><span class="keyword">const</span> dt = <span class="keyword">new</span> <span class="title class_">Date</span>()</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(dt)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> dataFormat = time.<span class="title function_">dataFormat</span>(dt)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(dataFormat)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PS D:\Java\idea project\NodeJsStudy&gt; node .\08_æµ‹è¯•æ—¶é—´æ ¼å¼åŒ–.js</span><br><span class="line">2023-03-29T13:17:45.498Z</span><br><span class="line">2023-03-29 21:17:45</span><br></pre></td></tr></table></figure>



<h5 id="æ ¼å¼åŒ–æ—¶é—´çš„é«˜çº§åšæ³•"><a href="#æ ¼å¼åŒ–æ—¶é—´çš„é«˜çº§åšæ³•" class="headerlink" title="æ ¼å¼åŒ–æ—¶é—´çš„é«˜çº§åšæ³•"></a>æ ¼å¼åŒ–æ—¶é—´çš„é«˜çº§åšæ³•</h5><blockquote>
<ol>
<li>ä½¿ç”¨ npm åŒ…ç®¡ç†å·¥å…·ï¼Œåœ¨é¡¹ç›®ä¸­å®‰è£…æ ¼å¼åŒ–æ—¶é—´çš„åŒ… moment</li>
<li>ä½¿ç”¨ require() å¯¼å…¥æ ¼å¼åŒ–æ—¶é—´çš„åŒ…</li>
<li>å‚è€ƒ moment çš„å®˜æ–¹ API æ–‡æ¡£å¯¹æ—¶é—´è¿›è¡Œæ ¼å¼åŒ–</li>
</ol>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥ moment åŒ…</span></span><br><span class="line"><span class="comment">// æ³¨æ„ï¼šå¯¼å…¥çš„åç§°ï¼Œå°±æ˜¯è£…åŒ…æ—¶å€™çš„åç§°</span></span><br><span class="line"><span class="keyword">const</span> moment = <span class="built_in">require</span>(<span class="string">&#x27;moment&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> dt = <span class="title function_">moment</span>().<span class="title function_">format</span>(<span class="string">&quot;YYYY-MM-DD HH:mm:ss&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(dt)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PS D:\Java\idea project\NodeJsStudy&gt; node .\09_dataFormaté«˜çº§åšæ³•.js</span><br><span class="line">2023-03-29 21:13:14</span><br></pre></td></tr></table></figure>



<h5 id="åœ¨é¡¹ç›®ä¸­å®‰è£…åŒ…çš„å‘½ä»¤"><a href="#åœ¨é¡¹ç›®ä¸­å®‰è£…åŒ…çš„å‘½ä»¤" class="headerlink" title="åœ¨é¡¹ç›®ä¸­å®‰è£…åŒ…çš„å‘½ä»¤"></a>åœ¨é¡¹ç›®ä¸­å®‰è£…åŒ…çš„å‘½ä»¤</h5><blockquote>
<p>å¦‚æœæƒ³åœ¨é¡¹ç›®ä¸­å®‰è£…æŒ‡å®šåç§°çš„åŒ…ï¼Œéœ€è¦è¿è¡Œå¦‚ä¸‹çš„å‘½ä»¤ï¼š</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install åŒ…çš„å®Œæ•´åç§°</span><br></pre></td></tr></table></figure>



<blockquote>
<p>ä¸Šè¿°çš„è£…åŒ…å‘½ä»¤ï¼Œå¯ä»¥ç®€å†™æˆå¦‚ä¸‹æ ¼å¼ï¼š</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i åŒ…çš„å®Œæ•´åç§°</span><br></pre></td></tr></table></figure>



<h5 id="åˆæ¬¡è£…åŒ…åå¤šäº†å“ªäº›æ–‡ä»¶"><a href="#åˆæ¬¡è£…åŒ…åå¤šäº†å“ªäº›æ–‡ä»¶" class="headerlink" title="åˆæ¬¡è£…åŒ…åå¤šäº†å“ªäº›æ–‡ä»¶"></a>åˆæ¬¡è£…åŒ…åå¤šäº†å“ªäº›æ–‡ä»¶</h5><blockquote>
<p>åˆæ¬¡è£…åŒ…å®Œæˆåï¼Œåœ¨é¡¹ç›®æ–‡ä»¶å¤¹ä¸‹å¤šä¸€ä¸ªå«åš node_modules çš„æ–‡ä»¶å¤¹å’Œ package-lock.json çš„é…ç½®æ–‡ä»¶ã€‚</p>
<p>å…¶ä¸­ï¼š</p>
<ol>
<li>node_modules æ–‡ä»¶å¤¹ç”¨æ¥å­˜æ”¾æ‰€æœ‰å·²å®‰è£…åˆ°é¡¹ç›®ä¸­çš„åŒ…ã€‚require() å¯¼å…¥ç¬¬ä¸‰æ–¹åŒ…æ—¶ï¼Œå°±æ˜¯ä»è¿™ä¸ªç›®å½•ä¸­æŸ¥æ‰¾å¹¶åŠ è½½åŒ…ã€‚ </li>
<li>package-lock.json é…ç½®æ–‡ä»¶ç”¨æ¥è®°å½• node_modules ç›®å½•ä¸‹çš„æ¯ä¸€ä¸ªåŒ…çš„ä¸‹è½½ä¿¡æ¯ï¼Œä¾‹å¦‚åŒ…çš„åå­—ã€ç‰ˆæœ¬å·ã€ä¸‹è½½åœ°å€ç­‰ã€‚</li>
</ol>
<p>&#x3D;&#x3D;æ³¨æ„ï¼šç¨‹åºå‘˜ä¸è¦æ‰‹åŠ¨ä¿®æ”¹ node_modules æˆ– package-lock.json æ–‡ä»¶ä¸­çš„ä»»ä½•ä»£ç ï¼Œnpm åŒ…ç®¡ç†å·¥å…·ä¼šè‡ªåŠ¨ç»´æŠ¤å®ƒä»¬&#x3D;&#x3D;</p>
</blockquote>
<h5 id="å®‰è£…æŒ‡å®šç‰ˆæœ¬çš„åŒ…"><a href="#å®‰è£…æŒ‡å®šç‰ˆæœ¬çš„åŒ…" class="headerlink" title="å®‰è£…æŒ‡å®šç‰ˆæœ¬çš„åŒ…"></a>å®‰è£…æŒ‡å®šç‰ˆæœ¬çš„åŒ…</h5><blockquote>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œä½¿ç”¨ npm install å‘½ä»¤å®‰è£…åŒ…çš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„åŒ…ã€‚å¦‚æœéœ€è¦å®‰è£…æŒ‡å®šç‰ˆæœ¬çš„åŒ…ï¼Œå¯ä»¥åœ¨åŒ… åä¹‹åï¼Œé€šè¿‡ @ ç¬¦å·æŒ‡å®šå…·ä½“çš„ç‰ˆæœ¬ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i moment@2.22.2</span><br></pre></td></tr></table></figure>
</blockquote>
<h5 id="åŒ…çš„è¯­ä¹‰åŒ–ç‰ˆæœ¬è§„èŒƒ"><a href="#åŒ…çš„è¯­ä¹‰åŒ–ç‰ˆæœ¬è§„èŒƒ" class="headerlink" title="åŒ…çš„è¯­ä¹‰åŒ–ç‰ˆæœ¬è§„èŒƒ"></a>åŒ…çš„è¯­ä¹‰åŒ–ç‰ˆæœ¬è§„èŒƒ</h5><blockquote>
<p>åŒ…çš„ç‰ˆæœ¬å·æ˜¯ä»¥â€œç‚¹åˆ†åè¿›åˆ¶â€å½¢å¼è¿›è¡Œå®šä¹‰çš„ï¼Œæ€»å…±æœ‰ä¸‰ä½æ•°å­—ï¼Œ</p>
<p>ä¾‹å¦‚ 2.24.0 å…¶ä¸­æ¯ä¸€ä½æ•°å­—æ‰€ä»£è¡¨çš„çš„å«ä¹‰å¦‚ä¸‹ï¼š </p>
<ol>
<li>ç¬¬1ä½æ•°å­—ï¼šå¤§ç‰ˆæœ¬ </li>
<li>ç¬¬2ä½æ•°å­—ï¼šåŠŸèƒ½ç‰ˆæœ¬ </li>
<li>ç¬¬3ä½æ•°å­—ï¼šBugä¿®å¤ç‰ˆæœ¬</li>
</ol>
<p> ç‰ˆæœ¬å·æå‡çš„è§„åˆ™ï¼šåªè¦å‰é¢çš„ç‰ˆæœ¬å·å¢é•¿äº†ï¼Œåˆ™åé¢çš„ç‰ˆæœ¬å·å½’é›¶ã€‚</p>
</blockquote>
<h4 id="åŒ…ç®¡ç†é…ç½®æ–‡ä»¶"><a href="#åŒ…ç®¡ç†é…ç½®æ–‡ä»¶" class="headerlink" title="åŒ…ç®¡ç†é…ç½®æ–‡ä»¶"></a>åŒ…ç®¡ç†é…ç½®æ–‡ä»¶</h4><blockquote>
<p>npm è§„å®šï¼Œåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸­ï¼Œå¿…é¡»æä¾›ä¸€ä¸ªå«åš package.json çš„åŒ…ç®¡ç†é…ç½®æ–‡ä»¶ã€‚ç”¨æ¥è®°å½•ä¸é¡¹ç›®æœ‰å…³çš„ä¸€äº›é…ç½® ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼š</p>
<ol>
<li>é¡¹ç›®çš„åç§°ã€ç‰ˆæœ¬å·ã€æè¿°ç­‰</li>
<li>é¡¹ç›®ä¸­éƒ½ç”¨åˆ°äº†å“ªäº›åŒ…</li>
<li>å“ªäº›åŒ…åªåœ¨å¼€å‘æœŸé—´ä¼šç”¨åˆ°</li>
<li>é‚£äº›åŒ…åœ¨å¼€å‘å’Œéƒ¨ç½²æ—¶éƒ½éœ€è¦ç”¨åˆ°</li>
</ol>
</blockquote>
<h5 id="å¤šäººåä½œçš„é—®é¢˜"><a href="#å¤šäººåä½œçš„é—®é¢˜" class="headerlink" title="å¤šäººåä½œçš„é—®é¢˜"></a>å¤šäººåä½œçš„é—®é¢˜</h5><p><a target="_blank" rel="noopener" href="https://imgse.com/i/ppgmCqS"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/./NodeJs.assets/ppgmCqS.png" alt="ppgmCqS.png"></a></p>
<blockquote>
<p>æ•´ä¸ªé¡¹ç›®çš„ä½“ç§¯æ˜¯ 30.4M </p>
<p>ç¬¬ä¸‰æ–¹åŒ…çš„ä½“ç§¯æ˜¯ 28.8M </p>
<p>é¡¹ç›®æºä»£ç çš„ä½“ç§¯ 1.6M </p>
<p>é‡åˆ°çš„é—®é¢˜ï¼šç¬¬ä¸‰æ–¹åŒ…çš„ä½“ç§¯è¿‡å¤§ï¼Œä¸ æ–¹ä¾¿å›¢é˜Ÿæˆå‘˜ä¹‹é—´å…±äº«é¡¹ç›®æºä»£ç ã€‚ </p>
<p>è§£å†³æ–¹æ¡ˆï¼šå…±äº«æ—¶å‰”é™¤node_modules</p>
</blockquote>
<h5 id="è®°å½•é¡¹ç›®ä¸­å®‰è£…çš„åŒ…"><a href="#è®°å½•é¡¹ç›®ä¸­å®‰è£…çš„åŒ…" class="headerlink" title="è®°å½•é¡¹ç›®ä¸­å®‰è£…çš„åŒ…"></a>è®°å½•é¡¹ç›®ä¸­å®‰è£…çš„åŒ…</h5><blockquote>
<p>åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸­ï¼Œåˆ›å»ºä¸€ä¸ªå«åš package.json çš„é…ç½®æ–‡ä»¶ï¼Œå³å¯ç”¨æ¥è®°å½•é¡¹ç›®ä¸­å®‰è£…äº†å“ªäº›åŒ…ã€‚ä»è€Œæ–¹ä¾¿å‰”é™¤ node_modules ç›®å½•ä¹‹åï¼Œåœ¨å›¢é˜Ÿæˆå‘˜ä¹‹é—´å…±äº«é¡¹ç›®çš„æºä»£ç ã€‚</p>
<p>&#x3D;&#x3D;æ³¨æ„ï¼šä»Šååœ¨é¡¹ç›®å¼€å‘ä¸­ï¼Œä¸€å®šè¦æŠŠ node_modules æ–‡ä»¶å¤¹ï¼Œæ·»åŠ åˆ° .gitignore å¿½ç•¥æ–‡ä»¶ä¸­ã€‚&#x3D;&#x3D;</p>
</blockquote>
<h5 id="å¿«é€Ÿåˆ›å»º-package-json"><a href="#å¿«é€Ÿåˆ›å»º-package-json" class="headerlink" title="å¿«é€Ÿåˆ›å»º package.json"></a>å¿«é€Ÿåˆ›å»º package.json</h5><blockquote>
<p>npm åŒ…ç®¡ç†å·¥å…·æä¾›äº†ä¸€ä¸ªå¿«æ·å‘½ä»¤ï¼Œå¯ä»¥åœ¨æ‰§è¡Œå‘½ä»¤æ—¶æ‰€å¤„çš„ç›®å½•ä¸­ï¼Œå¿«é€Ÿåˆ›å»º package.json è¿™ä¸ªåŒ…ç®¡ç† é…ç½®æ–‡ä»¶ï¼š</p>
<p>æ³¨æ„ï¼š</p>
<ol>
<li>ä¸‹è¿°å‘½ä»¤åªèƒ½åœ¨è‹±æ–‡çš„ç›®å½•ä¸‹æˆåŠŸè¿è¡Œï¼æ‰€ä»¥ï¼Œé¡¹ç›®æ–‡ä»¶å¤¹çš„åç§°ä¸€å®šè¦ä½¿ç”¨è‹±æ–‡å‘½åï¼Œä¸è¦ä½¿ç”¨ä¸­æ–‡ï¼Œä¸èƒ½å‡ºç°ç©ºæ ¼ã€‚</li>
<li>è¿è¡Œ npm install å‘½ä»¤å®‰è£…åŒ…çš„æ—¶å€™ï¼Œnpm åŒ…ç®¡ç†å·¥å…·ä¼šè‡ªåŠ¨æŠŠåŒ…çš„åç§°å’Œç‰ˆæœ¬å·ï¼Œè®°å½•åˆ° package.json ä¸­ã€‚</li>
</ol>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// ä½œç”¨ï¼šåœ¨æ‰§è¡Œå‘½ä»¤çš„æ‰€å¤„çš„ç›®å½•ä¸­ï¼Œå¿«é€Ÿåˆ›å»º package.json æ–‡ä»¶</span><br><span class="line">npm init -y</span><br></pre></td></tr></table></figure>



<h5 id="dependencies-èŠ‚ç‚¹"><a href="#dependencies-èŠ‚ç‚¹" class="headerlink" title="dependencies èŠ‚ç‚¹"></a>dependencies èŠ‚ç‚¹</h5><blockquote>
<p>package.json æ–‡ä»¶ä¸­ï¼Œæœ‰ä¸€ä¸ª dependencies èŠ‚ç‚¹ï¼Œä¸“é—¨ç”¨æ¥è®°å½•æ‚¨ä½¿ç”¨ npm install  å‘½ä»¤å®‰è£…äº†å“ªäº›åŒ…ã€‚</p>
</blockquote>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;dependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;moment&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^2.29.4&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>



<h5 id="ä¸€æ¬¡æ€§å®‰è£…æ‰€æœ‰çš„åŒ…"><a href="#ä¸€æ¬¡æ€§å®‰è£…æ‰€æœ‰çš„åŒ…" class="headerlink" title="ä¸€æ¬¡æ€§å®‰è£…æ‰€æœ‰çš„åŒ…"></a>ä¸€æ¬¡æ€§å®‰è£…æ‰€æœ‰çš„åŒ…</h5><blockquote>
<p>å½“æˆ‘ä»¬æ‹¿åˆ°ä¸€ä¸ªå‰”é™¤äº† node_modules çš„é¡¹ç›®ä¹‹åï¼Œéœ€è¦å…ˆæŠŠæ‰€æœ‰çš„åŒ…ä¸‹è½½åˆ°é¡¹ç›®ä¸­ï¼Œæ‰èƒ½å°†é¡¹ç›®è¿è¡Œèµ·æ¥ã€‚</p>
<p> å¦åˆ™ä¼šæŠ¥ç±»ä¼¼äºä¸‹é¢çš„é”™è¯¯ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// ç”±äºé¡¹ç›®è¿è¡Œä¾èµ–äº moment è¿™ä¸ªåŒ…ï¼Œå¦‚æœæ²¡æœ‰æå‰å®‰è£…å¥½è¿™ä¸ªåŒ…ï¼Œå°±ä¼šæŠ¥å¦‚ä¸‹çš„é”™è¯¯</span><br><span class="line">Errorï¼šCannot find module <span class="string">&#x27;moment&#x27;</span></span><br></pre></td></tr></table></figure>
</blockquote>
<h5 id="å¸è½½åŒ…"><a href="#å¸è½½åŒ…" class="headerlink" title="å¸è½½åŒ…"></a>å¸è½½åŒ…</h5><blockquote>
<p>å¯ä»¥è¿è¡Œ npm uninstall å‘½ä»¤ï¼Œæ¥å¸è½½æŒ‡å®šçš„åŒ…ï¼š</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// ä½¿ç”¨ npm uninstall å…·ä½“çš„åŒ…åæ¥å¸è½½åŒ…</span><br><span class="line">npm uninstall moment</span><br></pre></td></tr></table></figure>

<p><code>æ³¨æ„ï¼šnpm uninstall å‘½ä»¤æ‰§è¡ŒæˆåŠŸåï¼Œä¼šæŠŠå¸è½½çš„åŒ…ï¼Œè‡ªåŠ¨ä» package.json çš„ dependencies ä¸­ç§»é™¤æ‰ã€‚</code></p>
<h5 id="devDependencies-èŠ‚ç‚¹"><a href="#devDependencies-èŠ‚ç‚¹" class="headerlink" title="devDependencies èŠ‚ç‚¹"></a>devDependencies èŠ‚ç‚¹</h5><blockquote>
<p>å¦‚æœæŸäº›åŒ…åªåœ¨é¡¹ç›®å¼€å‘é˜¶æ®µä¼šç”¨åˆ°ï¼Œåœ¨é¡¹ç›®ä¸Šçº¿ä¹‹åä¸ä¼šç”¨åˆ°ï¼Œåˆ™å»ºè®®æŠŠè¿™äº›åŒ…è®°å½•åˆ° devDependencies èŠ‚ç‚¹ä¸­ã€‚ ä¸ä¹‹å¯¹åº”çš„ï¼Œå¦‚æœæŸäº›åŒ…åœ¨å¼€å‘å’Œé¡¹ç›®ä¸Šçº¿ä¹‹åéƒ½éœ€è¦ç”¨åˆ°ï¼Œåˆ™å»ºè®®æŠŠè¿™äº›åŒ…è®°å½•åˆ° dependencies èŠ‚ç‚¹ä¸­ã€‚</p>
<p>å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„å‘½ä»¤ï¼Œå°†åŒ…è®°å½•åˆ° devDependencies èŠ‚ç‚¹ä¸­ï¼š</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// å®‰è£…æŒ‡å®šçš„åŒ…ï¼Œå¹¶è®°å½•åˆ°  devDependencies èŠ‚ç‚¹ä¸­</span><br><span class="line">npm i åŒ…å -D</span><br><span class="line">// æ³¨æ„ï¼Œä¸Šè¿°å‘½ä»¤æ˜¯ç®€å†™å½¢å¼ï¼Œç­‰ä»·äºä¸‹é¢å®Œæ•´çš„å†™æ³•</span><br><span class="line">npm install åŒ…å --save-dev</span><br></pre></td></tr></table></figure>



<h4 id="è§£å†³ä¸‹åŒ…é€Ÿåº¦æ…¢çš„é—®é¢˜"><a href="#è§£å†³ä¸‹åŒ…é€Ÿåº¦æ…¢çš„é—®é¢˜" class="headerlink" title="è§£å†³ä¸‹åŒ…é€Ÿåº¦æ…¢çš„é—®é¢˜"></a>è§£å†³ä¸‹åŒ…é€Ÿåº¦æ…¢çš„é—®é¢˜</h4><h5 id="ä¸ºä»€ä¹ˆä¸‹åŒ…é€Ÿåº¦æ…¢"><a href="#ä¸ºä»€ä¹ˆä¸‹åŒ…é€Ÿåº¦æ…¢" class="headerlink" title="ä¸ºä»€ä¹ˆä¸‹åŒ…é€Ÿåº¦æ…¢"></a>ä¸ºä»€ä¹ˆä¸‹åŒ…é€Ÿåº¦æ…¢</h5><blockquote>
<p>åœ¨ä½¿ç”¨ npm ä¸‹åŒ…çš„æ—¶å€™ï¼Œé»˜è®¤ä»å›½å¤–çš„ <a target="_blank" rel="noopener" href="https://registry.npmjs.org/">https://registry.npmjs.org/</a> æœåŠ¡å™¨è¿›è¡Œä¸‹è½½ï¼Œæ­¤æ—¶ï¼Œç½‘ç»œæ•°æ®çš„ä¼ è¾“éœ€è¦ç» è¿‡æ¼«é•¿çš„æµ·åº•å…‰ç¼†ï¼Œå› æ­¤ä¸‹åŒ…é€Ÿåº¦ä¼šå¾ˆæ…¢ã€‚</p>
<p>æ‰©å±•é˜…è¯» - æµ·åº•å…‰ç¼†ï¼š</p>
<ol>
<li><a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%B5%B7%E5%BA%95%E5%85%89%E7%BC%86/4107830">https://baike.baidu.com/item/%E6%B5%B7%E5%BA%95%E5%85%89%E7%BC%86/4107830</a></li>
<li><a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E4%B8%AD%E7%BE%8E%E6%B5%B7%E5%BA%95%E5%85%89%E7%BC%86/10520363">https://baike.baidu.com/item/%E4%B8%AD%E7%BE%8E%E6%B5%B7%E5%BA%95%E5%85%89%E7%BC%86/10520363</a></li>
<li><a target="_blank" rel="noopener" href="https://baike.baidu.com/item/APG/23647721?fr=aladdin">https://baike.baidu.com/item/APG/23647721?fr=aladdin</a></li>
</ol>
</blockquote>
<h5 id="æ·˜å®-NPM-é•œåƒæœåŠ¡å™¨"><a href="#æ·˜å®-NPM-é•œåƒæœåŠ¡å™¨" class="headerlink" title="æ·˜å® NPM é•œåƒæœåŠ¡å™¨"></a>æ·˜å® NPM é•œåƒæœåŠ¡å™¨</h5><p><a target="_blank" rel="noopener" href="https://imgse.com/i/ppgmrid"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/./NodeJs.assets/ppgmrid.png" alt="ppgmrid.png"></a></p>
<h5 id="åˆ‡æ¢-npm-çš„ä¸‹åŒ…é•œåƒæº"><a href="#åˆ‡æ¢-npm-çš„ä¸‹åŒ…é•œåƒæº" class="headerlink" title="åˆ‡æ¢ npm çš„ä¸‹åŒ…é•œåƒæº"></a>åˆ‡æ¢ npm çš„ä¸‹åŒ…é•œåƒæº</h5><blockquote>
<p>ä¸‹åŒ…çš„é•œåƒæºï¼ŒæŒ‡çš„å°±æ˜¯ä¸‹åŒ…çš„æœåŠ¡å™¨åœ°å€ã€‚</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹å½“å‰ä¸‹çš„åŒ…é•œåƒæº</span></span><br><span class="line">C:\Users\æŸšç¨š&gt;npm config get registry</span><br><span class="line">https://registry.npm.taobao.org/</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†åŒ…çš„é•œåƒæºåˆ‡æ¢ä¸ºæ·˜å®é•œåƒæº</span></span><br><span class="line">npm config <span class="built_in">set</span> registry=https://registry.npm.taobao.org/</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ£€æŸ¥é•œåƒæºæ˜¯å¦ä¸‹è½½æˆåŠŸ</span></span><br><span class="line">C:\Users\æŸšç¨š&gt;npm config get registry</span><br><span class="line">https://registry.npm.taobao.org/</span><br></pre></td></tr></table></figure>



<h5 id="nrm"><a href="#nrm" class="headerlink" title="nrm"></a>nrm</h5><blockquote>
<p>ä¸ºäº†æ›´æ–¹ä¾¿çš„åˆ‡æ¢ä¸‹åŒ…çš„é•œåƒæºï¼Œæˆ‘ä»¬å¯ä»¥å®‰è£… nrm è¿™ä¸ªå°å·¥å…·ï¼Œåˆ©ç”¨ nrm æä¾›çš„ç»ˆç«¯å‘½ä»¤ï¼Œå¯ä»¥å¿«é€ŸæŸ¥çœ‹å’Œåˆ‡æ¢ä¸‹ åŒ…çš„é•œåƒæºã€‚</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é€šè¿‡ npm åŒ…ç®¡ç†å™¨ï¼Œå°† nrm å®‰è£…ä¸ºå…¨å±€å¯ç”¨çš„å·¥å…·</span></span><br><span class="line">npm i nrm -g</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ‰€æœ‰å¯ç”¨çš„é•œåƒæº</span></span><br><span class="line">nrm <span class="built_in">ls</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†åŒ…çš„é•œåƒæºç³»åˆ‡æ¢ä¸º taobao é•œåƒ</span></span><br><span class="line">nrm use taobao</span><br></pre></td></tr></table></figure>



<h4 id="åŒ…çš„åˆ†ç±»"><a href="#åŒ…çš„åˆ†ç±»" class="headerlink" title="åŒ…çš„åˆ†ç±»"></a>åŒ…çš„åˆ†ç±»</h4><blockquote>
<p>ä½¿ç”¨ npm åŒ…ç®¡ç†å·¥å…·ä¸‹è½½çš„åŒ…ï¼Œå…±åˆ†ä¸ºä¸¤å¤§ç±»ï¼Œåˆ†åˆ«æ˜¯ï¼š</p>
<ol>
<li>é¡¹ç›®åŒ…</li>
<li>å…¨å±€åŒ…</li>
</ol>
</blockquote>
<h5 id="é¡¹ç›®åŒ…"><a href="#é¡¹ç›®åŒ…" class="headerlink" title="é¡¹ç›®åŒ…"></a>é¡¹ç›®åŒ…</h5><blockquote>
<p>é‚£äº›è¢«å®‰è£…åˆ°é¡¹ç›®çš„ node_modules ç›®å½•ä¸­çš„åŒ…ï¼Œéƒ½æ˜¯é¡¹ç›®åŒ…ã€‚</p>
<p>é¡¹ç›®åŒ…åˆåˆ†ä¸ºä¸¤ç±»ï¼Œåˆ†åˆ«æ˜¯ï¼š</p>
<ol>
<li>å¼€å‘ä¾èµ–åŒ…ï¼ˆè¢«è®°å½•åˆ° devDependencies èŠ‚ç‚¹ä¸­çš„åŒ…ï¼Œåªåœ¨å¼€å‘æœŸé—´ä¼šç”¨åˆ°ï¼‰</li>
<li>æ ¸å¿ƒä¾èµ–åŒ…ï¼ˆè¢«è®°å½•åˆ° dependencies èŠ‚ç‚¹ä¸­çš„åŒ…ï¼Œåœ¨å¼€å‘æœŸé—´å’Œé¡¹ç›®ä¸Šçº¿ä¹‹åéƒ½ä¼šç”¨åˆ°ï¼‰</li>
</ol>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¼€å‘ä¾èµ–åŒ…ï¼ˆä¼šè¢«è®°å½•åˆ° devDependencies èŠ‚ç‚¹ä¸‹ï¼‰</span></span><br><span class="line">npm i åŒ…å -D</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ ¸å¿ƒä¾èµ–åŒ…ï¼ˆä¼šè¢«è®°å½•åˆ° dependenciesï¼‰</span></span><br><span class="line">npm i åŒ…å</span><br></pre></td></tr></table></figure>



<h5 id="å…¨å±€åŒ…"><a href="#å…¨å±€åŒ…" class="headerlink" title="å…¨å±€åŒ…"></a>å…¨å±€åŒ…</h5><blockquote>
<p>åœ¨æ‰§è¡Œ npm install å‘½ä»¤æ—¶ï¼Œå¦‚æœæä¾›äº† -g å‚æ•°ï¼Œåˆ™ä¼šæŠŠåŒ…å®‰è£…ä¸ºå…¨å±€åŒ…ã€‚ </p>
<p>å…¨å±€åŒ…ä¼šè¢«å®‰è£…åˆ° C:\Users\ç”¨æˆ·ç›®å½•\AppData\Roaming\npm\node_modules ç›®å½•ä¸‹ã€‚</p>
<blockquote>
<p>æ³¨æ„ï¼š</p>
<ol>
<li>åªæœ‰å·¥å…·æ€§è´¨çš„åŒ…ï¼Œæ‰æœ‰å…¨å±€å®‰è£…çš„å¿…è¦æ€§ã€‚å› ä¸ºå®ƒä»¬æä¾›äº†å¥½ç”¨çš„ç»ˆç«¯å‘½ä»¤ã€‚</li>
<li>åˆ¤æ–­æŸä¸ªåŒ…æ˜¯å¦éœ€è¦å…¨å±€å®‰è£…åæ‰èƒ½ä½¿ç”¨ï¼Œå¯ä»¥å‚è€ƒå®˜æ–¹æä¾›çš„ä½¿ç”¨è¯´æ˜å³å¯ã€‚</li>
</ol>
</blockquote>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å…¨å±€å®‰è£…æŒ‡å®šçš„åŒ…</span></span><br><span class="line">npm i åŒ…å</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¸è½½å…¨å±€å®‰è£…çš„åŒ…</span></span><br><span class="line">npm uninstall åŒ…å -g</span><br></pre></td></tr></table></figure>



<h5 id="i5ting-toc"><a href="#i5ting-toc" class="headerlink" title="i5ting_toc"></a>i5ting_toc</h5><blockquote>
<p>i5ting_toc æ˜¯ä¸€ä¸ªå¯ä»¥æŠŠ md æ–‡æ¡£è½¬ä¸º html é¡µé¢çš„å°å·¥å…·ï¼Œä½¿ç”¨æ­¥éª¤å¦‚ä¸‹</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°† i5ting_toc å®‰è£…ä¸ºå…¨å±€åŒ…</span></span><br><span class="line">npm install -g i5ting_toc</span><br><span class="line"></span><br><span class="line"><span class="comment"># è°ƒç”¨ i5ting_tocï¼Œè½»æ¾å®ç° md è½¬ html çš„åŠŸèƒ½</span></span><br><span class="line">i5ting_toc -f è¦è½¬æ¢çš„mdæ–‡ä»¶è·¯å¾„ -o</span><br></pre></td></tr></table></figure>



<h4 id="è§„èŒƒçš„åŒ…ç»“æ„"><a href="#è§„èŒƒçš„åŒ…ç»“æ„" class="headerlink" title="è§„èŒƒçš„åŒ…ç»“æ„"></a>è§„èŒƒçš„åŒ…ç»“æ„</h4><blockquote>
<p>åœ¨æ¸…æ¥šäº†åŒ…çš„æ¦‚å¿µã€ä»¥åŠå¦‚ä½•ä¸‹è½½å’Œä½¿ç”¨åŒ…ä¹‹åï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ·±å…¥äº†è§£ä¸€ä¸‹åŒ…çš„å†…éƒ¨ç»“æ„ã€‚</p>
<p>ä¸€ä¸ªè§„èŒƒçš„åŒ…ï¼Œå®ƒçš„ç»„æˆç»“æ„ï¼Œå¿…é¡»ç¬¦åˆä»¥ä¸‹ 3 ç‚¹è¦æ±‚ï¼š</p>
<ol>
<li>åŒ…å¿…é¡»ä»¥å•ç‹¬çš„ç›®å½•è€Œå­˜åœ¨</li>
<li>â‘¡ åŒ…çš„é¡¶çº§ç›®å½•ä¸‹è¦å¿…é¡»åŒ…å« package.json è¿™ä¸ªåŒ…ç®¡ç†é…ç½®æ–‡ä»¶</li>
<li>package.json ä¸­å¿…é¡»åŒ…å« nameï¼Œversionï¼Œmain è¿™ä¸‰ä¸ªå±æ€§ï¼Œåˆ†åˆ«ä»£è¡¨åŒ…çš„åå­—ã€ç‰ˆæœ¬å·ã€åŒ…çš„å…¥å£ã€‚</li>
</ol>
<p>&#x3D;&#x3D;æ³¨æ„ï¼šä»¥ä¸Š 3 ç‚¹è¦æ±‚æ˜¯ä¸€ä¸ªè§„èŒƒçš„åŒ…ç»“æ„å¿…é¡»éµå®ˆçš„æ ¼å¼ï¼Œå…³äºæ›´å¤šçš„çº¦æŸï¼Œå¯ä»¥å‚è€ƒå¦‚ä¸‹ç½‘å€ï¼š&#x3D;&#x3D; <a target="_blank" rel="noopener" href="https://yarnpkg.com/zh-Hans/docs/package-json">https://yarnpkg.com/zh-Hans/docs/package-json</a></p>
</blockquote>
<h4 id="å¼€å‘å±äºè‡ªå·±çš„åŒ…"><a href="#å¼€å‘å±äºè‡ªå·±çš„åŒ…" class="headerlink" title="å¼€å‘å±äºè‡ªå·±çš„åŒ…"></a>å¼€å‘å±äºè‡ªå·±çš„åŒ…</h4><h5 id="éœ€è¦å®ç°çš„åŠŸèƒ½"><a href="#éœ€è¦å®ç°çš„åŠŸèƒ½" class="headerlink" title="éœ€è¦å®ç°çš„åŠŸèƒ½"></a>éœ€è¦å®ç°çš„åŠŸèƒ½</h5><blockquote>
<ol>
<li>æ ¼å¼åŒ–æ—¥æœŸ</li>
<li>è½¬ä¹‰ HTML ä¸­çš„ç‰¹æ®Šå­—ç¬¦</li>
<li>è¿˜åŸ HTML ä¸­çš„ç‰¹æ®Šå­—ç¬¦</li>
</ol>
</blockquote>
<h5 id="åˆå§‹åŒ–åŒ…çš„åŸºæœ¬ç»“æ„"><a href="#åˆå§‹åŒ–åŒ…çš„åŸºæœ¬ç»“æ„" class="headerlink" title="åˆå§‹åŒ–åŒ…çš„åŸºæœ¬ç»“æ„"></a>åˆå§‹åŒ–åŒ…çš„åŸºæœ¬ç»“æ„</h5><blockquote>
<ol>
<li>æ–°å»º itheima-tools æ–‡ä»¶å¤¹ï¼Œä½œä¸ºåŒ…çš„æ ¹ç›®å½•</li>
<li>åœ¨ itheima-tools æ–‡ä»¶å¤¹ä¸­ï¼Œæ–°å»ºå¦‚ä¸‹ä¸‰ä¸ªæ–‡ä»¶ï¼š<ol>
<li>package.json ï¼ˆåŒ…ç®¡ç†é…ç½®æ–‡ä»¶ï¼‰</li>
<li>index.js ï¼ˆåŒ…çš„å…¥å£æ–‡ä»¶ï¼‰</li>
<li>README.md ï¼ˆåŒ…çš„è¯´æ˜æ–‡æ¡£ï¼‰</li>
</ol>
</li>
</ol>
</blockquote>
<h5 id="åˆå§‹åŒ–-package-json"><a href="#åˆå§‹åŒ–-package-json" class="headerlink" title="åˆå§‹åŒ– package.json"></a>åˆå§‹åŒ– package.json</h5><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;ache-tool&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span><span class="string">&quot;1.0.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;main&quot;</span><span class="punctuation">:</span> <span class="string">&quot;index.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;æä¾›äº†æ ¼å¼åŒ–æ—¶é—´ï¼ŒHTMLEscapeçš„åŠŸèƒ½&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;keywords&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;ache&quot;</span><span class="punctuation">,</span><span class="string">&quot;dateFormat&quot;</span><span class="punctuation">,</span><span class="string">&quot;escape&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;license&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ISC&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p><code>å…³äºæ›´å¤š license è®¸å¯åè®®ç›¸å…³çš„å†…å®¹ï¼Œå¯å‚è€ƒ https://www.jianshu.com/p/86251523e898</code></p>
<h5 id="æ ¼å¼åŒ–æ—¶é—´çš„æ–¹æ³•"><a href="#æ ¼å¼åŒ–æ—¶é—´çš„æ–¹æ³•" class="headerlink" title="æ ¼å¼åŒ–æ—¶é—´çš„æ–¹æ³•"></a>æ ¼å¼åŒ–æ—¶é—´çš„æ–¹æ³•</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨ index.js ä¸­å®šä¹‰æ ¼å¼åŒ–æ—¶é—´çš„å‡½æ•°</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">dateFormat</span>(<span class="params">dateStr</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> dt = <span class="keyword">new</span> <span class="title class_">Date</span>(dateStr)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> y = dt.<span class="title function_">getFullYear</span>()</span><br><span class="line">  <span class="keyword">const</span> m = <span class="title function_">padZero</span>(dt.<span class="title function_">getMonth</span>() + <span class="number">1</span>)</span><br><span class="line">  <span class="keyword">const</span> d = <span class="title function_">padZero</span>(dt.<span class="title function_">getDate</span>())</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> hh = <span class="title function_">padZero</span>(dt.<span class="title function_">getHours</span>())</span><br><span class="line">  <span class="keyword">const</span> mm = <span class="title function_">padZero</span>(dt.<span class="title function_">getMinutes</span>())</span><br><span class="line">  <span class="keyword">const</span> ss = <span class="title function_">padZero</span>(dt.<span class="title function_">getSeconds</span>())</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;y&#125;</span>-<span class="subst">$&#123;m&#125;</span>-<span class="subst">$&#123;d&#125;</span> <span class="subst">$&#123;hh&#125;</span>:<span class="subst">$&#123;mm&#125;</span>:<span class="subst">$&#123;ss&#125;</span>`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªè¡¥é›¶çš„å‡½æ•°</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">padZero</span>(<span class="params">n</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> n &gt; <span class="number">9</span> ? n : <span class="string">&#x27;0&#x27;</span> + n</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  dateFormat</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="è½¬ä¹‰-HTML-çš„æ–¹æ³•"><a href="#è½¬ä¹‰-HTML-çš„æ–¹æ³•" class="headerlink" title="è½¬ä¹‰ HTML çš„æ–¹æ³•"></a>è½¬ä¹‰ HTML çš„æ–¹æ³•</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨ index.js ä¸­å®šä¹‰è½¬ä¹‰ HTML å­—ç¬¦çš„å‡½æ•°</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">htmlEscape</span>(<span class="params">htmlstr</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> htmlstr.<span class="title function_">replace</span>(<span class="regexp">/&lt;|&gt;|&quot;|&amp;/g</span>, <span class="function"><span class="params">match</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">switch</span> (match) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;&lt;&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&amp;lt;&#x27;</span></span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;&gt;&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&amp;gt;&#x27;</span></span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;&quot;&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&amp;quot;&#x27;</span></span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;&amp;&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&amp;amp;&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="è¿˜åŸ-HTML-çš„æ–¹æ³•"><a href="#è¿˜åŸ-HTML-çš„æ–¹æ³•" class="headerlink" title="è¿˜åŸ HTML çš„æ–¹æ³•"></a>è¿˜åŸ HTML çš„æ–¹æ³•</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨ index.js ä¸­å®šä¹‰è¿˜åŸ HTML å­—ç¬¦ä¸²çš„å‡½æ•°</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">htmlUnEscape</span>(<span class="params">str</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> str.<span class="title function_">replace</span>(<span class="regexp">/&amp;lt;|&amp;gt;|&amp;quot;|&amp;amp;/g</span>, <span class="function"><span class="params">match</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">switch</span> (match) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;&amp;lt;&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&lt;&#x27;</span></span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;&amp;gt;&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&gt;&#x27;</span></span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;&amp;quot;&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&quot;&#x27;</span></span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;&amp;amp;&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&amp;&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  htmlEscape,</span><br><span class="line">  htmlUnEscape</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="æ¨¡å—åŒ–æ‹†åˆ†"><a href="#æ¨¡å—åŒ–æ‹†åˆ†" class="headerlink" title="æ¨¡å—åŒ–æ‹†åˆ†"></a>æ¨¡å—åŒ–æ‹†åˆ†</h5><blockquote>
<p>å°†ä¸åŒçš„åŠŸèƒ½è¿›è¡Œæ¨¡å—åŒ–æ‹†åˆ†</p>
<ol>
<li>å°†æ ¼å¼åŒ–æ—¶é—´çš„åŠŸèƒ½ï¼Œæ‹†åˆ†åˆ° src -&gt; dateFormat.js ä¸­</li>
<li>å°†å¤„ç† HTML å­—ç¬¦ä¸²çš„åŠŸèƒ½ï¼Œæ‹†åˆ†åˆ° src -&gt; htmlEscape.js ä¸­</li>
<li>åœ¨ index.js ä¸­ï¼Œå¯¼å…¥ä¸¤ä¸ªæ¨¡å—ï¼Œå¾—åˆ°éœ€è¦å‘å¤–å…±äº«çš„æ–¹æ³•</li>
<li>åœ¨ index.js ä¸­ï¼Œä½¿ç”¨ module.exports æŠŠå¯¹åº”çš„æ–¹æ³•å…±äº«å‡ºå»</li>
</ol>
</blockquote>
<h5 id="ç¼–å†™åŒ…çš„è¯´æ˜æ–‡æ¡£"><a href="#ç¼–å†™åŒ…çš„è¯´æ˜æ–‡æ¡£" class="headerlink" title="ç¼–å†™åŒ…çš„è¯´æ˜æ–‡æ¡£"></a>ç¼–å†™åŒ…çš„è¯´æ˜æ–‡æ¡£</h5><blockquote>
<p>åŒ…æ ¹ç›®å½•ä¸­çš„ README.md æ–‡ä»¶ï¼Œæ˜¯åŒ…çš„ä½¿ç”¨è¯´æ˜æ–‡æ¡£ã€‚é€šè¿‡å®ƒï¼Œæˆ‘ä»¬å¯ä»¥äº‹å…ˆæŠŠåŒ…çš„ä½¿ç”¨è¯´æ˜ï¼Œä»¥ markdown çš„ æ ¼å¼å†™å‡ºæ¥ï¼Œæ–¹ä¾¿ç”¨æˆ·å‚è€ƒã€‚</p>
<p> README æ–‡ä»¶ä¸­å…·ä½“å†™ä»€ä¹ˆå†…å®¹ï¼Œæ²¡æœ‰å¼ºåˆ¶æ€§çš„è¦æ±‚ï¼›åªè¦èƒ½å¤Ÿæ¸…æ™°åœ°æŠŠåŒ…çš„ä½œç”¨ã€ç”¨æ³•ã€æ³¨æ„äº‹é¡¹ç­‰æè¿°æ¸…æ¥šå³å¯ã€‚ æˆ‘ä»¬æ‰€åˆ›å»ºçš„è¿™ä¸ªåŒ…çš„ README.md æ–‡æ¡£ä¸­ï¼Œä¼šåŒ…å«ä»¥ä¸‹ 6 é¡¹å†…å®¹ï¼š </p>
<ol>
<li>å®‰è£…æ–¹å¼</li>
<li>å¯¼å…¥æ–¹å¼</li>
<li>æ ¼å¼åŒ–æ—¶é—´</li>
<li>è½¬ä¹‰ HTML ä¸­çš„ç‰¹æ®Šå­—ç¬¦</li>
<li>è¿˜åŸ HTML ä¸­çš„ç‰¹æ®Šå­—ç¬¦</li>
<li>å¼€æºåè®®</li>
</ol>
</blockquote>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">## å®‰è£…</span></span><br><span class="line"><span class="code">```</span></span><br><span class="line"><span class="code">npm install itheima-tools</span></span><br><span class="line"><span class="code">```</span></span><br><span class="line"></span><br><span class="line"><span class="section">## å¯¼å…¥</span></span><br><span class="line"><span class="code">```js</span></span><br><span class="line"><span class="code">const itheima = require(&#x27;itheima-tools&#x27;)</span></span><br><span class="line"><span class="code">```</span></span><br><span class="line"></span><br><span class="line"><span class="section">## æ ¼å¼åŒ–æ—¶é—´</span></span><br><span class="line"><span class="code">```js</span></span><br><span class="line"><span class="code">// è°ƒç”¨ dateFormat å¯¹æ—¶é—´è¿›è¡Œæ ¼å¼åŒ–</span></span><br><span class="line"><span class="code">const dtStr = itheima.dateFormat(new Date())</span></span><br><span class="line"><span class="code">// ç»“æœ  2020-04-03 17:20:58</span></span><br><span class="line"><span class="code">console.log(dtStr)</span></span><br><span class="line"><span class="code">```</span></span><br><span class="line"></span><br><span class="line"><span class="section">## è½¬ä¹‰ HTML ä¸­çš„ç‰¹æ®Šå­—ç¬¦</span></span><br><span class="line"><span class="code">```js</span></span><br><span class="line"><span class="code">// å¸¦è½¬æ¢çš„ HTML å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="code">const htmlStr = &#x27;&lt;h1 title=&quot;abc&quot;&gt;è¿™æ˜¯h1æ ‡ç­¾&lt;span&gt;123&amp;nbsp;&lt;/span&gt;&lt;/h1&gt;&#x27;</span></span><br><span class="line"><span class="code">// è°ƒç”¨ htmlEscape æ–¹æ³•è¿›è¡Œè½¬æ¢</span></span><br><span class="line"><span class="code">const str = itheima.htmlEscape(htmlStr)</span></span><br><span class="line"><span class="code">// è½¬æ¢çš„ç»“æœ &amp;lt;h1 title=&amp;quot;abc&amp;quot;&amp;gt;è¿™æ˜¯h1æ ‡ç­¾&amp;lt;span&amp;gt;123&amp;amp;nbsp;&amp;lt;/span&amp;gt;&amp;lt;/h1&amp;gt;</span></span><br><span class="line"><span class="code">console.log(str)</span></span><br><span class="line"><span class="code">```</span></span><br><span class="line"></span><br><span class="line"><span class="section">## è¿˜åŸ HTML ä¸­çš„ç‰¹æ®Šå­—ç¬¦</span></span><br><span class="line"><span class="code">```js</span></span><br><span class="line"><span class="code">// å¾…è¿˜åŸçš„ HTML å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="code">const str2 = itheima.htmlUnEscape(str)</span></span><br><span class="line"><span class="code">// è¾“å‡ºçš„ç»“æœ &lt;h1 title=&quot;abc&quot;&gt;è¿™æ˜¯h1æ ‡ç­¾&lt;span&gt;123&amp;nbsp;&lt;/span&gt;&lt;/h1&gt;</span></span><br><span class="line"><span class="code">console.log(str2)</span></span><br><span class="line"><span class="code">```</span></span><br><span class="line"></span><br><span class="line"><span class="section">## å¼€æºåè®®</span></span><br><span class="line">ISC</span><br></pre></td></tr></table></figure>



<h4 id="å°†ä¸åŒçš„åŠŸèƒ½è¿›è¡Œæ¨¡å—åŒ–æ‹†åˆ†"><a href="#å°†ä¸åŒçš„åŠŸèƒ½è¿›è¡Œæ¨¡å—åŒ–æ‹†åˆ†" class="headerlink" title="å°†ä¸åŒçš„åŠŸèƒ½è¿›è¡Œæ¨¡å—åŒ–æ‹†åˆ†"></a>å°†ä¸åŒçš„åŠŸèƒ½è¿›è¡Œæ¨¡å—åŒ–æ‹†åˆ†</h4><h5 id="æ³¨å†Œ-npm-è´¦å·"><a href="#æ³¨å†Œ-npm-è´¦å·" class="headerlink" title="æ³¨å†Œ npm è´¦å·"></a>æ³¨å†Œ npm è´¦å·</h5><blockquote>
<ol>
<li>è®¿é—® <a target="_blank" rel="noopener" href="https://www.npmjs.com/">https://www.npmjs.com/</a> ç½‘ç«™ï¼Œç‚¹å‡» sign up æŒ‰é’®ï¼Œè¿›å…¥æ³¨å†Œç”¨æˆ·ç•Œé¢</li>
<li>å¡«å†™è´¦å·ç›¸å…³çš„ä¿¡æ¯ï¼šFull Nameã€Public Emailã€Usernameã€Password</li>
<li>ç‚¹å‡» Create an Account æŒ‰é’®ï¼Œæ³¨å†Œè´¦å·</li>
<li>ç™»å½•é‚®ç®±ï¼Œç‚¹å‡»éªŒè¯é“¾æ¥ï¼Œè¿›è¡Œè´¦å·çš„éªŒè¯</li>
</ol>
</blockquote>
<h5 id="ç™»å½•-npm-è´¦å·"><a href="#ç™»å½•-npm-è´¦å·" class="headerlink" title="ç™»å½• npm è´¦å·"></a>ç™»å½• npm è´¦å·</h5><blockquote>
<p>npm è´¦å·æ³¨å†Œå®Œæˆåï¼Œå¯ä»¥åœ¨ç»ˆç«¯ä¸­æ‰§è¡Œ npm login å‘½ä»¤ï¼Œä¾æ¬¡è¾“å…¥ç”¨æˆ·åã€å¯†ç ã€é‚®ç®±åï¼Œå³å¯ç™»å½•æˆåŠŸã€‚</p>
<p>æ³¨æ„ï¼šåœ¨è¿è¡Œ npm login å‘½ä»¤ä¹‹å‰ï¼Œå¿…é¡» å…ˆæŠŠä¸‹åŒ…çš„æœåŠ¡å™¨åœ°å€åˆ‡æ¢ä¸º npm çš„å®˜æ–¹ æœåŠ¡å™¨ã€‚å¦åˆ™ä¼šå¯¼è‡´å‘å¸ƒåŒ…å¤±è´¥ï¼</p>
</blockquote>
<h5 id="æŠŠåŒ…å‘å¸ƒåˆ°-npm-ä¸Š"><a href="#æŠŠåŒ…å‘å¸ƒåˆ°-npm-ä¸Š" class="headerlink" title="æŠŠåŒ…å‘å¸ƒåˆ° npm ä¸Š"></a>æŠŠåŒ…å‘å¸ƒåˆ° npm ä¸Š</h5><blockquote>
<p> å°†ç»ˆç«¯åˆ‡æ¢åˆ°åŒ…çš„æ ¹ç›®å½•ä¹‹åï¼Œè¿è¡Œ npm publish å‘½ä»¤ï¼Œå³å¯å°†åŒ…å‘å¸ƒåˆ° npm ä¸Šï¼ˆæ³¨æ„ï¼šåŒ…åä¸èƒ½é›·åŒï¼‰ã€‚</p>
</blockquote>
<h5 id="åˆ é™¤å·²å‘å¸ƒçš„åŒ…"><a href="#åˆ é™¤å·²å‘å¸ƒçš„åŒ…" class="headerlink" title="åˆ é™¤å·²å‘å¸ƒçš„åŒ…"></a>åˆ é™¤å·²å‘å¸ƒçš„åŒ…</h5><blockquote>
<p>è¿è¡Œ npm unpublish åŒ…å â€“force å‘½ä»¤ï¼Œå³å¯ä» npm åˆ é™¤å·²å‘å¸ƒçš„åŒ…ã€‚</p>
<p>æ³¨æ„ï¼š </p>
<ol>
<li>npm unpublish å‘½ä»¤åªèƒ½åˆ é™¤ 72 å°æ—¶ä»¥å†…å‘å¸ƒçš„åŒ…</li>
<li>npm unpublish åˆ é™¤çš„åŒ…ï¼Œåœ¨ 24 å°æ—¶å†…ä¸å…è®¸é‡å¤å‘å¸ƒ</li>
<li>å‘å¸ƒåŒ…çš„æ—¶å€™è¦æ…é‡ï¼Œå°½é‡ä¸è¦å¾€ npm ä¸Šå‘å¸ƒæ²¡æœ‰æ„ä¹‰çš„åŒ…ï¼</li>
</ol>
</blockquote>
<h3 id="æ¨¡å—çš„åŠ è½½æœºåˆ¶"><a href="#æ¨¡å—çš„åŠ è½½æœºåˆ¶" class="headerlink" title="æ¨¡å—çš„åŠ è½½æœºåˆ¶"></a>æ¨¡å—çš„åŠ è½½æœºåˆ¶</h3><h4 id="ä¼˜å…ˆä»ç¼“å­˜ä¸­åŠ è½½"><a href="#ä¼˜å…ˆä»ç¼“å­˜ä¸­åŠ è½½" class="headerlink" title="ä¼˜å…ˆä»ç¼“å­˜ä¸­åŠ è½½"></a>ä¼˜å…ˆä»ç¼“å­˜ä¸­åŠ è½½</h4><blockquote>
<p>æ¨¡å—åœ¨ç¬¬ä¸€æ¬¡åŠ è½½åä¼šè¢«ç¼“å­˜ã€‚ è¿™ä¹Ÿæ„å‘³ç€å¤šæ¬¡è°ƒç”¨ require() ä¸ä¼šå¯¼è‡´æ¨¡å—çš„ä»£ç è¢«æ‰§è¡Œå¤šæ¬¡ã€‚ </p>
<p>æ³¨æ„ï¼šä¸è®ºæ˜¯å†…ç½®æ¨¡å—ã€ç”¨æˆ·è‡ªå®šä¹‰æ¨¡å—ã€è¿˜æ˜¯ç¬¬ä¸‰æ–¹æ¨¡å—ï¼Œå®ƒä»¬éƒ½ä¼šä¼˜å…ˆä»ç¼“å­˜ä¸­åŠ è½½ï¼Œä»è€Œæé«˜æ¨¡å—çš„åŠ è½½æ•ˆç‡ã€‚</p>
</blockquote>
<h4 id="å†…ç½®æ¨¡å—çš„åŠ è½½æœºåˆ¶"><a href="#å†…ç½®æ¨¡å—çš„åŠ è½½æœºåˆ¶" class="headerlink" title="å†…ç½®æ¨¡å—çš„åŠ è½½æœºåˆ¶"></a>å†…ç½®æ¨¡å—çš„åŠ è½½æœºåˆ¶</h4><blockquote>
<p>å†…ç½®æ¨¡å—æ˜¯ç”± Node.js å®˜æ–¹æä¾›çš„æ¨¡å—ï¼Œå†…ç½®æ¨¡å—çš„åŠ è½½ä¼˜å…ˆçº§æœ€é«˜ã€‚</p>
<p> ä¾‹å¦‚ï¼Œrequire(â€˜fsâ€™) å§‹ç»ˆè¿”å›å†…ç½®çš„ fs æ¨¡å—ï¼Œå³ä½¿åœ¨ node_modules ç›®å½•ä¸‹æœ‰åå­—ç›¸åŒçš„åŒ…ä¹Ÿå«åš fsã€‚</p>
</blockquote>
<h4 id="è‡ªå®šä¹‰æ¨¡å—çš„åŠ è½½æœºåˆ¶"><a href="#è‡ªå®šä¹‰æ¨¡å—çš„åŠ è½½æœºåˆ¶" class="headerlink" title="è‡ªå®šä¹‰æ¨¡å—çš„åŠ è½½æœºåˆ¶"></a>è‡ªå®šä¹‰æ¨¡å—çš„åŠ è½½æœºåˆ¶</h4><blockquote>
<p>ä½¿ç”¨ require() åŠ è½½è‡ªå®šä¹‰æ¨¡å—æ—¶ï¼Œå¿…é¡»æŒ‡å®šä»¥ .&#x2F; æˆ– ..&#x2F; å¼€å¤´çš„è·¯å¾„æ ‡è¯†ç¬¦ã€‚åœ¨åŠ è½½è‡ªå®šä¹‰æ¨¡å—æ—¶ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®š .&#x2F; æˆ– ..&#x2F;  è¿™æ ·çš„è·¯å¾„æ ‡è¯†ç¬¦ï¼Œåˆ™ node ä¼šæŠŠå®ƒå½“ä½œå†…ç½®æ¨¡å—æˆ–ç¬¬ä¸‰æ–¹æ¨¡å—è¿›è¡ŒåŠ è½½ã€‚</p>
<p>åŒæ—¶ï¼Œåœ¨ä½¿ç”¨ require() å¯¼å…¥è‡ªå®šä¹‰æ¨¡å—æ—¶ï¼Œå¦‚æœçœç•¥äº†æ–‡ä»¶çš„æ‰©å±•åï¼Œåˆ™ Node.js ä¼šæŒ‰é¡ºåºåˆ†åˆ«å°è¯•åŠ è½½ä»¥ä¸‹çš„æ–‡ä»¶ï¼š</p>
<ol>
<li>æŒ‰ç…§ç¡®åˆ‡çš„æ–‡ä»¶åè¿›è¡ŒåŠ è½½</li>
<li>è¡¥å…¨ .js æ‰©å±•åè¿›è¡ŒåŠ è½½</li>
<li>è¡¥å…¨ .json æ‰©å±•åè¿›è¡ŒåŠ è½½</li>
<li>è¡¥å…¨ .node æ‰©å±•åè¿›è¡ŒåŠ è½½</li>
<li>åŠ è½½å¤±è´¥ï¼Œç»ˆç«¯æŠ¥é”™</li>
</ol>
</blockquote>
<h4 id="ç¬¬ä¸‰æ–¹æ¨¡å—çš„åŠ è½½æœºåˆ¶"><a href="#ç¬¬ä¸‰æ–¹æ¨¡å—çš„åŠ è½½æœºåˆ¶" class="headerlink" title="ç¬¬ä¸‰æ–¹æ¨¡å—çš„åŠ è½½æœºåˆ¶"></a>ç¬¬ä¸‰æ–¹æ¨¡å—çš„åŠ è½½æœºåˆ¶</h4><blockquote>
<p>å¦‚æœä¼ é€’ç»™ require() çš„æ¨¡å—æ ‡è¯†ç¬¦ä¸æ˜¯ä¸€ä¸ªå†…ç½®æ¨¡å—ï¼Œä¹Ÿæ²¡æœ‰ä»¥ â€˜.&#x2F;â€™ æˆ– â€˜..&#x2F;â€™ å¼€å¤´ï¼Œåˆ™ Node.js ä¼šä»å½“å‰æ¨¡å—çš„çˆ¶ ç›®å½•å¼€å§‹ï¼Œå°è¯•ä» &#x2F;node_modules æ–‡ä»¶å¤¹ä¸­åŠ è½½ç¬¬ä¸‰æ–¹æ¨¡å—ã€‚ </p>
<p>å¦‚æœæ²¡æœ‰æ‰¾åˆ°å¯¹åº”çš„ç¬¬ä¸‰æ–¹æ¨¡å—ï¼Œåˆ™ç§»åŠ¨åˆ°å†ä¸Šä¸€å±‚çˆ¶ç›®å½•ä¸­ï¼Œè¿›è¡ŒåŠ è½½ï¼Œç›´åˆ°æ–‡ä»¶ç³»ç»Ÿçš„æ ¹ç›®å½•ã€‚ ä¾‹å¦‚ï¼Œå‡è®¾åœ¨ â€˜C:\Users\itheima\project\foo.jsâ€™ æ–‡ä»¶é‡Œè°ƒç”¨äº† require(â€˜toolsâ€™)ï¼Œåˆ™ Node.js ä¼šæŒ‰ä»¥ä¸‹é¡ºåºæŸ¥æ‰¾ï¼š</p>
<ol>
<li>C:\Users\æŸšç¨š\project\node_modules\tools</li>
<li>C:\Users\æŸšç¨š\node_modules\tools</li>
<li>C:\Users\node_modules\tools</li>
<li>C:\node_modules\tool</li>
</ol>
</blockquote>
<h4 id="ç›®å½•ä½œä¸ºæ¨¡å—"><a href="#ç›®å½•ä½œä¸ºæ¨¡å—" class="headerlink" title="ç›®å½•ä½œä¸ºæ¨¡å—"></a>ç›®å½•ä½œä¸ºæ¨¡å—</h4><blockquote>
<p>å½“æŠŠç›®å½•ä½œä¸ºæ¨¡å—æ ‡è¯†ç¬¦ï¼Œä¼ é€’ç»™ require() è¿›è¡ŒåŠ è½½çš„æ—¶å€™ï¼Œæœ‰ä¸‰ç§åŠ è½½æ–¹å¼ï¼š </p>
<ol>
<li>åœ¨è¢«åŠ è½½çš„ç›®å½•ä¸‹æŸ¥æ‰¾ä¸€ä¸ªå«åš package.json çš„æ–‡ä»¶ï¼Œå¹¶å¯»æ‰¾ main å±æ€§ï¼Œä½œä¸º require() åŠ è½½çš„å…¥å£</li>
<li>å¦‚æœç›®å½•é‡Œæ²¡æœ‰ package.json æ–‡ä»¶ï¼Œæˆ–è€… main å…¥å£ä¸å­˜åœ¨æˆ–æ— æ³•è§£æï¼Œåˆ™ Node.js å°†ä¼šè¯•å›¾åŠ è½½ç›®å½•ä¸‹çš„ index.js æ–‡ä»¶ã€‚</li>
<li>å¦‚æœä»¥ä¸Šä¸¤æ­¥éƒ½å¤±è´¥äº†ï¼Œåˆ™ Node.js ä¼šåœ¨ç»ˆç«¯æ‰“å°é”™è¯¯æ¶ˆæ¯ï¼ŒæŠ¥å‘Šæ¨¡å—çš„ç¼ºå¤±ï¼šError: Cannot find module â€˜xxx</li>
</ol>
</blockquote>
<h3 id="Express"><a href="#Express" class="headerlink" title="Express"></a>Express</h3><h4 id="Express-ç®€ä»‹"><a href="#Express-ç®€ä»‹" class="headerlink" title="Express ç®€ä»‹"></a>Express ç®€ä»‹</h4><h5 id="ä»€ä¹ˆæ˜¯-Express"><a href="#ä»€ä¹ˆæ˜¯-Express" class="headerlink" title="ä»€ä¹ˆæ˜¯ Express"></a>ä»€ä¹ˆæ˜¯ Express</h5><blockquote>
<p>å®˜æ–¹ç»™å‡ºçš„æ¦‚å¿µï¼šExpress æ˜¯åŸºäº Node.js å¹³å°ï¼Œå¿«é€Ÿã€å¼€æ”¾ã€æç®€çš„ Web å¼€å‘æ¡†æ¶ã€‚ </p>
<p>é€šä¿—çš„ç†è§£ï¼šExpress çš„ä½œç”¨å’Œ Node.js å†…ç½®çš„ http æ¨¡å—ç±»ä¼¼ï¼Œæ˜¯ä¸“é—¨ç”¨æ¥åˆ›å»º Web æœåŠ¡å™¨çš„ã€‚ </p>
<p>Express çš„æœ¬è´¨ï¼šå°±æ˜¯ä¸€ä¸ª npm ä¸Šçš„ç¬¬ä¸‰æ–¹åŒ…ï¼Œæä¾›äº†å¿«é€Ÿåˆ›å»º Web æœåŠ¡å™¨çš„ä¾¿æ·æ–¹æ³•ã€‚</p>
<p>Express çš„ä¸­æ–‡å®˜ç½‘ï¼š <a target="_blank" rel="noopener" href="http://www.expressjs.com.cn/">http://www.expressjs.com.cn/</a></p>
</blockquote>
<h5 id="è¿›ä¸€æ­¥ç†è§£-Express"><a href="#è¿›ä¸€æ­¥ç†è§£-Express" class="headerlink" title="è¿›ä¸€æ­¥ç†è§£ Express"></a>è¿›ä¸€æ­¥ç†è§£ Express</h5><blockquote>
<p>æ€è€ƒï¼šä¸ä½¿ç”¨ Express èƒ½å¦åˆ›å»º Web æœåŠ¡å™¨ï¼Ÿ </p>
<p>ç­”æ¡ˆï¼šèƒ½ï¼Œä½¿ç”¨ Node.js æä¾›çš„åŸç”Ÿ http æ¨¡å—å³å¯ã€‚ </p>
<p>æ€è€ƒï¼šæ—¢ç”Ÿç‘œä½•ç”Ÿäº®ï¼ˆæœ‰äº† http å†…ç½®æ¨¡å—ï¼Œä¸ºä»€ä¹ˆè¿˜æœ‰ç”¨ Expressï¼‰ï¼Ÿ</p>
<p> ç­”æ¡ˆï¼šhttp å†…ç½®æ¨¡å—ç”¨èµ·æ¥å¾ˆå¤æ‚ï¼Œå¼€å‘æ•ˆç‡ä½ï¼›Express æ˜¯åŸºäºå†…ç½®çš„ http æ¨¡å—è¿›ä¸€æ­¥å°è£…å‡ºæ¥çš„ï¼Œèƒ½å¤Ÿæå¤§çš„æé«˜å¼€å‘æ•ˆç‡ã€‚</p>
<p> æ€è€ƒï¼šhttp å†…ç½®æ¨¡å—ä¸ Express æ˜¯ä»€ä¹ˆå…³ç³»ï¼Ÿ </p>
<p>ç­”æ¡ˆï¼šç±»ä¼¼äºæµè§ˆå™¨ä¸­ Web API å’Œ jQuery çš„å…³ç³»ã€‚åè€…æ˜¯åŸºäºå‰è€…è¿›ä¸€æ­¥å°è£…å‡ºæ¥çš„ã€‚</p>
</blockquote>
<h5 id="Express-èƒ½åšä»€ä¹ˆ"><a href="#Express-èƒ½åšä»€ä¹ˆ" class="headerlink" title="Express èƒ½åšä»€ä¹ˆ"></a>Express èƒ½åšä»€ä¹ˆ</h5><blockquote>
<p>å¯¹äºå‰ç«¯ç¨‹åºå‘˜æ¥è¯´ï¼Œæœ€å¸¸è§çš„ä¸¤ç§æœåŠ¡å™¨ï¼Œåˆ†åˆ«æ˜¯ï¼š </p>
<ol>
<li>Web ç½‘ç«™æœåŠ¡å™¨ï¼šä¸“é—¨å¯¹å¤–æä¾› Web ç½‘é¡µèµ„æºçš„æœåŠ¡å™¨ã€‚</li>
<li>API æ¥å£æœåŠ¡å™¨ï¼šä¸“é—¨å¯¹å¤–æä¾› API æ¥å£çš„æœåŠ¡å™¨ã€‚</li>
</ol>
<p>ä½¿ç”¨ Expressï¼Œæˆ‘ä»¬å¯ä»¥æ–¹ä¾¿ã€å¿«é€Ÿçš„åˆ›å»º Web ç½‘ç«™çš„æœåŠ¡å™¨æˆ– API æ¥å£çš„æœåŠ¡å™¨ã€‚</p>
</blockquote>
<h4 id="Express-çš„åŸºæœ¬ä½¿ç”¨"><a href="#Express-çš„åŸºæœ¬ä½¿ç”¨" class="headerlink" title="Express çš„åŸºæœ¬ä½¿ç”¨"></a>Express çš„åŸºæœ¬ä½¿ç”¨</h4><h5 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h5><blockquote>
<p>åœ¨é¡¹ç›®æ‰€å¤„çš„ç›®å½•ä¸­ï¼Œè¿è¡Œå¦‚ä¸‹çš„ç»ˆç«¯å‘½ä»¤ï¼Œå³å¯å°† express å®‰è£…åˆ°é¡¹ç›®ä¸­ä½¿ç”¨ï¼š</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm i express</span><br><span class="line"><span class="comment"># æˆ–</span></span><br><span class="line">npm i express@4.17.1</span><br></pre></td></tr></table></figure>



<h5 id="åˆ›å»ºåŸºæœ¬çš„-Web-æœåŠ¡å™¨"><a href="#åˆ›å»ºåŸºæœ¬çš„-Web-æœåŠ¡å™¨" class="headerlink" title="åˆ›å»ºåŸºæœ¬çš„ Web æœåŠ¡å™¨"></a>åˆ›å»ºåŸºæœ¬çš„ Web æœåŠ¡å™¨</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥ express</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»º web æœåŠ¡å™¨</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯åŠ¨ web æœåŠ¡å™¨</span></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">8088</span>,<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;express server running at http://127.0.0.1&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h5 id="ç›‘å¬-GET-è¯·æ±‚"><a href="#ç›‘å¬-GET-è¯·æ±‚" class="headerlink" title="ç›‘å¬ GET è¯·æ±‚"></a>ç›‘å¬ GET è¯·æ±‚</h5><blockquote>
<p>é€šè¿‡ app.get() æ–¹æ³•ï¼Œå¯ä»¥ç›‘å¬å®¢æˆ·ç«¯çš„ GET è¯·æ±‚ï¼Œå…·ä½“çš„è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç›‘å¬å®¢æˆ·ç«¯çš„ GET è¯·æ±‚ å’Œ POST è¯·æ±‚ï¼Œå¹¶å‘å®¢æˆ·ç«¯å“åº”å…·ä½“çš„å†…å®¹</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/user&#x27;</span>,<span class="function">(<span class="params">req,resp</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="comment">// è°ƒç”¨ express æä¾›çš„ res.send() æ–¹æ³•ï¼Œå‘å®¢æˆ·ç«¯å“åº”ä¸€ä¸ª JSON å¯¹è±¡</span></span><br><span class="line">    resp.<span class="title function_">send</span>(&#123;</span><br><span class="line">        <span class="attr">name</span>:<span class="string">&#x27;ache&#x27;</span>,</span><br><span class="line">        <span class="attr">age</span>:<span class="string">&#x27;19&#x27;</span>,</span><br><span class="line">        <span class="attr">sex</span>:<span class="string">&#x27;ç”·&#x27;</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>





<h5 id="æŠŠå†…å®¹å“åº”ç»™å®¢æˆ·ç«¯"><a href="#æŠŠå†…å®¹å“åº”ç»™å®¢æˆ·ç«¯" class="headerlink" title="æŠŠå†…å®¹å“åº”ç»™å®¢æˆ·ç«¯"></a>æŠŠå†…å®¹å“åº”ç»™å®¢æˆ·ç«¯</h5><blockquote>
<p>é€šè¿‡ res.send() æ–¹æ³•ï¼Œå¯ä»¥æŠŠå¤„ç†å¥½çš„å†…å®¹ï¼Œå‘é€ç»™å®¢æˆ·ç«¯ï¼š</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pp27PNd"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/./NodeJs.assets/pp27PNd.png" alt="pp27PNd.png"></a></p>
<h5 id="ç›‘å¬-POST-è¯·æ±‚"><a href="#ç›‘å¬-POST-è¯·æ±‚" class="headerlink" title="ç›‘å¬ POST è¯·æ±‚"></a>ç›‘å¬ POST è¯·æ±‚</h5><blockquote>
<p>é€šè¿‡ app.post() æ–¹æ³•ï¼Œå¯ä»¥ç›‘å¬å®¢æˆ·ç«¯çš„ POST è¯·æ±‚ï¼Œå…·ä½“çš„è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/user&#x27;</span>,<span class="function">(<span class="params">req,resp</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="comment">// è°ƒç”¨ express æä¾›çš„ res.send() æ–¹æ³•ï¼Œå‘å®¢æˆ·ç«¯å“åº”ä¸€ä¸ªæ–‡æœ¬å­—ç¬¦ä¸²</span></span><br><span class="line">    resp.<span class="title function_">send</span>(<span class="string">&#x27;è¯·æ±‚æˆåŠŸï¼&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>





<h5 id="è·å–-URL-ä¸­æºå¸¦çš„æŸ¥è¯¢å‚æ•°"><a href="#è·å–-URL-ä¸­æºå¸¦çš„æŸ¥è¯¢å‚æ•°" class="headerlink" title="è·å– URL ä¸­æºå¸¦çš„æŸ¥è¯¢å‚æ•°"></a>è·å– URL ä¸­æºå¸¦çš„æŸ¥è¯¢å‚æ•°</h5><blockquote>
<p>é€šè¿‡ req.query å¯¹è±¡ï¼Œå¯ä»¥è®¿é—®åˆ°å®¢æˆ·ç«¯é€šè¿‡æŸ¥è¯¢å­—ç¬¦ä¸²çš„å½¢å¼ï¼Œå‘é€åˆ°æœåŠ¡å™¨çš„å‚æ•°ï¼š</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>,<span class="function">(<span class="params">req,resp</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="comment">// req.query é»˜è®¤æ˜¯ä¸€ä¸ªç©ºå¯¹è±¡</span></span><br><span class="line">    <span class="comment">// å®¢æˆ·ç«¯ä½¿ç”¨ ?name=ache&amp;age=19 è¿™ç§æŸ¥è¯¢å­—ç¬¦ä¸²å½¢å¼ï¼Œå‘é€åˆ°æœåŠ¡å™¨çš„å‚æ•°</span></span><br><span class="line">    <span class="comment">// å¯ä»¥é€šè¿‡ req.query å¯¹è±¡è®¿é—®åˆ°ï¼Œä¾‹å¦‚</span></span><br><span class="line">    <span class="comment">//      req.query.name  req.query.age</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">query</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://imgse.com/i/ppRPWdA"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/./NodeJs.assets/ppRPWdA.png" alt="ppRPWdA.png"></a></p>
<h5 id="è·å–-URL-ä¸­çš„åŠ¨æ€å‚æ•°"><a href="#è·å–-URL-ä¸­çš„åŠ¨æ€å‚æ•°" class="headerlink" title="è·å– URL ä¸­çš„åŠ¨æ€å‚æ•°"></a>è·å– URL ä¸­çš„åŠ¨æ€å‚æ•°</h5><blockquote>
<p>é€šè¿‡ req.params å¯¹è±¡ï¼Œå¯ä»¥è®¿é—®åˆ° URL ä¸­ï¼Œé€šè¿‡ : åŒ¹é…åˆ°çš„åŠ¨æ€å‚æ•°ï¼š</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ³¨æ„ï¼Œè¿™é‡Œçš„ :id æ˜¯ä¸€ä¸ªåŠ¨æ€çš„å‚æ•°</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/user/:id&#x27;</span>,<span class="function">(<span class="params">req,resp</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="comment">// req.params æ˜¯åŒ¹é…åˆ°çš„ URL å‚æ•°</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">params</span>)</span><br><span class="line">    resp.<span class="title function_">send</span>(req.<span class="property">params</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://imgse.com/i/ppRPMan"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/./NodeJs.assets/ppRPMan.png" alt="ppRPMan.png"></a></p>
<p><strong><code>ä¹Ÿå¯åŒ¹é…å¤šä¸ªå‚æ•°ï¼ŒåŠ¨æ€è·å–å¤šä¸ªå‚æ•°</code></strong></p>
<h5 id="å®Œæ•´ä»£ç "><a href="#å®Œæ•´ä»£ç " class="headerlink" title="å®Œæ•´ä»£ç "></a>å®Œæ•´ä»£ç </h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥ express</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»º web æœåŠ¡å™¨</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›‘å¬å®¢æˆ·ç«¯çš„ GET è¯·æ±‚ å’Œ POST è¯·æ±‚ï¼Œå¹¶å‘å®¢æˆ·ç«¯å“åº”å…·ä½“çš„å†…å®¹</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/user&#x27;</span>,<span class="function">(<span class="params">req,resp</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="comment">// è°ƒç”¨ express æä¾›çš„ res.send() æ–¹æ³•ï¼Œå‘å®¢æˆ·ç«¯å“åº”ä¸€ä¸ª JSON å¯¹è±¡</span></span><br><span class="line">    resp.<span class="title function_">send</span>(&#123;</span><br><span class="line">        <span class="attr">name</span>:<span class="string">&#x27;ache&#x27;</span>,</span><br><span class="line">        <span class="attr">age</span>:<span class="string">&#x27;19&#x27;</span>,</span><br><span class="line">        <span class="attr">sex</span>:<span class="string">&#x27;ç”·&#x27;</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/user&#x27;</span>,<span class="function">(<span class="params">req,resp</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="comment">// è°ƒç”¨ express æä¾›çš„ res.send() æ–¹æ³•ï¼Œå‘å®¢æˆ·ç«¯å“åº”ä¸€ä¸ªæ–‡æœ¬å­—ç¬¦ä¸²</span></span><br><span class="line">    resp.<span class="title function_">send</span>(<span class="string">&#x27;è¯·æ±‚æˆåŠŸï¼&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>,<span class="function">(<span class="params">req,resp</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="comment">// req.query é»˜è®¤æ˜¯ä¸€ä¸ªç©ºå¯¹è±¡</span></span><br><span class="line">    <span class="comment">// å®¢æˆ·ç«¯ä½¿ç”¨ ?name=ache&amp;age=19 è¿™ç§æŸ¥è¯¢å­—ç¬¦ä¸²å½¢å¼ï¼Œå‘é€åˆ°æœåŠ¡å™¨çš„å‚æ•°</span></span><br><span class="line">    <span class="comment">// å¯ä»¥é€šè¿‡ req.query å¯¹è±¡è®¿é—®åˆ°ï¼Œä¾‹å¦‚</span></span><br><span class="line">    <span class="comment">//      req.query.name  req.query.age</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">query</span>)</span><br><span class="line">    resp.<span class="title function_">send</span>(req.<span class="property">query</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ³¨æ„ï¼Œè¿™é‡Œçš„ :id æ˜¯ä¸€ä¸ªåŠ¨æ€çš„å‚æ•°</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/user/:id&#x27;</span>,<span class="function">(<span class="params">req,resp</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="comment">// req.params æ˜¯åŒ¹é…åˆ°çš„ URL å‚æ•°</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">params</span>)</span><br><span class="line">    resp.<span class="title function_">send</span>(req.<span class="property">params</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯åŠ¨ web æœåŠ¡å™¨</span></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">8088</span>,<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;express server running at http://127.0.0.1:8088&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>





<h4 id="æ‰˜ç®¡é™æ€èµ„æº"><a href="#æ‰˜ç®¡é™æ€èµ„æº" class="headerlink" title="æ‰˜ç®¡é™æ€èµ„æº"></a>æ‰˜ç®¡é™æ€èµ„æº</h4><h5 id="express-static"><a href="#express-static" class="headerlink" title="express.static()"></a>express.static()</h5><blockquote>
<p>express æä¾›äº†ä¸€ä¸ªéå¸¸å¥½ç”¨çš„å‡½æ•°ï¼Œå«åš express.static()ï¼Œé€šè¿‡å®ƒï¼Œæˆ‘ä»¬å¯ä»¥éå¸¸æ–¹ä¾¿åœ°åˆ›å»ºä¸€ä¸ªé™æ€èµ„æºæœåŠ¡å™¨ï¼Œ ä¾‹å¦‚ï¼Œé€šè¿‡å¦‚ä¸‹ä»£ç å°±å¯ä»¥å°† public ç›®å½•ä¸‹çš„å›¾ç‰‡ã€CSS æ–‡ä»¶ã€JavaScript æ–‡ä»¶å¯¹å¤–å¼€æ”¾è®¿é—®äº†ï¼š</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨è¿™é‡Œï¼Œè°ƒç”¨ express.static() æ–¹æ³•ï¼Œå¿«é€Ÿå¯¹å¤–æä¾›é™æ€èµ„æº</span></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">static</span>(<span class="string">&#x27;./clock&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">8088</span>,<span class="function">(<span class="params">req,reap</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;express server running at http://127.0.0.1:8088&quot;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>ç°åœ¨ï¼Œä½ å°±å¯ä»¥è®¿é—® public ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶äº†ï¼š </p>
<ol>
<li><a target="_blank" rel="noopener" href="http://127.0.0.1:8088/index.html">http://127.0.0.1:8088/index.html</a></li>
<li><a target="_blank" rel="noopener" href="http://127.0.0.1:8088/index.css">http://127.0.0.1:8088/index.css</a></li>
<li><a target="_blank" rel="noopener" href="http://127.0.0.1:8088/index.js">http://127.0.0.1:8088/index.js</a></li>
</ol>
<p>æ³¨æ„ï¼šExpress åœ¨æŒ‡å®šçš„é™æ€ç›®å½•ä¸­æŸ¥æ‰¾æ–‡ä»¶ï¼Œå¹¶å¯¹å¤–æä¾›èµ„æºçš„è®¿é—®è·¯å¾„ã€‚ å› æ­¤ï¼Œå­˜æ”¾é™æ€æ–‡ä»¶çš„ç›®å½•åä¸ä¼šå‡ºç°åœ¨ URL ä¸­ã€‚</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/ppRiSzT"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/./NodeJs.assets/ppRiSzT.png" alt="ppRiSzT.png"></a></p>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/ppRiPL4"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/./NodeJs.assets/ppRiPL4.png" alt="ppRiPL4.png"></a><a target="_blank" rel="noopener" href="https://imgse.com/i/ppRiFeJ"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/./NodeJs.assets/ppRiFeJ.png" alt="ppRiFeJ.png"></a></p>
<h5 id="æ‰˜ç®¡å¤šä¸ªé™æ€èµ„æºç›®å½•"><a href="#æ‰˜ç®¡å¤šä¸ªé™æ€èµ„æºç›®å½•" class="headerlink" title="æ‰˜ç®¡å¤šä¸ªé™æ€èµ„æºç›®å½•"></a>æ‰˜ç®¡å¤šä¸ªé™æ€èµ„æºç›®å½•</h5><blockquote>
<p>å¦‚æœè¦æ‰˜ç®¡å¤šä¸ªé™æ€èµ„æºç›®å½•ï¼Œè¯·å¤šæ¬¡è°ƒç”¨ express.static() å‡½æ•°ï¼š</p>
<p>è®¿é—®é™æ€èµ„æºæ–‡ä»¶æ—¶ï¼Œexpress.static() å‡½æ•°ä¼šæ ¹æ®ç›®å½•çš„æ·»åŠ é¡ºåºæŸ¥æ‰¾æ‰€éœ€çš„æ–‡ä»¶ã€‚</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">static</span>(<span class="string">&#x27;./clock&#x27;</span>))</span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">static</span>(<span class="string">&#x27;./files&#x27;</span>))</span><br></pre></td></tr></table></figure>



<h5 id="æŒ‚è½½è·¯å¾„å‰ç¼€"><a href="#æŒ‚è½½è·¯å¾„å‰ç¼€" class="headerlink" title="æŒ‚è½½è·¯å¾„å‰ç¼€"></a>æŒ‚è½½è·¯å¾„å‰ç¼€</h5><blockquote>
<p>å¦‚æœå¸Œæœ›åœ¨æ‰˜ç®¡çš„é™æ€èµ„æºè®¿é—®è·¯å¾„ä¹‹å‰ï¼ŒæŒ‚è½½è·¯å¾„å‰ç¼€ï¼Œåˆ™å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„æ–¹å¼ï¼š</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/public&#x27;</span>,express.<span class="title function_">static</span>(<span class="string">&#x27;./clock&#x27;</span>))</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ç°åœ¨ï¼Œä½ å°±å¯ä»¥é€šè¿‡å¸¦æœ‰ &#x2F;public å‰ç¼€åœ°å€æ¥è®¿é—® public ç›®å½•ä¸­çš„æ–‡ä»¶äº†ï¼š </p>
<ol>
<li><a target="_blank" rel="noopener" href="http://127.0.0.1:8088/public/index.html">http://127.0.0.1:8088/public/index.html</a></li>
<li><a target="_blank" rel="noopener" href="http://127.0.0.1:8088/public/index.css">http://127.0.0.1:8088/public/index.css</a></li>
<li><a target="_blank" rel="noopener" href="http://127.0.0.1:8088/public/index.js">http://127.0.0.1:8088/public/index.js</a></li>
</ol>
</blockquote>
<h5 id="nodemon"><a href="#nodemon" class="headerlink" title="nodemon"></a>nodemon</h5><h6 id="ä¸ºä»€ä¹ˆè¦ä½¿ç”¨-nodemon"><a href="#ä¸ºä»€ä¹ˆè¦ä½¿ç”¨-nodemon" class="headerlink" title="ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ nodemon"></a>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ nodemon</h6><blockquote>
<p>åœ¨ç¼–å†™è°ƒè¯• Node.js é¡¹ç›®çš„æ—¶å€™ï¼Œå¦‚æœä¿®æ”¹äº†é¡¹ç›®çš„ä»£ç ï¼Œåˆ™éœ€è¦é¢‘ç¹çš„æ‰‹åŠ¨ close æ‰ï¼Œç„¶åå†é‡æ–°å¯åŠ¨ï¼Œéå¸¸ç¹çã€‚ </p>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ nodemonï¼ˆ<a target="_blank" rel="noopener" href="https://www.npmjs.com/package/nodemon%EF%BC%89">https://www.npmjs.com/package/nodemonï¼‰</a> è¿™ä¸ªå·¥å…·ï¼Œå®ƒèƒ½å¤Ÿç›‘å¬é¡¹ç›®æ–‡ä»¶ çš„å˜åŠ¨ï¼Œå½“ä»£ç è¢«ä¿®æ”¹åï¼Œnodemon ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬é‡å¯é¡¹ç›®ï¼Œæå¤§æ–¹ä¾¿äº†å¼€å‘å’Œè°ƒè¯•</p>
</blockquote>
<h6 id="å®‰è£…-nodemon"><a href="#å®‰è£…-nodemon" class="headerlink" title="å®‰è£… nodemon"></a>å®‰è£… nodemon</h6><blockquote>
<p>åœ¨ç»ˆç«¯ä¸­ï¼Œè¿è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå³å¯å°† nodemon å®‰è£…ä¸ºå…¨å±€å¯ç”¨çš„å·¥å…·</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g nodemon</span><br></pre></td></tr></table></figure>
</blockquote>
<h6 id="ä½¿ç”¨-nodemon"><a href="#ä½¿ç”¨-nodemon" class="headerlink" title="ä½¿ç”¨ nodemon"></a>ä½¿ç”¨ nodemon</h6><blockquote>
<p> å½“åŸºäº Node.js ç¼–å†™äº†ä¸€ä¸ªç½‘ç«™åº”ç”¨çš„æ—¶å€™ï¼Œä¼ ç»Ÿçš„æ–¹å¼ï¼Œæ˜¯è¿è¡Œ node app.js å‘½ä»¤ï¼Œæ¥å¯åŠ¨é¡¹ç›®ã€‚è¿™æ ·åšçš„åå¤„æ˜¯ï¼š ä»£ç è¢«ä¿®æ”¹ä¹‹åï¼Œéœ€è¦æ‰‹åŠ¨é‡å¯é¡¹ç›®ã€‚</p>
<p> ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥å°† node å‘½ä»¤æ›¿æ¢ä¸º nodemon å‘½ä»¤ï¼Œä½¿ç”¨ nodemon app.js æ¥å¯åŠ¨é¡¹ç›®ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼šä»£ç  è¢«ä¿®æ”¹ä¹‹åï¼Œä¼šè¢« nodemon ç›‘å¬åˆ°ï¼Œä»è€Œå®ç°è‡ªåŠ¨é‡å¯é¡¹ç›®çš„æ•ˆæœã€‚</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">node app.js</span><br><span class="line"><span class="comment"># å°†ä¸Šé¢çš„ç»ˆç«¯å‘½ä»¤ï¼Œæ›¿æ¢ä¸ºä¸‹é¢çš„ç»ˆç«¯å‘½ä»¤ï¼Œå³å¯å®ç°è‡ªåŠ¨é‡å¯é¡¹ç›®çš„æ•ˆæœ</span></span><br><span class="line">nodemon app.js</span><br></pre></td></tr></table></figure>





<h4 id="Express-è·¯ç”±"><a href="#Express-è·¯ç”±" class="headerlink" title="Express è·¯ç”±"></a>Express è·¯ç”±</h4><h5 id="è·¯ç”±çš„æ¦‚å¿µ"><a href="#è·¯ç”±çš„æ¦‚å¿µ" class="headerlink" title="è·¯ç”±çš„æ¦‚å¿µ"></a>è·¯ç”±çš„æ¦‚å¿µ</h5><h6 id="ä»€ä¹ˆæ˜¯è·¯ç”±"><a href="#ä»€ä¹ˆæ˜¯è·¯ç”±" class="headerlink" title="ä»€ä¹ˆæ˜¯è·¯ç”±"></a>ä»€ä¹ˆæ˜¯è·¯ç”±</h6><blockquote>
<p>å¹¿ä¹‰ä¸Šæ¥è®²ï¼Œè·¯ç”±å°±æ˜¯æ˜ å°„å…³ç³»ã€‚</p>
</blockquote>
<h6 id="ç°å®ç”Ÿæ´»ä¸­çš„è·¯ç”±"><a href="#ç°å®ç”Ÿæ´»ä¸­çš„è·¯ç”±" class="headerlink" title="ç°å®ç”Ÿæ´»ä¸­çš„è·¯ç”±"></a>ç°å®ç”Ÿæ´»ä¸­çš„è·¯ç”±</h6><blockquote>
<p>æŒ‰é”® 1 -&gt; ä¸šåŠ¡æŸ¥è¯¢ </p>
<p>æŒ‰é”® 2 -&gt; æ‰‹æœºå……å€¼ </p>
<p>æŒ‰é”® 3 -&gt; ä¸šåŠ¡åŠç† </p>
<p>æŒ‰é”® 4 -&gt; å¯†ç æœåŠ¡ä¸åœå¤æœº </p>
<p>æŒ‰é”® 5 -&gt; å®¶åº­å®½å¸¦ </p>
<p>æŒ‰é”® 6 -&gt; è¯è´¹æµé‡ </p>
<p>æŒ‰é”® 8 -&gt; é›†å›¢ä¸šåŠ¡ </p>
<p>æŒ‰é”® 0 -&gt; äººå·¥æœåŠ¡</p>
<p>åœ¨è¿™é‡Œï¼Œè·¯ç”±æ˜¯æŒ‰é”®ä¸æœåŠ¡ä¹‹é—´çš„æ˜ å°„å…³ç³»</p>
</blockquote>
<h6 id="Express-ä¸­çš„è·¯ç”±"><a href="#Express-ä¸­çš„è·¯ç”±" class="headerlink" title="Express ä¸­çš„è·¯ç”±"></a>Express ä¸­çš„è·¯ç”±</h6><blockquote>
<p>åœ¨ Express ä¸­ï¼Œè·¯ç”±æŒ‡çš„æ˜¯å®¢æˆ·ç«¯çš„è¯·æ±‚ä¸æœåŠ¡å™¨å¤„ç†å‡½æ•°ä¹‹é—´çš„æ˜ å°„å…³ç³»ã€‚ </p>
<p>Express ä¸­çš„è·¯ç”±åˆ† 3 éƒ¨åˆ†ç»„æˆï¼Œåˆ†åˆ«æ˜¯è¯·æ±‚çš„ç±»å‹ã€è¯·æ±‚çš„ URL åœ°å€ã€å¤„ç†å‡½æ•°ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">METHOD</span>(<span class="variable constant_">PATH</span>,<span class="variable constant_">HANDLER</span>)</span><br></pre></td></tr></table></figure>



<h6 id="Express-ä¸­çš„è·¯ç”±çš„ä¾‹å­"><a href="#Express-ä¸­çš„è·¯ç”±çš„ä¾‹å­" class="headerlink" title="Express ä¸­çš„è·¯ç”±çš„ä¾‹å­"></a>Express ä¸­çš„è·¯ç”±çš„ä¾‹å­</h6><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åŒ¹é… GET è¯·æ±‚ï¼Œä¸”è¯·æ±‚çš„ URL ä¸º /</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>,<span class="function">(<span class="params">req,resp</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(get)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// åŒ¹é… POST è¯·æ±‚ï¼Œä¸”è¯·æ±‚çš„ URL ä¸º /</span></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/&#x27;</span>,<span class="function">(<span class="params">req,resp</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;post&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>





<h6 id="è·¯ç”±çš„åŒ¹é…è¿‡ç¨‹"><a href="#è·¯ç”±çš„åŒ¹é…è¿‡ç¨‹" class="headerlink" title="è·¯ç”±çš„åŒ¹é…è¿‡ç¨‹"></a>è·¯ç”±çš„åŒ¹é…è¿‡ç¨‹</h6><p><a target="_blank" rel="noopener" href="https://imgse.com/i/ppgw8Fs"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/./NodeJs.assets/ppgw8Fs.png" alt="ppgw8Fs.png"></a></p>
<h5 id="è·¯ç”±çš„ä½¿ç”¨"><a href="#è·¯ç”±çš„ä½¿ç”¨" class="headerlink" title="è·¯ç”±çš„ä½¿ç”¨"></a>è·¯ç”±çš„ä½¿ç”¨</h5><h6 id="æœ€ç®€å•çš„ç”¨æ³•"><a href="#æœ€ç®€å•çš„ç”¨æ³•" class="headerlink" title="æœ€ç®€å•çš„ç”¨æ³•"></a>æœ€ç®€å•çš„ç”¨æ³•</h6><blockquote>
<p>åœ¨ Express ä¸­ä½¿ç”¨è·¯ç”±æœ€ç®€å•çš„æ–¹å¼ï¼Œå°±æ˜¯æŠŠè·¯ç”±æŒ‚è½½åˆ° app ä¸Šï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŒ‚è½½è·¯ç”±</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>,<span class="function">(<span class="params">req,resp</span>)=&gt;</span>&#123;</span><br><span class="line">    resp.<span class="title function_">send</span>(<span class="string">&#x27;Get è¯·æ±‚&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/&#x27;</span>,<span class="function">(<span class="params">req,resp</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Post è¯·æ±‚&quot;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">8088</span>,<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;express server running at http://127.0.0.1:8088&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h6 id="æ¨¡å—åŒ–è·¯ç”±"><a href="#æ¨¡å—åŒ–è·¯ç”±" class="headerlink" title="æ¨¡å—åŒ–è·¯ç”±"></a>æ¨¡å—åŒ–è·¯ç”±</h6><blockquote>
<p>ä¸ºäº†æ–¹ä¾¿å¯¹è·¯ç”±è¿›è¡Œæ¨¡å—åŒ–çš„ç®¡ç†ï¼ŒExpress ä¸å»ºè®®å°†è·¯ç”±ç›´æ¥æŒ‚è½½åˆ° app ä¸Šï¼Œè€Œæ˜¯æ¨èå°†è·¯ç”±æŠ½ç¦»ä¸ºå•ç‹¬çš„æ¨¡å—ã€‚</p>
<p> å°†è·¯ç”±æŠ½ç¦»ä¸ºå•ç‹¬æ¨¡å—çš„æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol>
<li>åˆ›å»ºè·¯ç”±æ¨¡å—å¯¹åº”çš„ .js æ–‡ä»¶</li>
<li>è°ƒç”¨ <strong>express.Router()</strong> å‡½æ•°åˆ›å»ºè·¯ç”±å¯¹è±¡</li>
<li>å‘è·¯ç”±å¯¹è±¡ä¸ŠæŒ‚è½½å…·ä½“çš„è·¯ç”±</li>
<li>ä½¿ç”¨ module.exports å‘å¤–å…±äº«è·¯ç”±å¯¹è±¡</li>
<li>ä½¿ç”¨ app.use() å‡½æ•°æ³¨å†Œè·¯ç”±æ¨¡å—</li>
</ol>
</blockquote>
<h6 id="åˆ›å»ºè·¯ç”±æ¨¡å—"><a href="#åˆ›å»ºè·¯ç”±æ¨¡å—" class="headerlink" title="åˆ›å»ºè·¯ç”±æ¨¡å—"></a>åˆ›å»ºè·¯ç”±æ¨¡å—</h6><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è·¯ç”±æ¨¡å—</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¼å…¥ express</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºè·¯ç”±å¯¹è±¡</span></span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŒ‚è½½å…·ä½“çš„è·¯ç”±</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/user/list&#x27;</span>,<span class="function">(<span class="params">req,resp</span>)=&gt;</span>&#123;</span><br><span class="line">    resp.<span class="title function_">send</span>(<span class="string">&quot;Get user list&quot;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/user/add&#x27;</span>,<span class="function">(<span class="params">req,resp</span>)=&gt;</span>&#123;</span><br><span class="line">    resp.<span class="title function_">send</span>(<span class="string">&quot;Post user add&quot;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‘å¤–å¯¼å‡ºè·¯ç”±å¯¹è±¡</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router</span><br></pre></td></tr></table></figure>



<h6 id="æ³¨å†Œè·¯ç”±æ¨¡å—"><a href="#æ³¨å†Œè·¯ç”±æ¨¡å—" class="headerlink" title="æ³¨å†Œè·¯ç”±æ¨¡å—"></a>æ³¨å†Œè·¯ç”±æ¨¡å—</h6><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. å¯¼å…¥è·¯ç”±æ¨¡å—</span></span><br><span class="line"><span class="keyword">const</span> router = <span class="built_in">require</span>(<span class="string">&#x27;./02_router&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. æ³¨å†Œè·¯ç”±æ¨¡å—</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/api&#x27;</span>, router)</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ³¨æ„ï¼š app.use() å‡½æ•°çš„ä½œç”¨ï¼Œå°±æ˜¯æ¥æ³¨å†Œå…¨å±€ä¸­é—´ä»¶</span></span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">8088</span>,<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;express server running at http://127.0.0.1:8088&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h6 id="ä¸ºè·¯ç”±æ¨¡å—æ·»åŠ å‰ç¼€"><a href="#ä¸ºè·¯ç”±æ¨¡å—æ·»åŠ å‰ç¼€" class="headerlink" title="ä¸ºè·¯ç”±æ¨¡å—æ·»åŠ å‰ç¼€"></a>ä¸ºè·¯ç”±æ¨¡å—æ·»åŠ å‰ç¼€</h6><blockquote>
<p>ç±»ä¼¼äºæ‰˜ç®¡é™æ€èµ„æºæ—¶ï¼Œä¸ºé™æ€èµ„æºç»Ÿä¸€æŒ‚è½½è®¿é—®å‰ç¼€ä¸€æ ·ï¼Œè·¯ç”±æ¨¡å—æ·»åŠ å‰ç¼€çš„æ–¹å¼ä¹Ÿéå¸¸ç®€å•ï¼š</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¢åŠ è®¿é—®å‰ç¼€</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/api&#x27;</span>, router)</span><br></pre></td></tr></table></figure>





<h5 id="ä¸­é—´ä»¶çš„æ¦‚å¿µ"><a href="#ä¸­é—´ä»¶çš„æ¦‚å¿µ" class="headerlink" title="ä¸­é—´ä»¶çš„æ¦‚å¿µ"></a>ä¸­é—´ä»¶çš„æ¦‚å¿µ</h5><h6 id="ä»€ä¹ˆæ˜¯ä¸­é—´ä»¶"><a href="#ä»€ä¹ˆæ˜¯ä¸­é—´ä»¶" class="headerlink" title="ä»€ä¹ˆæ˜¯ä¸­é—´ä»¶"></a>ä»€ä¹ˆæ˜¯ä¸­é—´ä»¶</h6><blockquote>
<p>ä¸­é—´ä»¶ï¼ˆMiddleware ï¼‰ï¼Œç‰¹æŒ‡ä¸šåŠ¡æµç¨‹çš„ä¸­é—´å¤„ç†ç¯èŠ‚ã€‚</p>
</blockquote>
<h6 id="ç°å®ç”Ÿæ´»ä¸­çš„ä¾‹å­"><a href="#ç°å®ç”Ÿæ´»ä¸­çš„ä¾‹å­" class="headerlink" title="ç°å®ç”Ÿæ´»ä¸­çš„ä¾‹å­"></a>ç°å®ç”Ÿæ´»ä¸­çš„ä¾‹å­</h6><blockquote>
<p>åœ¨å¤„ç†æ±¡æ°´çš„æ—¶å€™ï¼Œä¸€èˆ¬éƒ½è¦ç»è¿‡ä¸‰ä¸ªå¤„ç†ç¯èŠ‚ï¼Œä»è€Œä¿è¯å¤„ç†è¿‡åçš„åºŸæ°´ï¼Œè¾¾åˆ°æ’æ”¾æ ‡å‡†ã€‚</p>
<p>å¤„ç†æ±¡æ°´çš„è¿™ä¸‰ä¸ªä¸­é—´å¤„ç†ç¯èŠ‚ï¼Œå°±å¯ä»¥å«åšä¸­é—´ä»¶ã€‚</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/ppgwBTJ"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/./NodeJs.assets/ppgwBTJ.png" alt="ppgwBTJ.png"></a></p>
<h6 id="Express-ä¸­é—´ä»¶çš„è°ƒç”¨æµç¨‹"><a href="#Express-ä¸­é—´ä»¶çš„è°ƒç”¨æµç¨‹" class="headerlink" title="Express ä¸­é—´ä»¶çš„è°ƒç”¨æµç¨‹"></a>Express ä¸­é—´ä»¶çš„è°ƒç”¨æµç¨‹</h6><blockquote>
<p>å½“ä¸€ä¸ªè¯·æ±‚åˆ°è¾¾ Express çš„æœåŠ¡å™¨ä¹‹åï¼Œå¯ä»¥è¿ç»­è°ƒç”¨å¤šä¸ªä¸­é—´ä»¶ï¼Œä»è€Œå¯¹è¿™æ¬¡è¯·æ±‚è¿›è¡Œé¢„å¤„ç†ã€‚</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/ppgwcSx"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/./NodeJs.assets/ppgwcSx.png" alt="ppgwcSx.png"></a></p>
<h6 id="Express-ä¸­é—´ä»¶çš„æ ¼å¼"><a href="#Express-ä¸­é—´ä»¶çš„æ ¼å¼" class="headerlink" title="Express ä¸­é—´ä»¶çš„æ ¼å¼"></a>Express ä¸­é—´ä»¶çš„æ ¼å¼</h6><blockquote>
<p>Express çš„ä¸­é—´ä»¶ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ª function å¤„ç†å‡½æ•°ï¼ŒExpress ä¸­é—´ä»¶çš„æ ¼å¼å¦‚ä¸‹ï¼š</p>
<p><strong>æ³¨æ„ï¼šä¸­é—´ä»¶å‡½æ•°çš„å½¢å‚åˆ—è¡¨ä¸­ï¼Œå¿…é¡»åŒ…å« next å‚æ•°ã€‚è€Œè·¯ç”±å¤„ç†å‡½æ•°ä¸­åªåŒ…å« req å’Œ resã€‚</strong></p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/ppgwIkd"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/./NodeJs.assets/ppgwIkd.png" alt="ppgwIkd.png"></a></p>
<h6 id="next-å‡½æ•°çš„ä½œç”¨"><a href="#next-å‡½æ•°çš„ä½œç”¨" class="headerlink" title="next å‡½æ•°çš„ä½œç”¨"></a>next å‡½æ•°çš„ä½œç”¨</h6><blockquote>
<p><strong>next å‡½æ•°æ˜¯å®ç°å¤šä¸ªä¸­é—´ä»¶è¿ç»­è°ƒç”¨çš„å…³é”®ï¼Œå®ƒè¡¨ç¤ºæŠŠæµè½¬å…³ç³»è½¬äº¤ç»™ä¸‹ä¸€ä¸ªä¸­é—´ä»¶æˆ–è·¯ç”±ã€‚</strong></p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/ppgwotA"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/./NodeJs.assets/ppgwotA.png" alt="ppgwotA.png"></a></p>
<h4 id="Express-ä¸­é—´ä»¶çš„åˆä½“éªŒ"><a href="#Express-ä¸­é—´ä»¶çš„åˆä½“éªŒ" class="headerlink" title="Express ä¸­é—´ä»¶çš„åˆä½“éªŒ"></a>Express ä¸­é—´ä»¶çš„åˆä½“éªŒ</h4><h5 id="å®šä¹‰ä¸­é—´ä»¶å‡½æ•°"><a href="#å®šä¹‰ä¸­é—´ä»¶å‡½æ•°" class="headerlink" title="å®šä¹‰ä¸­é—´ä»¶å‡½æ•°"></a>å®šä¹‰ä¸­é—´ä»¶å‡½æ•°</h5><blockquote>
<p><strong>æœ‰ç‚¹åƒè¿‡æ»¤å™¨ï¼Œå¹¶ä¸”å…¨å±€æ·»åŠ å±æ€§</strong></p>
<p>å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„æ–¹å¼ï¼Œå®šä¹‰ä¸€ä¸ªæœ€ç®€å•çš„ä¸­é—´ä»¶å‡½æ•°ï¼š</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªæœ€ç®€å•çš„ä¸­é—´ä»¶å‡½æ•°</span></span><br><span class="line"><span class="keyword">const</span> vm = <span class="keyword">function</span> (<span class="params">req,resp,next</span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;è¿™æ˜¯æœ€ç®€å•çš„ä¸­é—´ä»¶å‡½æ•°&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æµè½¬å…³ç³»ï¼Œè½¬äº¤ç»™ä¸‹ä¸€ä¸ªä¸­é—´ä»¶æˆ–è·¯ç”±</span></span><br><span class="line">    <span class="title function_">next</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="å…¨å±€ç”Ÿæ•ˆçš„ä¸­é—´ä»¶"><a href="#å…¨å±€ç”Ÿæ•ˆçš„ä¸­é—´ä»¶" class="headerlink" title="å…¨å±€ç”Ÿæ•ˆçš„ä¸­é—´ä»¶"></a>å…¨å±€ç”Ÿæ•ˆçš„ä¸­é—´ä»¶</h5><blockquote>
<p>å®¢æˆ·ç«¯å‘èµ·çš„<strong>ä»»ä½•è¯·æ±‚</strong>ï¼Œåˆ°è¾¾æœåŠ¡å™¨ä¹‹åï¼Œéƒ½ä¼šè§¦å‘çš„ä¸­é—´ä»¶ï¼Œå«åšå…¨å±€ç”Ÿæ•ˆçš„ä¸­é—´ä»¶ã€‚ é€šè¿‡è°ƒç”¨ **app.use(ä¸­é—´ä»¶å‡½æ•°)**ï¼Œå³å¯å®šä¹‰ä¸€ä¸ªå…¨å±€ç”Ÿæ•ˆçš„ä¸­é—´ä»¶ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªæœ€ç®€å•çš„ä¸­é—´ä»¶å‡½æ•°</span></span><br><span class="line"><span class="keyword">const</span> mv = <span class="keyword">function</span> (<span class="params">req,resp,next</span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;è¿™æ˜¯æœ€ç®€å•çš„ä¸­é—´ä»¶å‡½æ•°&quot;</span>)</span><br><span class="line">    <span class="comment">// æµè½¬å…³ç³»ï¼Œè½¬äº¤ç»™ä¸‹ä¸€ä¸ªä¸­é—´ä»¶æˆ–è·¯ç”±</span></span><br><span class="line">    <span class="title function_">next</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å°† vm æ³¨å†Œä¸ºå…¨å±€ç”Ÿæ•ˆçš„ä¸­é—´ä»¶</span></span><br><span class="line">app.<span class="title function_">use</span>(mv)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>,<span class="function">(<span class="params">req,resp</span>)=&gt;</span>&#123;</span><br><span class="line">    resp.<span class="title function_">send</span>(<span class="string">&#x27;Home Page&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/user&#x27;</span>,<span class="function">(<span class="params">req,resp</span>)=&gt;</span>&#123;</span><br><span class="line">    resp.<span class="title function_">send</span>(<span class="string">&#x27;User Page&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">8088</span>,<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;express server running at http://127.0.0.1:8088&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://imgse.com/i/ppRQnUK"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/./NodeJs.assets/ppRQnUK.png" alt="ppRQnUK.png"></a><a target="_blank" rel="noopener" href="https://imgse.com/i/ppRQQ8e"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.ax1x.com/2023/03/31/ppRQQ8e.png" alt="ppRQQ8e.png"></a></p>
<h5 id="å®šä¹‰å…¨å±€ä¸­é—´ä»¶çš„ç®€åŒ–å½¢å¼"><a href="#å®šä¹‰å…¨å±€ä¸­é—´ä»¶çš„ç®€åŒ–å½¢å¼" class="headerlink" title="å®šä¹‰å…¨å±€ä¸­é—´ä»¶çš„ç®€åŒ–å½¢å¼"></a>å®šä¹‰å…¨å±€ä¸­é—´ä»¶çš„ç®€åŒ–å½¢å¼</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">req,resp,next</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;è¿™æ˜¯æœ€ç®€å•çš„ä¸­é—´ä»¶å‡½æ•°&quot;</span>)</span><br><span class="line">    <span class="title function_">next</span>()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">req, resp</span>) =&gt;</span> &#123;</span><br><span class="line">    resp.<span class="title function_">send</span>(<span class="string">&#x27;Home Page&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/user&#x27;</span>, <span class="function">(<span class="params">req, resp</span>) =&gt;</span> &#123;</span><br><span class="line">    resp.<span class="title function_">send</span>(<span class="string">&#x27;User Page&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">8088</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;express server running at http://127.0.0.1:8088&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h5 id="ä¸­é—´ä»¶çš„ä½œç”¨"><a href="#ä¸­é—´ä»¶çš„ä½œç”¨" class="headerlink" title="ä¸­é—´ä»¶çš„ä½œç”¨"></a>ä¸­é—´ä»¶çš„ä½œç”¨</h5><blockquote>
<p>å¤šä¸ªä¸­é—´ä»¶ä¹‹é—´ï¼Œå…±äº«åŒä¸€ä»½ req å’Œ resã€‚åŸºäºè¿™æ ·çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸Šæ¸¸çš„ä¸­é—´ä»¶ä¸­ï¼Œç»Ÿä¸€ä¸º req æˆ– res å¯¹è±¡æ·» åŠ è‡ªå®šä¹‰çš„å±æ€§æˆ–æ–¹æ³•ï¼Œä¾›ä¸‹æ¸¸çš„ä¸­é—´ä»¶æˆ–è·¯ç”±è¿›è¡Œä½¿ç”¨ã€‚</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/ppgwv7Q"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/./NodeJs.assets/ppgwv7Q.png" alt="ppgwv7Q.png"></a></p>
<h5 id="å®šä¹‰å¤šä¸ªå…¨å±€ä¸­é—´ä»¶"><a href="#å®šä¹‰å¤šä¸ªå…¨å±€ä¸­é—´ä»¶" class="headerlink" title="å®šä¹‰å¤šä¸ªå…¨å±€ä¸­é—´ä»¶"></a>å®šä¹‰å¤šä¸ªå…¨å±€ä¸­é—´ä»¶</h5><blockquote>
<p>å¯ä»¥ä½¿ç”¨ app.use() è¿ç»­å®šä¹‰å¤šä¸ªå…¨å±€ä¸­é—´ä»¶ã€‚å®¢æˆ·ç«¯è¯·æ±‚åˆ°è¾¾æœåŠ¡å™¨ä¹‹åï¼Œä¼šæŒ‰ç…§ä¸­é—´ä»¶å®šä¹‰çš„å…ˆåé¡ºåºä¾æ¬¡è¿›è¡Œ è°ƒç”¨ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ç¬¬ä¸€ä¸ªå…¨å±€ä¸­é—´ä»¶</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;è°ƒç”¨äº†ç¬¬1ä¸ªå…¨å±€ä¸­é—´ä»¶&#x27;</span>)</span><br><span class="line">    <span class="title function_">next</span>()</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// å®šä¹‰ç¬¬äºŒä¸ªå…¨å±€ä¸­é—´ä»¶</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;è°ƒç”¨äº†ç¬¬2ä¸ªå…¨å±€ä¸­é—´ä»¶&#x27;</span>)</span><br><span class="line">    <span class="title function_">next</span>()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªè·¯ç”±</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/user&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&#x27;User page.&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">8088</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;express server running at http://127.0.0.1:8088&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>





<h5 id="å±€éƒ¨ç”Ÿæ•ˆçš„ä¸­é—´ä»¶"><a href="#å±€éƒ¨ç”Ÿæ•ˆçš„ä¸­é—´ä»¶" class="headerlink" title="å±€éƒ¨ç”Ÿæ•ˆçš„ä¸­é—´ä»¶"></a>å±€éƒ¨ç”Ÿæ•ˆçš„ä¸­é—´ä»¶</h5><blockquote>
<p>ä¸ä½¿ç”¨ app.use() å®šä¹‰çš„ä¸­é—´ä»¶ï¼Œå«åšå±€éƒ¨ç”Ÿæ•ˆçš„ä¸­é—´ä»¶ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥ express æ¨¡å—</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="comment">// åˆ›å»º express çš„æœåŠ¡å™¨å®ä¾‹</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. å®šä¹‰ä¸­é—´ä»¶å‡½æ•°</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">mw1</span> = (<span class="params">req, res, next</span>) =&gt; &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;è°ƒç”¨äº†ç¬¬ä¸€ä¸ªå±€éƒ¨ç”Ÿæ•ˆçš„ä¸­é—´ä»¶&#x27;</span>)</span><br><span class="line">    <span class="title function_">next</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. åˆ›å»ºè·¯ç”±</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>,mw1, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&#x27;Home page.&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/user&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&#x27;User page.&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// è°ƒç”¨ app.listen æ–¹æ³•ï¼ŒæŒ‡å®šç«¯å£å·å¹¶å¯åŠ¨webæœåŠ¡å™¨</span></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">8088</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;express server running at http://127.0.0.1:8088&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h5 id="å®šä¹‰å¤šä¸ªå±€éƒ¨ä¸­é—´ä»¶"><a href="#å®šä¹‰å¤šä¸ªå±€éƒ¨ä¸­é—´ä»¶" class="headerlink" title="å®šä¹‰å¤šä¸ªå±€éƒ¨ä¸­é—´ä»¶"></a>å®šä¹‰å¤šä¸ªå±€éƒ¨ä¸­é—´ä»¶</h5><blockquote>
<p>å¯ä»¥åœ¨è·¯ç”±ä¸­ï¼Œé€šè¿‡å¦‚ä¸‹ä¸¤ç§ç­‰ä»·çš„æ–¹å¼ï¼Œä½¿ç”¨å¤šä¸ªå±€éƒ¨ä¸­é—´ä»¶ï¼š</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥ express æ¨¡å—</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="comment">// åˆ›å»º express çš„æœåŠ¡å™¨å®ä¾‹</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. å®šä¹‰ä¸­é—´ä»¶å‡½æ•°</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">mw1</span> = (<span class="params">req, resp, next</span>) =&gt; &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;è°ƒç”¨äº†ç¬¬ä¸€ä¸ªå±€éƒ¨ç”Ÿæ•ˆçš„ä¸­é—´ä»¶&#x27;</span>)</span><br><span class="line">    <span class="title function_">next</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">mw2</span> = (<span class="params">req, resp, next</span>) =&gt; &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;è°ƒç”¨äº†ç¬¬äºŒä¸ªå±€éƒ¨ç”Ÿæ•ˆçš„ä¸­é—´ä»¶&#x27;</span>)</span><br><span class="line">    <span class="title function_">next</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. åˆ›å»ºè·¯ç”±</span></span><br><span class="line"><span class="comment">// app.get(&#x27;/&#x27;, [mw1, mw2], (req, res) =&gt; &#123;</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, mw1, mw2, <span class="function">(<span class="params">req, resp</span>) =&gt;</span> &#123;</span><br><span class="line">    resp.<span class="title function_">send</span>(<span class="string">&#x27;Home page.&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/user&#x27;</span>, <span class="function">(<span class="params">req, resp</span>) =&gt;</span> &#123;</span><br><span class="line">    resp.<span class="title function_">send</span>(<span class="string">&#x27;User page.&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// è°ƒç”¨ app.listen æ–¹æ³•ï¼ŒæŒ‡å®šç«¯å£å·å¹¶å¯åŠ¨webæœåŠ¡å™¨</span></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">8088</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;express server running at http://127.0.0.1:8088&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h5 id="äº†è§£ä¸­é—´ä»¶çš„5ä¸ªä½¿ç”¨æ³¨æ„äº‹é¡¹"><a href="#äº†è§£ä¸­é—´ä»¶çš„5ä¸ªä½¿ç”¨æ³¨æ„äº‹é¡¹" class="headerlink" title="äº†è§£ä¸­é—´ä»¶çš„5ä¸ªä½¿ç”¨æ³¨æ„äº‹é¡¹"></a>äº†è§£ä¸­é—´ä»¶çš„5ä¸ªä½¿ç”¨æ³¨æ„äº‹é¡¹</h5><blockquote>
<ol>
<li>ä¸€å®šè¦åœ¨è·¯ç”±ä¹‹å‰æ³¨å†Œä¸­é—´ä»¶</li>
<li>å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„è¯·æ±‚ï¼Œå¯ä»¥è¿ç»­è°ƒç”¨å¤šä¸ªä¸­é—´ä»¶è¿›è¡Œå¤„ç†</li>
<li>æ‰§è¡Œå®Œä¸­é—´ä»¶çš„ä¸šåŠ¡ä»£ç ä¹‹åï¼Œä¸è¦å¿˜è®°è°ƒç”¨ next() å‡½æ•°</li>
<li>ä¸ºäº†é˜²æ­¢ä»£ç é€»è¾‘æ··ä¹±ï¼Œè°ƒç”¨ next() å‡½æ•°åä¸è¦å†å†™é¢å¤–çš„ä»£ç </li>
<li>è¿ç»­è°ƒç”¨å¤šä¸ªä¸­é—´ä»¶æ—¶ï¼Œå¤šä¸ªä¸­é—´ä»¶ä¹‹é—´ï¼Œå…±äº« req å’Œ res å¯¹è±¡</li>
</ol>
</blockquote>
<h4 id="ä¸­é—´ä»¶çš„åˆ†ç±»"><a href="#ä¸­é—´ä»¶çš„åˆ†ç±»" class="headerlink" title="ä¸­é—´ä»¶çš„åˆ†ç±»"></a>ä¸­é—´ä»¶çš„åˆ†ç±»</h4><blockquote>
<p>ä¸ºäº†æ–¹ä¾¿å¤§å®¶ç†è§£å’Œè®°å¿†ä¸­é—´ä»¶çš„ä½¿ç”¨ï¼ŒExpress å®˜æ–¹æŠŠå¸¸è§çš„ä¸­é—´ä»¶ç”¨æ³•ï¼Œ</p>
<p>åˆ†æˆäº† 5 å¤§ç±»ï¼Œåˆ†åˆ«æ˜¯ï¼š</p>
<ol>
<li>åº”ç”¨çº§åˆ«çš„ä¸­é—´ä»¶ </li>
<li>è·¯ç”±çº§åˆ«çš„ä¸­é—´ä»¶</li>
<li>é”™è¯¯çº§åˆ«çš„ä¸­é—´ä»¶</li>
<li>Express å†…ç½®çš„ä¸­é—´ä»¶</li>
<li>ç¬¬ä¸‰æ–¹çš„ä¸­é—´ä»¶</li>
</ol>
</blockquote>
<h5 id="åº”ç”¨çº§åˆ«çš„ä¸­é—´ä»¶"><a href="#åº”ç”¨çº§åˆ«çš„ä¸­é—´ä»¶" class="headerlink" title="åº”ç”¨çº§åˆ«çš„ä¸­é—´ä»¶"></a>åº”ç”¨çº§åˆ«çš„ä¸­é—´ä»¶</h5><blockquote>
<p>é€šè¿‡ app.use() æˆ– app.get() æˆ– app.post() ï¼Œç»‘å®šåˆ° app å®ä¾‹ä¸Šçš„ä¸­é—´ä»¶ï¼Œå«åšåº”ç”¨çº§åˆ«çš„ä¸­é—´ä»¶ï¼Œä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åº”ç”¨çº§åˆ«çš„ä¸­é—´ä»¶ï¼ˆå…¨å±€ä¸­é—´ä»¶ï¼‰</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">req,resp,next</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="title function_">next</span>()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// åº”ç”¨çº§åˆ«çš„ä¸­é—´ä»¶</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>,mw1,<span class="function">(<span class="params">req,resp</span>)=&gt;</span>&#123;</span><br><span class="line">    resp.<span class="title function_">send</span>(<span class="string">&#x27;Home Page&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h5 id="è·¯ç”±çº§åˆ«çš„ä¸­é—´ä»¶"><a href="#è·¯ç”±çº§åˆ«çš„ä¸­é—´ä»¶" class="headerlink" title="è·¯ç”±çº§åˆ«çš„ä¸­é—´ä»¶"></a>è·¯ç”±çº§åˆ«çš„ä¸­é—´ä»¶</h5><blockquote>
<p>ç»‘å®šåˆ° express.Router() å®ä¾‹ä¸Šçš„ä¸­é—´ä»¶ï¼Œå«åšè·¯ç”±çº§åˆ«çš„ä¸­é—´ä»¶ã€‚å®ƒçš„ç”¨æ³•å’Œåº”ç”¨çº§åˆ«ä¸­é—´ä»¶æ²¡æœ‰ä»»ä½•åŒºåˆ«ã€‚åªä¸ è¿‡ï¼Œåº”ç”¨çº§åˆ«ä¸­é—´ä»¶æ˜¯ç»‘å®šåˆ° app å®ä¾‹ä¸Šï¼Œè·¯ç”±çº§åˆ«ä¸­é—´ä»¶ç»‘å®šåˆ° router å®ä¾‹ä¸Šï¼Œä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> app = <span class="title function_">express</span>()</span><br><span class="line"><span class="keyword">var</span> router = <span class="title function_">express</span>().<span class="title class_">Router</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·¯ç”±çº§åˆ«çš„ä¸­é—´ä»¶</span></span><br><span class="line">router.<span class="title function_">use</span>(<span class="keyword">function</span>(<span class="params">req,resp,next</span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Timeï¼š&quot;</span> + <span class="title class_">Data</span>.<span class="title function_">now</span>())</span><br><span class="line">    <span class="title function_">next</span>()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/&#x27;</span>,router)</span><br></pre></td></tr></table></figure>



<h5 id="é”™è¯¯çº§åˆ«çš„ä¸­é—´ä»¶"><a href="#é”™è¯¯çº§åˆ«çš„ä¸­é—´ä»¶" class="headerlink" title="é”™è¯¯çº§åˆ«çš„ä¸­é—´ä»¶"></a>é”™è¯¯çº§åˆ«çš„ä¸­é—´ä»¶</h5><blockquote>
<p>é”™è¯¯çº§åˆ«ä¸­é—´ä»¶çš„ä½œç”¨ï¼šä¸“é—¨ç”¨æ¥æ•è·æ•´ä¸ªé¡¹ç›®ä¸­å‘ç”Ÿçš„å¼‚å¸¸é”™è¯¯ï¼Œä»è€Œé˜²æ­¢é¡¹ç›®å¼‚å¸¸å´©æºƒçš„é—®é¢˜ã€‚ æ ¼å¼ï¼šé”™è¯¯çº§åˆ«ä¸­é—´ä»¶çš„ function å¤„ç†å‡½æ•°ä¸­ï¼Œå¿…é¡»æœ‰ 4 ä¸ªå½¢å‚ï¼Œå½¢å‚é¡ºåºä»å‰åˆ°åï¼Œåˆ†åˆ«æ˜¯ (err, req, res, next)ã€‚</p>
<p><strong>æ³¨æ„ï¼šé”™è¯¯çº§åˆ«çš„ä¸­é—´ä»¶ï¼Œ å¿…é¡»æ³¨å†Œåœ¨æ‰€æœ‰è·¯ç”±ä¹‹åï¼</strong></p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥ express æ¨¡å—</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="comment">// åˆ›å»º express çš„æœåŠ¡å™¨å®ä¾‹</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. å®šä¹‰è·¯ç”±</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">req, resp</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 1.1 äººä¸ºçš„åˆ¶é€ é”™è¯¯</span></span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;æœåŠ¡å™¨å†…éƒ¨å‘ç”Ÿäº†é”™è¯¯ï¼&#x27;</span>)</span><br><span class="line">    resp.<span class="title function_">send</span>(<span class="string">&#x27;Home page.&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. å®šä¹‰é”™è¯¯çº§åˆ«çš„ä¸­é—´ä»¶ï¼Œæ•è·æ•´ä¸ªé¡¹ç›®çš„å¼‚å¸¸é”™è¯¯ï¼Œä»è€Œé˜²æ­¢ç¨‹åºçš„å´©æºƒ</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">err, resp, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;å‘ç”Ÿäº†é”™è¯¯ï¼&#x27;</span> + err.<span class="property">message</span>)</span><br><span class="line">    resp.<span class="title function_">send</span>(<span class="string">&#x27;Errorï¼š&#x27;</span> + err.<span class="property">message</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// è°ƒç”¨ app.listen æ–¹æ³•ï¼ŒæŒ‡å®šç«¯å£å·å¹¶å¯åŠ¨webæœåŠ¡å™¨</span></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">8088</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;express server running at http://127.0.0.1:8088&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h5 id="Expresså†…ç½®çš„ä¸­é—´ä»¶"><a href="#Expresså†…ç½®çš„ä¸­é—´ä»¶" class="headerlink" title="Expresså†…ç½®çš„ä¸­é—´ä»¶"></a>Expresså†…ç½®çš„ä¸­é—´ä»¶</h5><blockquote>
<p>è‡ª Express 4.16.0 ç‰ˆæœ¬å¼€å§‹ï¼ŒExpress å†…ç½®äº† 3 ä¸ªå¸¸ç”¨çš„ä¸­é—´ä»¶ï¼Œæå¤§çš„æé«˜äº† Express é¡¹ç›®çš„å¼€å‘æ•ˆç‡å’Œä½“éªŒï¼š</p>
<ol>
<li>express.static å¿«é€Ÿæ‰˜ç®¡é™æ€èµ„æºçš„å†…ç½®ä¸­é—´ä»¶ï¼Œä¾‹å¦‚ï¼š HTML æ–‡ä»¶ã€å›¾ç‰‡ã€CSS æ ·å¼ç­‰ï¼ˆæ— å…¼å®¹æ€§ï¼‰</li>
<li>express.json è§£æ JSON æ ¼å¼çš„è¯·æ±‚ä½“æ•°æ®ï¼ˆæœ‰å…¼å®¹æ€§ï¼Œä»…åœ¨ 4.16.0+ ç‰ˆæœ¬ä¸­å¯ç”¨ï¼‰</li>
<li>express.urlencoded è§£æ URL-encoded æ ¼å¼çš„è¯·æ±‚ä½“æ•°æ®ï¼ˆæœ‰å…¼å®¹æ€§ï¼Œä»…åœ¨ 4.16.0+ ç‰ˆæœ¬ä¸­å¯ç”¨ï¼‰</li>
</ol>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é…ç½®è§£æ application/json æ ¼å¼æ•°æ®çš„å†…ç½®ä¸­é—´ä»¶</span></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">json</span>())</span><br><span class="line"></span><br><span class="line"><span class="comment">// é…ç½®è§£æ application/x-www-form-urlencoded æ ¼å¼æ•°æ®çš„å†…ç½®ä¸­é—´ä»¶</span></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">urlencoded</span>(&#123;</span><br><span class="line">    <span class="attr">extended</span>: <span class="literal">false</span></span><br><span class="line">&#125;))</span><br></pre></td></tr></table></figure>



<blockquote>
<p>å®Œæ•´ä»£ç </p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥ express æ¨¡å—</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="comment">// åˆ›å»º express çš„æœåŠ¡å™¨å®ä¾‹</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ³¨æ„ï¼šé™¤äº†é”™è¯¯çº§åˆ«çš„ä¸­é—´ä»¶ï¼Œå…¶ä»–çš„ä¸­é—´ä»¶ï¼Œå¿…é¡»åœ¨è·¯ç”±ä¹‹å‰è¿›è¡Œé…ç½®</span></span><br><span class="line"><span class="comment">// é€šè¿‡ express.json() è¿™ä¸ªä¸­é—´ä»¶ï¼Œè§£æè¡¨å•ä¸­çš„ JSON æ ¼å¼çš„æ•°æ®</span></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">json</span>())</span><br><span class="line"><span class="comment">// é€šè¿‡ express.urlencoded() è¿™ä¸ªä¸­é—´ä»¶ï¼Œæ¥è§£æ è¡¨å•ä¸­çš„ url-encoded æ ¼å¼çš„æ•°æ®</span></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">urlencoded</span>(&#123; <span class="attr">extended</span>: <span class="literal">false</span> &#125;))</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/user&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// åœ¨æœåŠ¡å™¨ï¼Œå¯ä»¥ä½¿ç”¨ req.body è¿™ä¸ªå±æ€§ï¼Œæ¥æ¥æ”¶å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„è¯·æ±‚ä½“æ•°æ®</span></span><br><span class="line">    <span class="comment">// é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœä¸é…ç½®è§£æè¡¨å•æ•°æ®çš„ä¸­é—´ä»¶ï¼Œåˆ™ req.body é»˜è®¤ç­‰äº undefined</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">body</span>)</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/book&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// åœ¨æœåŠ¡å™¨ç«¯ï¼Œå¯ä»¥é€šè¿‡ req,body æ¥è·å– JSON æ ¼å¼çš„è¡¨å•æ•°æ®å’Œ url-encoded æ ¼å¼çš„æ•°æ®</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">body</span>)</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// è°ƒç”¨ app.listen æ–¹æ³•ï¼ŒæŒ‡å®šç«¯å£å·å¹¶å¯åŠ¨webæœåŠ¡å™¨</span></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">8088</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;express server running at http://127.0.0.1:8088&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>





<h5 id="ç¬¬ä¸‰æ–¹çš„ä¸­é—´ä»¶"><a href="#ç¬¬ä¸‰æ–¹çš„ä¸­é—´ä»¶" class="headerlink" title="ç¬¬ä¸‰æ–¹çš„ä¸­é—´ä»¶"></a>ç¬¬ä¸‰æ–¹çš„ä¸­é—´ä»¶</h5><blockquote>
<p>é Express å®˜æ–¹å†…ç½®çš„ï¼Œè€Œæ˜¯ç”±ç¬¬ä¸‰æ–¹å¼€å‘å‡ºæ¥çš„ä¸­é—´ä»¶ï¼Œå«åšç¬¬ä¸‰æ–¹ä¸­é—´ä»¶ã€‚åœ¨é¡¹ç›®ä¸­ï¼Œå¤§å®¶å¯ä»¥æŒ‰éœ€ä¸‹è½½å¹¶é…ç½® ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶ï¼Œä»è€Œæé«˜é¡¹ç›®çš„å¼€å‘æ•ˆç‡ã€‚ ä¾‹å¦‚ï¼šåœ¨ <a href="mailto:&#x65;&#x78;&#x70;&#x72;&#101;&#115;&#x73;&#x40;&#52;&#46;&#x31;&#54;&#46;&#x30;">&#x65;&#x78;&#x70;&#x72;&#101;&#115;&#x73;&#x40;&#52;&#46;&#x31;&#54;&#46;&#x30;</a> ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ï¼Œç»å¸¸ä½¿ç”¨ body-parser è¿™ä¸ªç¬¬ä¸‰æ–¹ä¸­é—´ä»¶ï¼Œæ¥è§£æè¯·æ±‚ä½“æ•°æ®ã€‚ä½¿ç”¨æ­¥ éª¤å¦‚ä¸‹ï¼š</p>
<ol>
<li>è¿è¡Œ npm install body-parser å®‰è£…ä¸­é—´ä»¶</li>
<li>ä½¿ç”¨ require å¯¼å…¥ä¸­é—´ä»¶</li>
<li>è°ƒç”¨ app.use() æ³¨å†Œå¹¶ä½¿ç”¨ä¸­é—´ä»¶</li>
</ol>
</blockquote>
<p><code>æ³¨æ„ï¼šExpress å†…ç½®çš„ express.urlencoded ä¸­é—´ä»¶ï¼Œå°±æ˜¯åŸºäº body-parser è¿™ä¸ªç¬¬ä¸‰æ–¹ä¸­é—´ä»¶è¿›ä¸€æ­¥å°è£…å‡ºæ¥çš„ã€‚</code></p>
<h4 id="è‡ªå®šä¹‰ä¸­é—´ä»¶"><a href="#è‡ªå®šä¹‰ä¸­é—´ä»¶" class="headerlink" title="è‡ªå®šä¹‰ä¸­é—´ä»¶"></a>è‡ªå®šä¹‰ä¸­é—´ä»¶</h4><h5 id="éœ€æ±‚æè¿°ä¸å®ç°æ­¥éª¤"><a href="#éœ€æ±‚æè¿°ä¸å®ç°æ­¥éª¤" class="headerlink" title="éœ€æ±‚æè¿°ä¸å®ç°æ­¥éª¤"></a>éœ€æ±‚æè¿°ä¸å®ç°æ­¥éª¤</h5><blockquote>
<p>è‡ªå·±æ‰‹åŠ¨æ¨¡æ‹Ÿä¸€ä¸ªç±»ä¼¼äº express.urlencoded è¿™æ ·çš„ä¸­é—´ä»¶ï¼Œæ¥è§£æ POST æäº¤åˆ°æœåŠ¡å™¨çš„è¡¨å•æ•°æ®ã€‚ å®ç°æ­¥éª¤ï¼š</p>
<ol>
<li>å®šä¹‰ä¸­é—´ä»¶</li>
<li>ç›‘å¬ req çš„ data äº‹ä»¶</li>
<li>ç›‘å¬ req çš„ end äº‹ä»¶</li>
<li>ä½¿ç”¨ querystring æ¨¡å—è§£æè¯·æ±‚ä½“æ•°æ® </li>
<li>å°†è§£æå‡ºæ¥çš„æ•°æ®å¯¹è±¡æŒ‚è½½ä¸º req.body</li>
<li>å°†è‡ªå®šä¹‰ä¸­é—´ä»¶å°è£…ä¸ºæ¨¡å—</li>
</ol>
</blockquote>
<h5 id="å®šä¹‰ä¸­é—´ä»¶"><a href="#å®šä¹‰ä¸­é—´ä»¶" class="headerlink" title="å®šä¹‰ä¸­é—´ä»¶"></a>å®šä¹‰ä¸­é—´ä»¶</h5><blockquote>
<p>ä½¿ç”¨ app.use() æ¥å®šä¹‰å…¨å±€ç”Ÿæ•ˆçš„ä¸­é—´ä»¶ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// é€»è¾‘</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h5 id="ç›‘å¬-req-çš„-data-äº‹ä»¶"><a href="#ç›‘å¬-req-çš„-data-äº‹ä»¶" class="headerlink" title="ç›‘å¬ req çš„ data äº‹ä»¶"></a>ç›‘å¬ req çš„ data äº‹ä»¶</h5><blockquote>
<p>åœ¨ä¸­é—´ä»¶ä¸­ï¼Œéœ€è¦ç›‘å¬ req å¯¹è±¡çš„ data äº‹ä»¶ï¼Œæ¥è·å–å®¢æˆ·ç«¯å‘é€åˆ°æœåŠ¡å™¨çš„æ•°æ®ã€‚ </p>
<p>å¦‚æœæ•°æ®é‡æ¯”è¾ƒå¤§ï¼Œæ— æ³•ä¸€æ¬¡æ€§å‘é€å®Œæ¯•ï¼Œåˆ™å®¢æˆ·ç«¯ä¼šæŠŠæ•°æ®åˆ‡å‰²åï¼Œåˆ†æ‰¹å‘é€åˆ°æœåŠ¡å™¨ã€‚æ‰€ä»¥ data äº‹ä»¶å¯èƒ½ä¼šè§¦ å‘å¤šæ¬¡ï¼Œæ¯ä¸€æ¬¡è§¦å‘ data äº‹ä»¶æ—¶ï¼Œè·å–åˆ°æ•°æ®åªæ˜¯å®Œæ•´æ•°æ®çš„ä¸€éƒ¨åˆ†ï¼Œéœ€è¦æ‰‹åŠ¨å¯¹æ¥æ”¶åˆ°çš„æ•°æ®è¿›è¡Œæ‹¼æ¥ã€‚</p>
</blockquote>
<h5 id="querystring-è§£æè¯·æ±‚ä½“æ•°æ®"><a href="#querystring-è§£æè¯·æ±‚ä½“æ•°æ®" class="headerlink" title="querystring è§£æè¯·æ±‚ä½“æ•°æ®"></a>querystring è§£æè¯·æ±‚ä½“æ•°æ®</h5><blockquote>
<p>Node.js å†…ç½®äº†ä¸€ä¸ª querystring æ¨¡å—ï¼Œä¸“é—¨ç”¨æ¥å¤„ç†æŸ¥è¯¢å­—ç¬¦ä¸²ã€‚é€šè¿‡è¿™ä¸ªæ¨¡å—æä¾›çš„ parse() å‡½æ•°ï¼Œå¯ä»¥è½»æ¾æŠŠ æŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œè§£ææˆå¯¹è±¡çš„æ ¼å¼ã€‚</p>
</blockquote>
<h5 id="å°†è§£æå‡ºæ¥çš„æ•°æ®å¯¹è±¡æŒ‚è½½ä¸º-req-body"><a href="#å°†è§£æå‡ºæ¥çš„æ•°æ®å¯¹è±¡æŒ‚è½½ä¸º-req-body" class="headerlink" title="å°†è§£æå‡ºæ¥çš„æ•°æ®å¯¹è±¡æŒ‚è½½ä¸º req.body"></a>å°†è§£æå‡ºæ¥çš„æ•°æ®å¯¹è±¡æŒ‚è½½ä¸º req.body</h5><blockquote>
<p>ä¸Šæ¸¸çš„ä¸­é—´ä»¶å’Œä¸‹æ¸¸çš„ä¸­é—´ä»¶åŠè·¯ç”±ä¹‹é—´ï¼Œå…±äº«åŒä¸€ä»½ req å’Œ resã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å°†è§£æå‡ºæ¥çš„æ•°æ®ï¼ŒæŒ‚è½½ä¸º req  çš„è‡ªå®šä¹‰å±æ€§ï¼Œå‘½åä¸º req.bodyï¼Œä¾›ä¸‹æ¸¸ä½¿ç”¨ã€‚</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥ express æ¨¡å—</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="comment">// åˆ›å»º express çš„æœåŠ¡å™¨å®ä¾‹</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"><span class="comment">// å¯¼å…¥ Node.js å†…ç½®çš„ querystring æ¨¡å—</span></span><br><span class="line"><span class="keyword">const</span> qs = <span class="built_in">require</span>(<span class="string">&#x27;querystring&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿™æ˜¯è§£æè¡¨å•æ•°æ®çš„ä¸­é—´ä»¶</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// å®šä¹‰ä¸­é—´ä»¶å…·ä½“çš„ä¸šåŠ¡é€»è¾‘</span></span><br><span class="line">  <span class="comment">// 1. å®šä¹‰ä¸€ä¸ª str å­—ç¬¦ä¸²ï¼Œä¸“é—¨ç”¨æ¥å­˜å‚¨å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„è¯·æ±‚ä½“æ•°æ®</span></span><br><span class="line">  <span class="keyword">let</span> str = <span class="string">&#x27;&#x27;</span></span><br><span class="line">  <span class="comment">// 2. ç›‘å¬ req çš„ data äº‹ä»¶</span></span><br><span class="line">  req.<span class="title function_">on</span>(<span class="string">&#x27;data&#x27;</span>, <span class="function">(<span class="params">chunk</span>) =&gt;</span> &#123;</span><br><span class="line">    str += chunk</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="comment">// 3. ç›‘å¬ req çš„ end äº‹ä»¶</span></span><br><span class="line">  req.<span class="title function_">on</span>(<span class="string">&#x27;end&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// åœ¨ str ä¸­å­˜æ”¾çš„æ˜¯å®Œæ•´çš„è¯·æ±‚ä½“æ•°æ®</span></span><br><span class="line">    <span class="comment">// console.log(str)</span></span><br><span class="line">    <span class="comment">// <span class="doctag">TODO:</span> æŠŠå­—ç¬¦ä¸²æ ¼å¼çš„è¯·æ±‚ä½“æ•°æ®ï¼Œè§£ææˆå¯¹è±¡æ ¼å¼</span></span><br><span class="line">    <span class="keyword">const</span> body = qs.<span class="title function_">parse</span>(str)</span><br><span class="line">    req.<span class="property">body</span> = body</span><br><span class="line">    <span class="title function_">next</span>()</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/user&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(req.<span class="property">body</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// è°ƒç”¨ app.listen æ–¹æ³•ï¼ŒæŒ‡å®šç«¯å£å·å¹¶å¯åŠ¨webæœåŠ¡å™¨</span></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">8088</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;express server running at http://127.0.0.1:8088&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>





<h5 id="å°†è‡ªå®šä¹‰ä¸­é—´ä»¶å°è£…ä¸ºæ¨¡å—"><a href="#å°†è‡ªå®šä¹‰ä¸­é—´ä»¶å°è£…ä¸ºæ¨¡å—" class="headerlink" title="å°†è‡ªå®šä¹‰ä¸­é—´ä»¶å°è£…ä¸ºæ¨¡å—"></a>å°†è‡ªå®šä¹‰ä¸­é—´ä»¶å°è£…ä¸ºæ¨¡å—</h5><blockquote>
<p>ä¸ºäº†ä¼˜åŒ–ä»£ç çš„ç»“æ„ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè‡ªå®šä¹‰çš„ä¸­é—´ä»¶å‡½æ•°ï¼Œå°è£…ä¸ºç‹¬ç«‹çš„æ¨¡å—ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥ Node.js å†…ç½®çš„ querystring æ¨¡å—</span></span><br><span class="line"><span class="keyword">const</span> qs = <span class="built_in">require</span>(<span class="string">&#x27;querystring&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">bodyParser</span> = (<span class="params">req, res, next</span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// å®šä¹‰ä¸­é—´ä»¶å…·ä½“çš„ä¸šåŠ¡é€»è¾‘</span></span><br><span class="line">  <span class="comment">// 1. å®šä¹‰ä¸€ä¸ª str å­—ç¬¦ä¸²ï¼Œä¸“é—¨ç”¨æ¥å­˜å‚¨å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„è¯·æ±‚ä½“æ•°æ®</span></span><br><span class="line">  <span class="keyword">let</span> str = <span class="string">&#x27;&#x27;</span></span><br><span class="line">  <span class="comment">// 2. ç›‘å¬ req çš„ data äº‹ä»¶</span></span><br><span class="line">  req.<span class="title function_">on</span>(<span class="string">&#x27;data&#x27;</span>, <span class="function">(<span class="params">chunk</span>) =&gt;</span> &#123;</span><br><span class="line">    str += chunk</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="comment">// 3. ç›‘å¬ req çš„ end äº‹ä»¶</span></span><br><span class="line">  req.<span class="title function_">on</span>(<span class="string">&#x27;end&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// åœ¨ str ä¸­å­˜æ”¾çš„æ˜¯å®Œæ•´çš„è¯·æ±‚ä½“æ•°æ®</span></span><br><span class="line">    <span class="comment">// console.log(str)</span></span><br><span class="line">    <span class="comment">// <span class="doctag">TODO:</span> æŠŠå­—ç¬¦ä¸²æ ¼å¼çš„è¯·æ±‚ä½“æ•°æ®ï¼Œè§£ææˆå¯¹è±¡æ ¼å¼</span></span><br><span class="line">    <span class="keyword">const</span> body = qs.<span class="title function_">parse</span>(str)</span><br><span class="line">    req.<span class="property">body</span> = body</span><br><span class="line">    <span class="title function_">next</span>()</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = bodyParser</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥ express æ¨¡å—</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="comment">// åˆ›å»º express çš„æœåŠ¡å™¨å®ä¾‹</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. å¯¼å…¥è‡ªå·±å°è£…çš„ä¸­é—´ä»¶æ¨¡å—</span></span><br><span class="line"><span class="keyword">const</span> customBodyParser = <span class="built_in">require</span>(<span class="string">&#x27;./14.custom-body-parser&#x27;</span>)</span><br><span class="line"><span class="comment">// 2. å°†è‡ªå®šä¹‰çš„ä¸­é—´ä»¶å‡½æ•°ï¼Œæ³¨å†Œä¸ºå…¨å±€å¯ç”¨çš„ä¸­é—´ä»¶</span></span><br><span class="line">app.<span class="title function_">use</span>(customBodyParser)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/user&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(req.<span class="property">body</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// è°ƒç”¨ app.listen æ–¹æ³•ï¼ŒæŒ‡å®šç«¯å£å·å¹¶å¯åŠ¨webæœåŠ¡å™¨</span></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">80</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Express server running at http://127.0.0.1&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h4 id="ä½¿ç”¨-Express-å†™æ¥å£"><a href="#ä½¿ç”¨-Express-å†™æ¥å£" class="headerlink" title="ä½¿ç”¨ Express å†™æ¥å£"></a>ä½¿ç”¨ Express å†™æ¥å£</h4><h5 id="åˆ›å»ºåŸºæœ¬çš„æœåŠ¡å™¨"><a href="#åˆ›å»ºåŸºæœ¬çš„æœåŠ¡å™¨" class="headerlink" title="åˆ›å»ºåŸºæœ¬çš„æœåŠ¡å™¨"></a>åˆ›å»ºåŸºæœ¬çš„æœåŠ¡å™¨</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥ express</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºæœåŠ¡å™¨å®ä¾‹</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¼å…¥è·¯ç”±æ¨¡å—</span></span><br><span class="line"><span class="keyword">const</span> router = <span class="built_in">require</span>(<span class="string">&#x27;./14_apiRouter&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŠŠè·¯ç”±æ¨¡å—æ³¨å†Œåˆ° app ä¸Š</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/api&#x27;</span>,router)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯åŠ¨æœåŠ¡å™¨</span></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">8088</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Express server running at http://127.0.0.1:8088&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h5 id="åˆ›å»º-API-è·¯ç”±æ¨¡å—"><a href="#åˆ›å»º-API-è·¯ç”±æ¨¡å—" class="headerlink" title="åˆ›å»º API è·¯ç”±æ¨¡å—"></a>åˆ›å»º API è·¯ç”±æ¨¡å—</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨è¿™é‡ŒæŒ‚è½½å¯¹åº”çš„è·¯ç”±</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router</span><br></pre></td></tr></table></figure>



<h5 id="ç¼–å†™-GET-æ¥å£"><a href="#ç¼–å†™-GET-æ¥å£" class="headerlink" title="ç¼–å†™ GET æ¥å£"></a>ç¼–å†™ GET æ¥å£</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰ GET æ¥å£</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/get&#x27;</span>,<span class="function">(<span class="params">req,resp</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="comment">// é€šè¿‡ req.query è·å–å®¢æˆ·ç«¯é€šè¿‡æŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œå‘é€åˆ°æœåŠ¡å™¨çš„æ•°æ®</span></span><br><span class="line">    <span class="keyword">const</span> query = req.<span class="property">query</span></span><br><span class="line">    <span class="comment">// è°ƒç”¨ res.send() æ–¹æ³•ï¼Œå‘å®¢æˆ·ç«¯å“åº”å¤„ç†çš„ç»“æœ</span></span><br><span class="line">    resp.<span class="title function_">send</span>(&#123;</span><br><span class="line">        <span class="attr">status</span>: <span class="number">0</span>, <span class="comment">// 0 è¡¨ç¤ºå¤„ç†æˆåŠŸï¼Œ1 è¡¨ç¤ºå¤„ç†å¤±è´¥</span></span><br><span class="line">        <span class="attr">msg</span>: <span class="string">&#x27;GET è¯·æ±‚æˆåŠŸï¼&#x27;</span>, <span class="comment">// çŠ¶æ€çš„æè¿°</span></span><br><span class="line">        <span class="attr">data</span>: query, <span class="comment">// éœ€è¦å“åº”ç»™å®¢æˆ·ç«¯çš„æ•°æ®</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;status&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;msg&quot;</span><span class="punctuation">:</span> <span class="string">&quot;GET è¯·æ±‚æˆåŠŸï¼&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ache&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>



<h5 id="ç¼–å†™-POST-æ¥å£"><a href="#ç¼–å†™-POST-æ¥å£" class="headerlink" title="ç¼–å†™ POST æ¥å£"></a>ç¼–å†™ POST æ¥å£</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰ POST æ¥å£</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/post&#x27;</span>, <span class="function">(<span class="params">req, resp</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// é€šè¿‡ req.body è·å–è¯·æ±‚ä½“ä¸­åŒ…å«çš„ url-encoded æ ¼å¼çš„æ•°æ®</span></span><br><span class="line">    <span class="keyword">const</span> body = req.<span class="property">body</span></span><br><span class="line">    <span class="comment">// è°ƒç”¨ res.send() æ–¹æ³•ï¼Œå‘å®¢æˆ·ç«¯å“åº”ç»“æœ</span></span><br><span class="line">    resp.<span class="title function_">send</span>(&#123;</span><br><span class="line">        <span class="attr">status</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">msg</span>: <span class="string">&#x27;POST è¯·æ±‚æˆåŠŸï¼&#x27;</span>,</span><br><span class="line">        <span class="attr">data</span>: body,</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;status&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;msg&quot;</span><span class="punctuation">:</span> <span class="string">&quot;POST è¯·æ±‚æˆåŠŸï¼&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ache&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p><code>æ³¨æ„ï¼šå¦‚æœè¦è·å– URL-encoded æ ¼å¼çš„è¯·æ±‚ä½“æ•°æ®ï¼Œå¿…é¡»é…ç½®ä¸­é—´ä»¶ app.use(express.urlencoded(&#123; extended: false &#125;))</code></p>
<h5 id="CORS-è·¨åŸŸèµ„æºå…±äº«"><a href="#CORS-è·¨åŸŸèµ„æºå…±äº«" class="headerlink" title="CORS è·¨åŸŸèµ„æºå…±äº«"></a>CORS è·¨åŸŸèµ„æºå…±äº«</h5><h6 id="æ¥å£çš„è·¨åŸŸé—®é¢˜"><a href="#æ¥å£çš„è·¨åŸŸé—®é¢˜" class="headerlink" title="æ¥å£çš„è·¨åŸŸé—®é¢˜"></a>æ¥å£çš„è·¨åŸŸé—®é¢˜</h6><blockquote>
<p>åˆšæ‰ç¼–å†™çš„ GET å’Œ POSTæ¥å£ï¼Œå­˜åœ¨ä¸€ä¸ªå¾ˆä¸¥é‡çš„é—®é¢˜ï¼šä¸æ”¯æŒè·¨åŸŸè¯·æ±‚ã€‚ </p>
<p>è§£å†³æ¥å£è·¨åŸŸé—®é¢˜çš„æ–¹æ¡ˆä¸»è¦æœ‰ä¸¤ç§ï¼š</p>
<ol>
<li>CORSï¼ˆä¸»æµçš„è§£å†³æ–¹æ¡ˆï¼Œæ¨èä½¿ç”¨ï¼‰</li>
<li>JSONPï¼ˆæœ‰ç¼ºé™·çš„è§£å†³æ–¹æ¡ˆï¼šåªæ”¯æŒ GET è¯·æ±‚ï¼‰</li>
</ol>
</blockquote>
<h6 id="ä½¿ç”¨-cors-ä¸­é—´ä»¶è§£å†³è·¨åŸŸé—®é¢˜"><a href="#ä½¿ç”¨-cors-ä¸­é—´ä»¶è§£å†³è·¨åŸŸé—®é¢˜" class="headerlink" title="ä½¿ç”¨ cors ä¸­é—´ä»¶è§£å†³è·¨åŸŸé—®é¢˜"></a>ä½¿ç”¨ cors ä¸­é—´ä»¶è§£å†³è·¨åŸŸé—®é¢˜</h6><blockquote>
<p>cors æ˜¯ Express çš„ä¸€ä¸ªç¬¬ä¸‰æ–¹ä¸­é—´ä»¶ã€‚é€šè¿‡å®‰è£…å’Œé…ç½® cors ä¸­é—´ä»¶ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿åœ°è§£å†³è·¨åŸŸé—®é¢˜ã€‚</p>
<p> ä½¿ç”¨æ­¥éª¤åˆ†ä¸ºå¦‚ä¸‹ 3 æ­¥ï¼š </p>
<ol>
<li>è¿è¡Œ npm install cors å®‰è£…ä¸­é—´ä»¶</li>
<li>ä½¿ç”¨ const cors &#x3D; require(â€˜corsâ€™) å¯¼å…¥ä¸­é—´ä»¶</li>
<li>åœ¨è·¯ç”±ä¹‹å‰è°ƒç”¨ app.use(cors()) é…ç½®ä¸­é—´ä»¶</li>
</ol>
</blockquote>
<h6 id="ä»€ä¹ˆæ˜¯-CORS"><a href="#ä»€ä¹ˆæ˜¯-CORS" class="headerlink" title="ä»€ä¹ˆæ˜¯ CORS"></a>ä»€ä¹ˆæ˜¯ CORS</h6><blockquote>
<p>CORS ï¼ˆCross-Origin Resource Sharingï¼Œè·¨åŸŸèµ„æºå…±äº«ï¼‰ç”±ä¸€ç³»åˆ— HTTP å“åº”å¤´ç»„æˆï¼Œè¿™äº› HTTP å“åº”å¤´å†³å®š æµè§ˆå™¨æ˜¯å¦é˜»æ­¢å‰ç«¯ JS ä»£ç è·¨åŸŸè·å–èµ„æºã€‚ æµè§ˆå™¨çš„åŒæºå®‰å…¨ç­–ç•¥é»˜è®¤ä¼šé˜»æ­¢ç½‘é¡µâ€œè·¨åŸŸâ€è·å–èµ„æºã€‚ä½†å¦‚æœæ¥å£æœåŠ¡å™¨é…ç½®äº† CORS ç›¸å…³çš„ HTTP å“åº”å¤´ï¼Œ å°±å¯ä»¥è§£é™¤æµè§ˆå™¨ç«¯çš„è·¨åŸŸè®¿é—®é™åˆ¶ã€‚</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pph647n"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/./NodeJs.assets/pph647n.png" alt="pph647n.png"></a></p>
<h6 id="CORS-çš„æ³¨æ„äº‹é¡¹"><a href="#CORS-çš„æ³¨æ„äº‹é¡¹" class="headerlink" title="CORS çš„æ³¨æ„äº‹é¡¹"></a>CORS çš„æ³¨æ„äº‹é¡¹</h6><blockquote>
<ol>
<li>CORS ä¸»è¦åœ¨æœåŠ¡å™¨ç«¯è¿›è¡Œé…ç½®ã€‚å®¢æˆ·ç«¯æµè§ˆå™¨æ— é¡»åšä»»ä½•é¢å¤–çš„é…ç½®ï¼Œå³å¯è¯·æ±‚å¼€å¯äº† CORS çš„æ¥å£ã€‚</li>
<li>CORS åœ¨æµè§ˆå™¨ä¸­æœ‰å…¼å®¹æ€§ã€‚åªæœ‰æ”¯æŒ XMLHttpRequest Level2 çš„æµè§ˆå™¨ï¼Œæ‰èƒ½æ­£å¸¸è®¿é—®å¼€å¯äº† CORS çš„æœ åŠ¡ç«¯æ¥å£ï¼ˆä¾‹å¦‚ï¼šIE10+ã€Chrome4+ã€FireFox3.5+ï¼‰ã€‚</li>
</ol>
</blockquote>
<h6 id="CORS-å“åº”å¤´éƒ¨-Access-Control-Allow-Origin"><a href="#CORS-å“åº”å¤´éƒ¨-Access-Control-Allow-Origin" class="headerlink" title="CORS å“åº”å¤´éƒ¨ - Access-Control-Allow-Origin"></a>CORS å“åº”å¤´éƒ¨ - Access-Control-Allow-Origin</h6><blockquote>
<p>å“åº”å¤´éƒ¨ä¸­å¯ä»¥æºå¸¦ä¸€ä¸ª Access-Control-Allow-Origin å­—æ®µï¼Œå…¶è¯­æ³•å¦‚ä¸‹:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Access</span>-<span class="title class_">Control</span>-<span class="title class_">Allow</span>-<span class="title class_">Origin</span>:&lt;origin&gt; | *</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­ï¼Œorigin å‚æ•°çš„å€¼æŒ‡å®šäº†å…è®¸è®¿é—®è¯¥èµ„æºçš„å¤–åŸŸ URLã€‚ ä¾‹å¦‚ï¼Œä¸‹é¢çš„å­—æ®µå€¼å°†åªå…è®¸æ¥è‡ª <a href="https://ache-lie.github.io/blog">https://ache-lie.github.io/blog</a> çš„è¯·æ±‚ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">res.<span class="title function_">setHeader</span>(<span class="string">&#x27;Access-Control-Allow-Origin&#x27;</span>,<span class="string">&#x27;https://ache-lie.github.io/blog/&#x27;</span>)</span><br></pre></td></tr></table></figure>
</blockquote>
<h6 id="CORS-å“åº”å¤´éƒ¨-Access-Control-Allow-Origin-1"><a href="#CORS-å“åº”å¤´éƒ¨-Access-Control-Allow-Origin-1" class="headerlink" title="CORS å“åº”å¤´éƒ¨ - Access-Control-Allow-Origin"></a>CORS å“åº”å¤´éƒ¨ - Access-Control-Allow-Origin</h6><blockquote>
<p>å¦‚æœæŒ‡å®šäº† Access-Control-Allow-Origin å­—æ®µçš„å€¼ä¸ºé€šé…ç¬¦ *ï¼Œè¡¨ç¤ºå…è®¸æ¥è‡ªä»»ä½•åŸŸçš„è¯·æ±‚ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">res.<span class="title function_">setHeader</span>(<span class="string">&#x27;Access-Control-Allow-Origin&#x27;</span>,<span class="string">&#x27;*&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h6 id="CORS-å“åº”å¤´éƒ¨-Access-Control-Allow-Headers"><a href="#CORS-å“åº”å¤´éƒ¨-Access-Control-Allow-Headers" class="headerlink" title="CORS å“åº”å¤´éƒ¨ - Access-Control-Allow-Headers"></a>CORS å“åº”å¤´éƒ¨ - Access-Control-Allow-Headers</h6><blockquote>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒCORS ä»…æ”¯æŒå®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€å¦‚ä¸‹çš„ 9 ä¸ªè¯·æ±‚å¤´ï¼š </p>
<ol>
<li>Accept</li>
<li>Accept-Languageã€</li>
<li>Content-Languageã€</li>
<li>DPRã€</li>
<li>Downlinkã€</li>
<li>Save-Dataã€</li>
<li>Viewport-Widthã€</li>
<li>Width ã€ </li>
<li>Content-Type ï¼ˆå€¼ä»…é™äº text&#x2F;plainã€multipart&#x2F;form-dataã€application&#x2F;x-www-form-urlencoded ä¸‰è€…ä¹‹ä¸€ï¼‰</li>
</ol>
<p>å¦‚æœå®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€äº†é¢å¤–çš„è¯·æ±‚å¤´ä¿¡æ¯ï¼Œåˆ™éœ€è¦åœ¨æœåŠ¡å™¨ç«¯ï¼Œé€šè¿‡ Access-Control-Allow-Headers å¯¹é¢å¤– çš„è¯·æ±‚å¤´è¿›è¡Œå£°æ˜ï¼Œå¦åˆ™è¿™æ¬¡è¯·æ±‚ä¼šå¤±è´¥ï¼</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å…è®¸å®¢æˆ·ç«¯é¢å¤–å‘æœåŠ¡å™¨å‘é€ Content-Type è¯·æ±‚å¤´å’Œ X-Custom-Header è¯·æ±‚å¤´</span></span><br><span class="line"><span class="comment">// æ³¨æ„ï¼šå¤šä¸ªè¯·æ±‚å¤´ä¹‹é—´ä½¿ç”¨è‹±æ–‡çš„é€—å·è¿›è¡Œåˆ†å‰²</span></span><br><span class="line">res.<span class="title function_">setHeader</span>(<span class="string">&#x27;Access-Control-Allow-Header&#x27;</span>,<span class="string">&#x27;Content-Type,X-Custom-Header&#x27;</span>)</span><br></pre></td></tr></table></figure>





<h6 id="CORS-å“åº”å¤´éƒ¨-Access-Control-Allow-Methods"><a href="#CORS-å“åº”å¤´éƒ¨-Access-Control-Allow-Methods" class="headerlink" title="CORS å“åº”å¤´éƒ¨ - Access-Control-Allow-Methods"></a>CORS å“åº”å¤´éƒ¨ - Access-Control-Allow-Methods</h6><blockquote>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒCORS ä»…æ”¯æŒå®¢æˆ·ç«¯å‘èµ· <strong>GET</strong>ã€<strong>POST</strong>ã€<strong>HEAD</strong> è¯·æ±‚ã€‚ </p>
<p>å¦‚æœå®¢æˆ·ç«¯å¸Œæœ›é€šè¿‡ PUTã€DELETE ç­‰æ–¹å¼è¯·æ±‚æœåŠ¡å™¨çš„èµ„æºï¼Œåˆ™éœ€è¦åœ¨æœåŠ¡å™¨ç«¯ï¼Œé€šè¿‡ Access-Control-Alow-Methods æ¥æŒ‡æ˜å®é™…è¯·æ±‚æ‰€å…è®¸ä½¿ç”¨çš„ HTTP æ–¹æ³•ã€‚</p>
<p> ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åªå…è®¸ POST,GET,DELETE,HEAD è¯·æ±‚æ–¹æ³•</span></span><br><span class="line">res.<span class="title function_">setHeader</span>(<span class="string">&#x27;Access-Control-Allow-Methods&#x27;</span>,<span class="string">&#x27;POST,GET,DELETE,HEAD&#x27;</span>)</span><br><span class="line"><span class="comment">// å…è®¸æ‰€æœ‰çš„ HTTP è¯·æ±‚æ–¹æ³•</span></span><br><span class="line">res.<span class="title function_">setHeader</span>(<span class="string">&#x27;Access-Control-Allow-Methods&#x27;</span>,<span class="string">&#x27;*&#x27;</span>)</span><br></pre></td></tr></table></figure>





<h6 id="CORSè¯·æ±‚çš„åˆ†ç±»"><a href="#CORSè¯·æ±‚çš„åˆ†ç±»" class="headerlink" title="CORSè¯·æ±‚çš„åˆ†ç±»"></a>CORSè¯·æ±‚çš„åˆ†ç±»</h6><blockquote>
<p>å®¢æˆ·ç«¯åœ¨è¯·æ±‚ CORS æ¥å£æ—¶ï¼Œæ ¹æ®è¯·æ±‚æ–¹å¼å’Œè¯·æ±‚å¤´çš„ä¸åŒï¼Œå¯ä»¥å°† CORS çš„è¯·æ±‚åˆ†ä¸ºä¸¤å¤§ç±»ï¼Œåˆ†åˆ«æ˜¯ï¼š</p>
<ol>
<li>ç®€å•è¯·æ±‚</li>
<li>é¢„æ£€è¯·æ±‚</li>
</ol>
</blockquote>
<h6 id="ç®€å•è¯·æ±‚"><a href="#ç®€å•è¯·æ±‚" class="headerlink" title="ç®€å•è¯·æ±‚"></a>ç®€å•è¯·æ±‚</h6><blockquote>
<p>åŒæ—¶æ»¡è¶³ä»¥ä¸‹ä¸¤å¤§æ¡ä»¶çš„è¯·æ±‚ï¼Œå°±å±äºç®€å•è¯·æ±‚ï¼š </p>
<ol>
<li>è¯·æ±‚æ–¹å¼ï¼šGETã€POSTã€HEAD ä¸‰è€…ä¹‹ä¸€ </li>
<li>HTTP å¤´éƒ¨ä¿¡æ¯ä¸è¶…è¿‡ä»¥ä¸‹å‡ ç§å­—æ®µï¼šæ— è‡ªå®šä¹‰å¤´éƒ¨å­—æ®µã€Acceptã€Accept-Languageã€Content-Languageã€DPRã€ Downlinkã€Save-Dataã€Viewport-Widthã€Width ã€Content-Typeï¼ˆåªæœ‰ä¸‰ä¸ªå€¼application&#x2F;x-www-formurlencodedã€multipart&#x2F;form-dataã€text&#x2F;plainï¼‰</li>
</ol>
</blockquote>
<h6 id="é¢„æ£€è¯·æ±‚"><a href="#é¢„æ£€è¯·æ±‚" class="headerlink" title="é¢„æ£€è¯·æ±‚"></a>é¢„æ£€è¯·æ±‚</h6><blockquote>
<p>åªè¦ç¬¦åˆä»¥ä¸‹ä»»ä½•ä¸€ä¸ªæ¡ä»¶çš„è¯·æ±‚ï¼Œéƒ½éœ€è¦è¿›è¡Œé¢„æ£€è¯·æ±‚ï¼š</p>
<ol>
<li>è¯·æ±‚æ–¹å¼ä¸º GETã€POSTã€HEAD ä¹‹å¤–çš„è¯·æ±‚ Method ç±»å‹</li>
<li>è¯·æ±‚å¤´ä¸­åŒ…å«è‡ªå®šä¹‰å¤´éƒ¨å­—æ®µ</li>
<li>å‘æœåŠ¡å™¨å‘é€äº† application&#x2F;json æ ¼å¼çš„æ•°æ®</li>
</ol>
<p>åœ¨æµè§ˆå™¨ä¸æœåŠ¡å™¨æ­£å¼é€šä¿¡ä¹‹å‰ï¼Œæµè§ˆå™¨ä¼šå…ˆå‘é€ OPTION è¯·æ±‚è¿›è¡Œé¢„æ£€ï¼Œä»¥è·çŸ¥æœåŠ¡å™¨æ˜¯å¦å…è®¸è¯¥å®é™…è¯·æ±‚ï¼Œæ‰€ä»¥è¿™ä¸€ æ¬¡çš„ OPTION è¯·æ±‚ç§°ä¸ºâ€œé¢„æ£€è¯·æ±‚â€ã€‚æœåŠ¡å™¨æˆåŠŸå“åº”é¢„æ£€è¯·æ±‚åï¼Œæ‰ä¼šå‘é€çœŸæ­£çš„è¯·æ±‚ï¼Œå¹¶ä¸”æºå¸¦çœŸå®æ•°æ®ã€‚</p>
</blockquote>
<h6 id="ç®€å•è¯·æ±‚å’Œé¢„æ£€è¯·æ±‚çš„åŒºåˆ«"><a href="#ç®€å•è¯·æ±‚å’Œé¢„æ£€è¯·æ±‚çš„åŒºåˆ«" class="headerlink" title="ç®€å•è¯·æ±‚å’Œé¢„æ£€è¯·æ±‚çš„åŒºåˆ«"></a>ç®€å•è¯·æ±‚å’Œé¢„æ£€è¯·æ±‚çš„åŒºåˆ«</h6><blockquote>
<p>ç®€å•è¯·æ±‚çš„ç‰¹ç‚¹ï¼šå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´åªä¼šå‘ç”Ÿä¸€æ¬¡è¯·æ±‚ã€‚ </p>
<p>é¢„æ£€è¯·æ±‚çš„ç‰¹ç‚¹ï¼šå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´ä¼šå‘ç”Ÿä¸¤æ¬¡è¯·æ±‚ï¼ŒOPTION é¢„æ£€è¯·æ±‚æˆåŠŸä¹‹åï¼Œæ‰ä¼šå‘èµ·çœŸæ­£çš„è¯·æ±‚ã€‚</p>
</blockquote>
<h5 id="JSONP-æ¥å£"><a href="#JSONP-æ¥å£" class="headerlink" title="JSONP æ¥å£"></a>JSONP æ¥å£</h5><h6 id="å›é¡¾-JSONP-çš„æ¦‚å¿µä¸ç‰¹ç‚¹"><a href="#å›é¡¾-JSONP-çš„æ¦‚å¿µä¸ç‰¹ç‚¹" class="headerlink" title="å›é¡¾ JSONP çš„æ¦‚å¿µä¸ç‰¹ç‚¹"></a>å›é¡¾ JSONP çš„æ¦‚å¿µä¸ç‰¹ç‚¹</h6><blockquote>
<p>æ¦‚å¿µï¼šæµè§ˆå™¨ç«¯é€šè¿‡ <script> æ ‡ç­¾çš„ src å±æ€§ï¼Œè¯·æ±‚æœåŠ¡å™¨ä¸Šçš„æ•°æ®ï¼ŒåŒæ—¶ï¼ŒæœåŠ¡å™¨è¿”å›ä¸€ä¸ªå‡½æ•°çš„è°ƒç”¨ã€‚è¿™ç§è¯·æ±‚æ•°æ®<br>çš„æ–¹å¼å«åš JSONPã€‚<br>ç‰¹ç‚¹ï¼š</p>
<ol>
<li>JSONP ä¸å±äºçœŸæ­£çš„ Ajax è¯·æ±‚ï¼Œå› ä¸ºå®ƒæ²¡æœ‰ä½¿ç”¨ XMLHttpRequest è¿™ä¸ªå¯¹è±¡ã€‚</li>
<li>JSONP ä»…æ”¯æŒ GET è¯·æ±‚ï¼Œä¸æ”¯æŒ POSTã€PUTã€DELETE ç­‰è¯·æ±‚ã€‚</li>
</ol>
</blockquote>
<h6 id="åˆ›å»º-JSONP-æ¥å£çš„æ³¨æ„äº‹é¡¹"><a href="#åˆ›å»º-JSONP-æ¥å£çš„æ³¨æ„äº‹é¡¹" class="headerlink" title="åˆ›å»º JSONP æ¥å£çš„æ³¨æ„äº‹é¡¹"></a>åˆ›å»º JSONP æ¥å£çš„æ³¨æ„äº‹é¡¹</h6><blockquote>
<p>å¦‚æœé¡¹ç›®ä¸­å·²ç»é…ç½®äº† CORS è·¨åŸŸèµ„æºå…±äº«ï¼Œä¸ºäº†é˜²æ­¢å†²çªï¼Œå¿…é¡»åœ¨é…ç½® CORS ä¸­é—´ä»¶ä¹‹å‰å£°æ˜ JSONP çš„æ¥å£ã€‚å¦åˆ™ JSONP æ¥å£ä¼šè¢«å¤„ç†æˆå¼€å¯äº† CORS çš„æ¥å£ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¼˜å…ˆåˆ›å»º JSONP æ¥å£ã€è¿™ä¸ªæ¥å£ä¸ä¼šè¢«å¤„ç†æˆ CORSæ¥å£ã€‘</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/api/jsonp&#x27;</span>,<span class="function">(<span class="params">req,resp</span>)=&gt;</span>&#123; &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å†é…ç½® CORS ä¸­é—´ä»¶ã€åç»­çš„æ‰€æœ‰æ¥å£ï¼Œéƒ½ä¼šè¢«å¤„ç†æˆ COPS æ¥å£ã€‘</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">cors</span>())</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿™æ˜¯ä¸€ä¸ªå¼€å¯äº† CORS çš„æ¥å£</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/api/jsonp&#x27;</span>,<span class="function">(<span class="params">req,resp</span>)=&gt;</span>&#123; &#125;)</span><br></pre></td></tr></table></figure>



<h6 id="å®ç°-JSONP-æ¥å£çš„æ­¥éª¤"><a href="#å®ç°-JSONP-æ¥å£çš„æ­¥éª¤" class="headerlink" title="å®ç° JSONP æ¥å£çš„æ­¥éª¤"></a>å®ç° JSONP æ¥å£çš„æ­¥éª¤</h6><blockquote>
<ol>
<li>è·å–å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„å›è°ƒå‡½æ•°çš„åå­— </li>
<li>å¾—åˆ°è¦é€šè¿‡ JSONP å½¢å¼å‘é€ç»™å®¢æˆ·ç«¯çš„æ•°æ® </li>
<li>æ ¹æ®å‰ä¸¤æ­¥å¾—åˆ°çš„æ•°æ®ï¼Œæ‹¼æ¥å‡ºä¸€ä¸ªå‡½æ•°è°ƒç”¨çš„å­—ç¬¦ä¸²</li>
<li>æŠŠä¸Šä¸€æ­¥æ‹¼æ¥å¾—åˆ°çš„å­—ç¬¦ä¸²ï¼Œå“åº”ç»™å®¢æˆ·ç«¯çš„</li>
</ol>
</blockquote>
<h6 id="å®ç°-JSONP-æ¥å£çš„å…·ä½“ä»£ç "><a href="#å®ç°-JSONP-æ¥å£çš„å…·ä½“ä»£ç " class="headerlink" title="å®ç° JSONP æ¥å£çš„å…·ä½“ä»£ç "></a>å®ç° JSONP æ¥å£çš„å…·ä½“ä»£ç </h6><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¿…é¡»åœ¨é…ç½® cors ä¸­é—´ä»¶ä¹‹å‰ï¼Œé…ç½® JSONP çš„æ¥å£</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/api/jsonp&#x27;</span>, <span class="function">(<span class="params">req, resp</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// <span class="doctag">TODO:</span> å®šä¹‰ JSONP æ¥å£å…·ä½“çš„å®ç°è¿‡ç¨‹</span></span><br><span class="line">    <span class="comment">// 1. å¾—åˆ°å‡½æ•°çš„åç§°</span></span><br><span class="line">    <span class="keyword">const</span> funcName = req.<span class="property">query</span>.<span class="property">callback</span></span><br><span class="line">    <span class="comment">// 2. å®šä¹‰è¦å‘é€åˆ°å®¢æˆ·ç«¯çš„æ•°æ®å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">const</span> data = &#123; <span class="attr">name</span>: <span class="string">&#x27;æŸšç¨šä¸ç€æ€¥&#x27;</span>, <span class="attr">age</span>: <span class="number">22</span> &#125;</span><br><span class="line">    <span class="comment">// 3. æ‹¼æ¥å‡ºä¸€ä¸ªå‡½æ•°çš„è°ƒç”¨</span></span><br><span class="line">    <span class="keyword">const</span> scriptStr = <span class="string">`<span class="subst">$&#123;funcName&#125;</span>(<span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(data)&#125;</span>)`</span></span><br><span class="line">    <span class="comment">// 4. æŠŠæ‹¼æ¥çš„å­—ç¬¦ä¸²ï¼Œå“åº”ç»™å®¢æˆ·ç«¯</span></span><br><span class="line">    resp.<span class="title function_">send</span>(scriptStr)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<p>14_apiRouter.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨è¿™é‡ŒæŒ‚è½½å¯¹åº”çš„è·¯ç”±</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ GET æ¥å£</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/get&#x27;</span>,<span class="function">(<span class="params">req,resp</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="comment">// é€šè¿‡ req.query è·å–å®¢æˆ·ç«¯é€šè¿‡æŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œå‘é€åˆ°æœåŠ¡å™¨çš„æ•°æ®</span></span><br><span class="line">    <span class="keyword">const</span> query = req.<span class="property">query</span></span><br><span class="line">    <span class="comment">// è°ƒç”¨ res.send() æ–¹æ³•ï¼Œå‘å®¢æˆ·ç«¯å“åº”å¤„ç†çš„ç»“æœ</span></span><br><span class="line">    resp.<span class="title function_">send</span>(&#123;</span><br><span class="line">        <span class="attr">status</span>: <span class="number">0</span>, <span class="comment">// 0 è¡¨ç¤ºå¤„ç†æˆåŠŸï¼Œ1 è¡¨ç¤ºå¤„ç†å¤±è´¥</span></span><br><span class="line">        <span class="attr">msg</span>: <span class="string">&#x27;GET è¯·æ±‚æˆåŠŸï¼&#x27;</span>, <span class="comment">// çŠ¶æ€çš„æè¿°</span></span><br><span class="line">        <span class="attr">data</span>: query, <span class="comment">// éœ€è¦å“åº”ç»™å®¢æˆ·ç«¯çš„æ•°æ®</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ POST æ¥å£</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/post&#x27;</span>, <span class="function">(<span class="params">req, resp</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// é€šè¿‡ req.body è·å–è¯·æ±‚ä½“ä¸­åŒ…å«çš„ url-encoded æ ¼å¼çš„æ•°æ®</span></span><br><span class="line">    <span class="keyword">const</span> body = req.<span class="property">body</span></span><br><span class="line">    <span class="comment">// è°ƒç”¨ res.send() æ–¹æ³•ï¼Œå‘å®¢æˆ·ç«¯å“åº”ç»“æœ</span></span><br><span class="line">    resp.<span class="title function_">send</span>(&#123;</span><br><span class="line">        <span class="attr">status</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">msg</span>: <span class="string">&#x27;POST è¯·æ±‚æˆåŠŸï¼&#x27;</span>,</span><br><span class="line">        <span class="attr">data</span>: body,</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ DELETE æ¥å£</span></span><br><span class="line">router.<span class="title function_">delete</span>(<span class="string">&#x27;/delete&#x27;</span>, <span class="function">(<span class="params">req, resp</span>) =&gt;</span> &#123;</span><br><span class="line">    resp.<span class="title function_">send</span>(&#123;</span><br><span class="line">        <span class="attr">status</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">msg</span>: <span class="string">&#x27;DELETEè¯·æ±‚æˆåŠŸ&#x27;</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router</span><br></pre></td></tr></table></figure>



<p>15_ä½¿ç”¨expressç¼–å†™æ¥å£.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥ express</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºæœåŠ¡å™¨å®ä¾‹</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// é…ç½®è§£æè¡¨å•æ•°æ®çš„ä¸­é—´ä»¶</span></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">urlencoded</span>(&#123; <span class="attr">extended</span>: <span class="literal">false</span> &#125;))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¿…é¡»åœ¨é…ç½® cors ä¸­é—´ä»¶ä¹‹å‰ï¼Œé…ç½® JSONP çš„æ¥å£</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/api/jsonp&#x27;</span>, <span class="function">(<span class="params">req, resp</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// <span class="doctag">TODO:</span> å®šä¹‰ JSONP æ¥å£å…·ä½“çš„å®ç°è¿‡ç¨‹</span></span><br><span class="line">    <span class="comment">// 1. å¾—åˆ°å‡½æ•°çš„åç§°</span></span><br><span class="line">    <span class="keyword">const</span> funcName = req.<span class="property">query</span>.<span class="property">callback</span></span><br><span class="line">    <span class="comment">// 2. å®šä¹‰è¦å‘é€åˆ°å®¢æˆ·ç«¯çš„æ•°æ®å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">const</span> data = &#123; <span class="attr">name</span>: <span class="string">&#x27;æŸšç¨šä¸ç€æ€¥&#x27;</span>, <span class="attr">age</span>: <span class="number">22</span> &#125;</span><br><span class="line">    <span class="comment">// 3. æ‹¼æ¥å‡ºä¸€ä¸ªå‡½æ•°çš„è°ƒç”¨</span></span><br><span class="line">    <span class="keyword">const</span> scriptStr = <span class="string">`<span class="subst">$&#123;funcName&#125;</span>(<span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(data)&#125;</span>)`</span></span><br><span class="line">    <span class="comment">// 4. æŠŠæ‹¼æ¥çš„å­—ç¬¦ä¸²ï¼Œå“åº”ç»™å®¢æˆ·ç«¯</span></span><br><span class="line">    resp.<span class="title function_">send</span>(scriptStr)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸€å®šè¦åœ¨è·¯ç”±ä¹‹å‰ï¼Œé…ç½® cors è¿™ä¸ªä¸­é—´ä»¶ï¼Œä»è€Œè§£å†³æ¥å£è·¨åŸŸçš„é—®é¢˜</span></span><br><span class="line"><span class="keyword">const</span> cors = <span class="built_in">require</span>(<span class="string">&#x27;cors&#x27;</span>)</span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">cors</span>())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¼å…¥è·¯ç”±æ¨¡å—</span></span><br><span class="line"><span class="keyword">const</span> router = <span class="built_in">require</span>(<span class="string">&#x27;./14_apiRouter&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŠŠè·¯ç”±æ¨¡å—æ³¨å†Œåˆ° app ä¸Š</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/api&#x27;</span>,router)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯åŠ¨æœåŠ¡å™¨</span></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">8088</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Express server running at http://127.0.0.1:8088&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<p>16_æµ‹è¯•æ¥å£è·¨åŸŸé—®é¢˜.html</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">&lt;!<span class="variable constant_">DOCTYPE</span> html&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;btnGET&quot;</span>&gt;</span>GET<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;btnPOST&quot;</span>&gt;</span>POST<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;btnDelete&quot;</span>&gt;</span>DELETE<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;btnJSONP&quot;</span>&gt;</span>JSONP<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    $(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">// 1. æµ‹è¯•GETæ¥å£</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        $(<span class="string">&#x27;#btnGET&#x27;</span>).<span class="title function_">on</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            $.<span class="title function_">ajax</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="attr">type</span>: <span class="string">&#x27;GET&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="attr">url</span>: <span class="string">&#x27;http://127.0.0.1:8088/api/get&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="attr">data</span>: &#123; <span class="attr">name</span>: <span class="string">&#x27;ache&#x27;</span>, <span class="attr">age</span>: <span class="number">19</span> &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">res</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            &#125;)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">// 2. æµ‹è¯•POSTæ¥å£</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        $(<span class="string">&#x27;#btnPOST&#x27;</span>).<span class="title function_">on</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            $.<span class="title function_">ajax</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="attr">type</span>: <span class="string">&#x27;POST&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="attr">url</span>: <span class="string">&#x27;http://127.0.0.1:8088/api/post&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="attr">data</span>: &#123; <span class="attr">bookname</span>: <span class="string">&#x27;æ°´æµ’ä¼ &#x27;</span>, <span class="attr">author</span>: <span class="string">&#x27;æ–½è€åºµ&#x27;</span> &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">res</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            &#125;)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">// 3. ä¸ºåˆ é™¤æŒ‰é’®ç»‘å®šç‚¹å‡»äº‹ä»¶å¤„ç†å‡½æ•°</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        $(<span class="string">&#x27;#btnDelete&#x27;</span>).<span class="title function_">on</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            $.<span class="title function_">ajax</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="attr">type</span>: <span class="string">&#x27;DELETE&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="attr">url</span>: <span class="string">&#x27;http://127.0.0.1:8088/api/delete&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">res</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            &#125;)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">// 4. ä¸º JSONP æŒ‰é’®ç»‘å®šç‚¹å‡»äº‹ä»¶å¤„ç†å‡½æ•°</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        $(<span class="string">&#x27;#btnJSONP&#x27;</span>).<span class="title function_">on</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            $.<span class="title function_">ajax</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="attr">type</span>: <span class="string">&#x27;GET&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="attr">url</span>: <span class="string">&#x27;http://127.0.0.1:8088/api/jsonp&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="attr">dataType</span>: <span class="string">&#x27;jsonp&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">res</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            &#125;)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure>





<h6 id="åœ¨ç½‘é¡µä¸­ä½¿ç”¨-jQuery-å‘èµ·-JSONP-è¯·æ±‚"><a href="#åœ¨ç½‘é¡µä¸­ä½¿ç”¨-jQuery-å‘èµ·-JSONP-è¯·æ±‚" class="headerlink" title="åœ¨ç½‘é¡µä¸­ä½¿ç”¨ jQuery å‘èµ· JSONP è¯·æ±‚"></a>åœ¨ç½‘é¡µä¸­ä½¿ç”¨ jQuery å‘èµ· JSONP è¯·æ±‚</h6><blockquote>
<p>è°ƒç”¨ $.ajax() å‡½æ•°ï¼Œæä¾› JSONP çš„é…ç½®é€‰é¡¹ï¼Œä»è€Œå‘èµ· JSONP è¯·æ±‚ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹:</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 4. ä¸º JSONP æŒ‰é’®ç»‘å®šç‚¹å‡»äº‹ä»¶å¤„ç†å‡½æ•°</span></span><br><span class="line">        $(<span class="string">&#x27;#btnJSONP&#x27;</span>).<span class="title function_">on</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            $.<span class="title function_">ajax</span>(&#123;</span><br><span class="line">                <span class="attr">type</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">                <span class="attr">url</span>: <span class="string">&#x27;http://127.0.0.1:8088/api/jsonp&#x27;</span>,</span><br><span class="line">                <span class="attr">dataType</span>: <span class="string">&#x27;jsonp&#x27;</span>,</span><br><span class="line">                <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">res</span>) &#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span><br><span class="line">                &#125;,</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;)</span><br></pre></td></tr></table></figure>





<h3 id="æ•°æ®åº“çš„åŸºæœ¬æ¦‚å¿µ"><a href="#æ•°æ®åº“çš„åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="æ•°æ®åº“çš„åŸºæœ¬æ¦‚å¿µ"></a>æ•°æ®åº“çš„åŸºæœ¬æ¦‚å¿µ</h3><h4 id="ä»€ä¹ˆæ˜¯æ•°æ®åº“"><a href="#ä»€ä¹ˆæ˜¯æ•°æ®åº“" class="headerlink" title="ä»€ä¹ˆæ˜¯æ•°æ®åº“"></a>ä»€ä¹ˆæ˜¯æ•°æ®åº“</h4><blockquote>
<p>æ•°æ®åº“ï¼ˆdatabaseï¼‰æ˜¯ç”¨æ¥ç»„ç»‡ã€å­˜å‚¨å’Œç®¡ç†æ•°æ®çš„ä»“åº“ã€‚ </p>
<p>å½“ä»Šä¸–ç•Œæ˜¯ä¸€ä¸ªå……æ»¡ç€æ•°æ®çš„äº’è”ç½‘ä¸–ç•Œï¼Œå……æ–¥ç€å¤§é‡çš„æ•°æ®ã€‚æ•°æ®çš„æ¥æºæœ‰å¾ˆå¤šï¼Œæ¯”å¦‚å‡ºè¡Œè®°å½•ã€æ¶ˆè´¹è®°å½•ã€ æµè§ˆçš„ç½‘é¡µã€å‘é€çš„æ¶ˆæ¯ç­‰ç­‰ã€‚é™¤äº†æ–‡æœ¬ç±»å‹çš„æ•°æ®ï¼Œå›¾åƒã€éŸ³ä¹ã€å£°éŸ³éƒ½æ˜¯æ•°æ®ã€‚</p>
<p> ä¸ºäº†æ–¹ä¾¿ç®¡ç†äº’è”ç½‘ä¸–ç•Œä¸­çš„æ•°æ®ï¼Œå°±æœ‰äº†æ•°æ®åº“ç®¡ç†ç³»ç»Ÿçš„æ¦‚å¿µï¼ˆç®€ç§°ï¼šæ•°æ®åº“ï¼‰ã€‚ç”¨æˆ·å¯ä»¥å¯¹æ•°æ®åº“ä¸­çš„æ•° æ®è¿›è¡Œæ–°å¢ã€æŸ¥è¯¢ã€æ›´æ–°ã€åˆ é™¤ç­‰æ“ä½œã€‚</p>
</blockquote>
<h4 id="å¸¸è§çš„æ•°æ®åº“åŠåˆ†ç±»"><a href="#å¸¸è§çš„æ•°æ®åº“åŠåˆ†ç±»" class="headerlink" title="å¸¸è§çš„æ•°æ®åº“åŠåˆ†ç±»"></a>å¸¸è§çš„æ•°æ®åº“åŠåˆ†ç±»</h4><blockquote>
<p>å¸‚é¢ä¸Šçš„æ•°æ®åº“æœ‰å¾ˆå¤šç§ï¼Œæœ€å¸¸è§çš„æ•°æ®åº“æœ‰å¦‚ä¸‹å‡ ä¸ªï¼š </p>
<ol>
<li>MySQL æ•°æ®åº“ï¼ˆç›®å‰ä½¿ç”¨æœ€å¹¿æ³›ã€æµè¡Œåº¦æœ€é«˜çš„å¼€æºå…è´¹æ•°æ®åº“ï¼›Community + Enterpriseï¼‰ </li>
<li>Oracle æ•°æ®åº“ï¼ˆæ”¶è´¹ï¼‰</li>
<li>SQL Server æ•°æ®åº“ï¼ˆæ”¶è´¹ï¼‰</li>
<li>Mongodb æ•°æ®åº“ï¼ˆCommunity + Enterpriseï¼‰</li>
</ol>
<p>å…¶ä¸­ï¼ŒMySQLã€Oracleã€SQL Server å±äºä¼ ç»Ÿå‹æ•°æ®åº“ï¼ˆåˆå«åšï¼šå…³ç³»å‹æ•°æ®åº“ æˆ– SQL æ•°æ®åº“ï¼‰ï¼Œè¿™ä¸‰è€…çš„ è®¾è®¡ç†å¿µç›¸åŒï¼Œç”¨æ³•æ¯”è¾ƒç±»ä¼¼ã€‚ </p>
<p>è€Œ Mongodb å±äºæ–°å‹æ•°æ®åº“ï¼ˆåˆå«åšï¼šéå…³ç³»å‹æ•°æ®åº“ æˆ– NoSQL æ•°æ®åº“ï¼‰ï¼Œå®ƒåœ¨ä¸€å®šç¨‹åº¦ä¸Šå¼¥è¡¥äº†ä¼ ç»Ÿå‹ æ•°æ®åº“çš„ç¼ºé™·ã€‚</p>
</blockquote>
<h4 id="ä¼ ç»Ÿå‹æ•°æ®åº“çš„æ•°æ®ç»„ç»‡ç»“æ„"><a href="#ä¼ ç»Ÿå‹æ•°æ®åº“çš„æ•°æ®ç»„ç»‡ç»“æ„" class="headerlink" title="ä¼ ç»Ÿå‹æ•°æ®åº“çš„æ•°æ®ç»„ç»‡ç»“æ„"></a>ä¼ ç»Ÿå‹æ•°æ®åº“çš„æ•°æ®ç»„ç»‡ç»“æ„</h4><blockquote>
<p>æ•°æ®çš„ç»„ç»‡ç»“æ„ï¼šæŒ‡çš„å°±æ˜¯æ•°æ®ä»¥ä»€ä¹ˆæ ·çš„ç»“æ„è¿›è¡Œå­˜å‚¨ã€‚</p>
<p>ä¼ ç»Ÿå‹æ•°æ®åº“çš„æ•°æ®ç»„ç»‡ç»“æ„ï¼Œä¸ Excel ä¸­æ•°æ®çš„ç»„ç»‡ç»“æ„ æ¯”è¾ƒç±»ä¼¼ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹æ¯”ç€ Excel æ¥äº†è§£å’Œå­¦ä¹ ä¼ ç»Ÿå‹æ•°æ®åº“çš„ æ•°æ®ç»„ç»‡ç»“æ„ã€‚</p>
</blockquote>
<h5 id="Excel-çš„æ•°æ®ç»„ç»‡ç»“æ„"><a href="#Excel-çš„æ•°æ®ç»„ç»‡ç»“æ„" class="headerlink" title="Excel çš„æ•°æ®ç»„ç»‡ç»“æ„"></a>Excel çš„æ•°æ®ç»„ç»‡ç»“æ„</h5><blockquote>
<p>æ¯ä¸ª Excel ä¸­ï¼Œæ•°æ®çš„ç»„ç»‡ç»“æ„åˆ†åˆ«ä¸ºå·¥ä½œç°¿ã€å·¥ä½œè¡¨ã€æ•°æ®è¡Œã€åˆ—è¿™ 4 å¤§éƒ¨åˆ†ç»„æˆã€‚</p>
<ol>
<li>æ•´ä¸ª Excel å«åšå·¥ä½œç°¿</li>
<li>users å’Œ books æ˜¯å·¥ä½œè¡¨</li>
<li>users å·¥ä½œè¡¨ä¸­æœ‰ 3 è¡Œæ•°æ®</li>
<li>æ¯è¡Œæ•°æ®ç”± 6 åˆ—ä¿¡æ¯ç»„æˆ</li>
<li>æ¯åˆ—ä¿¡æ¯éƒ½æœ‰å¯¹åº”çš„æ•°æ®ç±»å‹</li>
</ol>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pphc5Ke"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/./NodeJs.assets/pphc5Ke.png" alt="pphc5Ke.png"></a></p>
<h5 id="ä¼ ç»Ÿå‹æ•°æ®åº“çš„æ•°æ®ç»„ç»‡ç»“æ„-1"><a href="#ä¼ ç»Ÿå‹æ•°æ®åº“çš„æ•°æ®ç»„ç»‡ç»“æ„-1" class="headerlink" title="ä¼ ç»Ÿå‹æ•°æ®åº“çš„æ•°æ®ç»„ç»‡ç»“æ„"></a>ä¼ ç»Ÿå‹æ•°æ®åº“çš„æ•°æ®ç»„ç»‡ç»“æ„</h5><blockquote>
<p>åœ¨ä¼ ç»Ÿå‹æ•°æ®åº“ä¸­ï¼Œæ•°æ®çš„ç»„ç»‡ç»“æ„åˆ†ä¸ºæ•°æ®åº“(database)ã€æ•°æ®è¡¨(table)ã€æ•°æ®è¡Œ(row)ã€å­—æ®µ(field)è¿™ 4 å¤§éƒ¨åˆ†ç»„æˆã€‚</p>
<ol>
<li>æ•°æ®åº“ç±»ä¼¼äº Excel çš„å·¥ä½œç°¿</li>
<li>æ•°æ®è¡¨ç±»ä¼¼äº Excel çš„å·¥ä½œè¡¨</li>
<li>æ•°æ®è¡Œç±»ä¼¼äº Excel çš„æ¯ä¸€è¡Œæ•°æ®</li>
<li>å­—æ®µç±»ä¼¼äº Excel çš„åˆ—</li>
<li>æ¯ä¸ªå­—æ®µéƒ½æœ‰å¯¹åº”çš„æ•°æ®ç±»å‹</li>
</ol>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pphgP5q"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/./NodeJs.assets/pphgP5q.png" alt="pphgP5q.png"></a></p>
<h5 id="å®é™…å¼€å‘ä¸­åº“ã€è¡¨ã€è¡Œã€å­—æ®µçš„å…³ç³»"><a href="#å®é™…å¼€å‘ä¸­åº“ã€è¡¨ã€è¡Œã€å­—æ®µçš„å…³ç³»" class="headerlink" title="å®é™…å¼€å‘ä¸­åº“ã€è¡¨ã€è¡Œã€å­—æ®µçš„å…³ç³»"></a>å®é™…å¼€å‘ä¸­åº“ã€è¡¨ã€è¡Œã€å­—æ®µçš„å…³ç³»</h5><blockquote>
<ol>
<li>åœ¨å®é™…é¡¹ç›®å¼€å‘ä¸­ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ¯ä¸ªé¡¹ç›®éƒ½å¯¹åº”ç‹¬ç«‹çš„æ•°æ®åº“ã€‚</li>
<li>ä¸åŒçš„æ•°æ®ï¼Œè¦å­˜å‚¨åˆ°æ•°æ®åº“çš„ä¸åŒè¡¨ä¸­ï¼Œä¾‹å¦‚ï¼šç”¨æˆ·æ•°æ®å­˜å‚¨åˆ° users è¡¨ä¸­ï¼Œå›¾ä¹¦æ•°æ®å­˜å‚¨åˆ° books è¡¨ä¸­ã€‚</li>
<li>æ¯ä¸ªè¡¨ä¸­å…·ä½“å­˜å‚¨å“ªäº›ä¿¡æ¯ï¼Œç”±å­—æ®µæ¥å†³å®šï¼Œä¾‹å¦‚ï¼šæˆ‘ä»¬å¯ä»¥ä¸º users è¡¨è®¾è®¡ idã€usernameã€password è¿™ 3 ä¸ª å­—æ®µã€‚</li>
<li>è¡¨ä¸­çš„è¡Œï¼Œä»£è¡¨æ¯ä¸€æ¡å…·ä½“çš„æ•°æ®ã€‚</li>
</ol>
</blockquote>
<h4 id="å®‰è£…å¹¶é…ç½®-MySQL"><a href="#å®‰è£…å¹¶é…ç½®-MySQL" class="headerlink" title="å®‰è£…å¹¶é…ç½® MySQL"></a>å®‰è£…å¹¶é…ç½® MySQL</h4><h5 id="äº†è§£éœ€è¦å®‰è£…å“ªäº›MySQLç›¸å…³çš„è½¯ä»¶"><a href="#äº†è§£éœ€è¦å®‰è£…å“ªäº›MySQLç›¸å…³çš„è½¯ä»¶" class="headerlink" title="äº†è§£éœ€è¦å®‰è£…å“ªäº›MySQLç›¸å…³çš„è½¯ä»¶"></a>äº†è§£éœ€è¦å®‰è£…å“ªäº›MySQLç›¸å…³çš„è½¯ä»¶</h5><blockquote>
<p>å¯¹äºå¼€å‘äººå‘˜æ¥è¯´ï¼Œåªéœ€è¦å®‰è£… MySQL Server å’Œ MySQL Workbench è¿™ä¸¤ä¸ªè½¯ä»¶ï¼Œå°±èƒ½æ»¡è¶³å¼€å‘çš„éœ€è¦äº†ã€‚</p>
<ol>
<li>MySQL Serverï¼šä¸“é—¨ç”¨æ¥æä¾›æ•°æ®å­˜å‚¨å’ŒæœåŠ¡çš„è½¯ä»¶ã€‚</li>
<li>MySQL Workbenchï¼šå¯è§†åŒ–çš„ MySQL ç®¡ç†å·¥å…·ï¼Œé€šè¿‡å®ƒï¼Œå¯ä»¥æ–¹ä¾¿çš„æ“ä½œå­˜å‚¨åœ¨ MySQL Server ä¸­çš„æ•°æ®ã€‚</li>
</ol>
</blockquote>
<h5 id="MySQL-åœ¨-Windows-ç¯å¢ƒä¸‹çš„å®‰è£…"><a href="#MySQL-åœ¨-Windows-ç¯å¢ƒä¸‹çš„å®‰è£…" class="headerlink" title="MySQL åœ¨ Windows ç¯å¢ƒä¸‹çš„å®‰è£…"></a>MySQL åœ¨ Windows ç¯å¢ƒä¸‹çš„å®‰è£…</h5><blockquote>
<p>åœ¨ Windows ç¯å¢ƒä¸‹å®‰è£… MySQLï¼Œåªéœ€è¦è¿è¡Œ mysql-installer-community-8.0.19.0.msi è¿™ä¸ªå®‰è£…åŒ…ï¼Œå°±èƒ½ä¸€æ¬¡ æ€§å°† MySQL Server å’Œ MySQL Workbench å®‰è£…åˆ°è‡ªå·±çš„ç”µè„‘ä¸Šã€‚ </p>
</blockquote>
<h4 id="ä½¿ç”¨-MySQL-Workbench-ç®¡ç†æ•°æ®åº“"><a href="#ä½¿ç”¨-MySQL-Workbench-ç®¡ç†æ•°æ®åº“" class="headerlink" title="ä½¿ç”¨ MySQL Workbench ç®¡ç†æ•°æ®åº“"></a>ä½¿ç”¨ MySQL Workbench ç®¡ç†æ•°æ®åº“</h4><h5 id="è¿æ¥æ•°æ®åº“"><a href="#è¿æ¥æ•°æ®åº“" class="headerlink" title="è¿æ¥æ•°æ®åº“"></a>è¿æ¥æ•°æ®åº“</h5><p><a target="_blank" rel="noopener" href="https://imgse.com/i/pphgUZd"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/./NodeJs.assets/pphgUZd-1680515198093-9.png" alt="pphgUZd.png"></a></p>
<h5 id="äº†è§£ä¸»ç•Œé¢çš„ç»„æˆéƒ¨åˆ†"><a href="#äº†è§£ä¸»ç•Œé¢çš„ç»„æˆéƒ¨åˆ†" class="headerlink" title="äº†è§£ä¸»ç•Œé¢çš„ç»„æˆéƒ¨åˆ†"></a>äº†è§£ä¸»ç•Œé¢çš„ç»„æˆéƒ¨åˆ†</h5><p><a target="_blank" rel="noopener" href="https://imgse.com/i/pphgdII"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/./NodeJs.assets/pphgdII.png" alt="pphgdII.png"></a></p>
<h5 id="åˆ›å»ºæ•°æ®åº“"><a href="#åˆ›å»ºæ•°æ®åº“" class="headerlink" title="åˆ›å»ºæ•°æ®åº“"></a>åˆ›å»ºæ•°æ®åº“</h5><p><a target="_blank" rel="noopener" href="https://imgse.com/i/pphg0it"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/./NodeJs.assets/pphg0it.png" alt="pphg0it.png"></a></p>
<h5 id="åˆ›å»ºæ•°æ®è¡¨"><a href="#åˆ›å»ºæ•°æ®è¡¨" class="headerlink" title="åˆ›å»ºæ•°æ®è¡¨"></a>åˆ›å»ºæ•°æ®è¡¨</h5><blockquote>
<p>DataType æ•°æ®ç±»å‹ï¼š </p>
<ol>
<li>int æ•´æ•° </li>
<li>varchar(len) å­—ç¬¦ä¸² </li>
<li>tinyint(1) å¸ƒå°”å€¼</li>
</ol>
<p>å­—æ®µçš„ç‰¹æ®Šæ ‡è¯†ï¼š</p>
<ol>
<li>PKï¼ˆPrimary Keyï¼‰ä¸»é”®ã€å”¯ä¸€æ ‡è¯†</li>
<li>NNï¼ˆNot Nullï¼‰å€¼ä¸å…è®¸ä¸ºç©º</li>
<li>UQï¼ˆUniqueï¼‰å€¼å”¯ä¸€</li>
<li>AIï¼ˆAuto Incrementï¼‰å€¼è‡ªåŠ¨å¢é•¿</li>
</ol>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pphgrz8"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/./NodeJs.assets/pphgrz8.png" alt="pphgrz8.png"></a></p>
<h5 id="å‘è¡¨ä¸­å†™å…¥æ•°æ®"><a href="#å‘è¡¨ä¸­å†™å…¥æ•°æ®" class="headerlink" title="å‘è¡¨ä¸­å†™å…¥æ•°æ®"></a>å‘è¡¨ä¸­å†™å…¥æ•°æ®</h5><p><a target="_blank" rel="noopener" href="https://imgse.com/i/pphgyQS"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/./NodeJs.assets/pphgyQS.png" alt="pphgyQS.png"></a></p>
<h4 id="ä½¿ç”¨-SQL-ç®¡ç†æ•°æ®åº“"><a href="#ä½¿ç”¨-SQL-ç®¡ç†æ•°æ®åº“" class="headerlink" title="ä½¿ç”¨ SQL ç®¡ç†æ•°æ®åº“"></a>ä½¿ç”¨ SQL ç®¡ç†æ•°æ®åº“</h4><h5 id="ä»€ä¹ˆæ˜¯-SQL"><a href="#ä»€ä¹ˆæ˜¯-SQL" class="headerlink" title="ä»€ä¹ˆæ˜¯ SQL"></a>ä»€ä¹ˆæ˜¯ SQL</h5><blockquote>
<p>SQLï¼ˆè‹±æ–‡å…¨ç§°ï¼šStructured Query Languageï¼‰æ˜¯ç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€ï¼Œä¸“é—¨ç”¨æ¥è®¿é—®å’Œå¤„ç†æ•°æ®åº“çš„ç¼–ç¨‹è¯­è¨€ã€‚èƒ½å¤Ÿè®© æˆ‘ä»¬ä»¥ç¼–ç¨‹çš„å½¢å¼ï¼Œæ“ä½œæ•°æ®åº“é‡Œé¢çš„æ•°æ®ã€‚</p>
<p> ä¸‰ä¸ªå…³é”®ç‚¹ï¼š </p>
<ol>
<li>SQL æ˜¯ä¸€é—¨æ•°æ®åº“ç¼–ç¨‹è¯­è¨€</li>
<li>ä½¿ç”¨ SQL è¯­è¨€ç¼–å†™å‡ºæ¥çš„ä»£ç ï¼Œå«åš SQL è¯­å¥</li>
<li>SQL è¯­è¨€åªèƒ½åœ¨å…³ç³»å‹æ•°æ®åº“ä¸­ä½¿ç”¨ï¼ˆä¾‹å¦‚ MySQLã€Oracleã€SQL Serverï¼‰ã€‚éå…³ç³»å‹æ•°æ®åº“ï¼ˆä¾‹å¦‚ Mongodbï¼‰ ä¸æ”¯æŒ SQL è¯­è¨€</li>
</ol>
</blockquote>
<h5 id="SQL-èƒ½åšä»€ä¹ˆ"><a href="#SQL-èƒ½åšä»€ä¹ˆ" class="headerlink" title="SQL èƒ½åšä»€ä¹ˆ"></a>SQL èƒ½åšä»€ä¹ˆ</h5><blockquote>
<ol>
<li>ä»æ•°æ®åº“ä¸­æŸ¥è¯¢æ•°æ®</li>
<li>å‘æ•°æ®åº“ä¸­æ’å…¥æ–°çš„æ•°æ®</li>
<li>æ›´æ–°æ•°æ®åº“ä¸­çš„æ•°æ® </li>
<li>ä»æ•°æ®åº“åˆ é™¤æ•°æ®</li>
<li>å¯ä»¥åˆ›å»ºæ–°æ•°æ®åº“</li>
<li>å¯åœ¨æ•°æ®åº“ä¸­åˆ›å»ºæ–°è¡¨</li>
<li>å¯åœ¨æ•°æ®åº“ä¸­åˆ›å»ºå­˜å‚¨è¿‡ç¨‹ã€è§†å›¾</li>
<li>etcâ€¦</li>
</ol>
</blockquote>
<h5 id="SQL-çš„å­¦ä¹ ç›®æ ‡"><a href="#SQL-çš„å­¦ä¹ ç›®æ ‡" class="headerlink" title="SQL çš„å­¦ä¹ ç›®æ ‡"></a>SQL çš„å­¦ä¹ ç›®æ ‡</h5><blockquote>
<p>é‡ç‚¹æŒæ¡å¦‚ä½•ä½¿ç”¨ SQL ä»æ•°æ®è¡¨ä¸­ï¼š </p>
<ol>
<li>æŸ¥è¯¢æ•°æ®ï¼ˆselectï¼‰</li>
<li>æ’å…¥æ•°æ®ï¼ˆinsert intoï¼‰</li>
<li>æ›´æ–°æ•°æ®ï¼ˆupdateï¼‰</li>
<li>åˆ é™¤æ•°æ®ï¼ˆdeleteï¼‰</li>
</ol>
<p> é¢å¤–éœ€è¦æŒæ¡çš„ 4 ç§ SQL è¯­æ³•ï¼š </p>
<ol>
<li>where æ¡ä»¶</li>
<li>and å’Œ or è¿ç®—ç¬¦</li>
<li>order by æ’åº</li>
<li>count(*) å‡½æ•°</li>
</ol>
</blockquote>
<h4 id="ç”¨åˆ°çš„sqlè¯­å¥"><a href="#ç”¨åˆ°çš„sqlè¯­å¥" class="headerlink" title="ç”¨åˆ°çš„sqlè¯­å¥"></a>ç”¨åˆ°çš„sqlè¯­å¥</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">-- é€šè¿‡ * æŠŠ users è¡¨ä¸­æ‰€æœ‰çš„æ•°æ®æŸ¥è¯¢å‡ºæ¥</span><br><span class="line">-- select * from users</span><br><span class="line"></span><br><span class="line">-- ä» users è¡¨ä¸­æŠŠ username å’Œ password å¯¹åº”çš„æ•°æ®æŸ¥è¯¢å‡ºæ¥</span><br><span class="line">-- select username, password from users</span><br><span class="line"></span><br><span class="line">-- å‘ users è¡¨ä¸­ï¼Œæ’å…¥æ–°æ•°æ®ï¼Œusername çš„å€¼ä¸º tony stark  password çš„å€¼ä¸º 098123</span><br><span class="line">-- insert into users (username, password) values (&#x27;tony stark&#x27;, &#x27;098123&#x27;)</span><br><span class="line">-- select * from users</span><br><span class="line"></span><br><span class="line">-- å°† id ä¸º 4 çš„ç”¨æˆ·å¯†ç ï¼Œæ›´æ–°æˆ 888888</span><br><span class="line">-- update users set password=&#x27;888888&#x27; where id=4</span><br><span class="line">-- select * from users</span><br><span class="line"></span><br><span class="line">-- æ›´æ–° id ä¸º 2 çš„ç”¨æˆ·ï¼ŒæŠŠç”¨æˆ·å¯†ç æ›´æ–°ä¸º admin123  åŒæ—¶ï¼ŒæŠŠç”¨æˆ·çš„çŠ¶æ€æ›´æ–°ä¸º 1</span><br><span class="line">-- update users set password=&#x27;admin123&#x27;, status=1 where id=2</span><br><span class="line">-- select * from users</span><br><span class="line"></span><br><span class="line">-- åˆ é™¤ users è¡¨ä¸­ï¼Œ id ä¸º 4 çš„ç”¨æˆ·</span><br><span class="line">-- delete from users where id=4</span><br><span class="line">-- select * from users</span><br><span class="line"></span><br><span class="line">-- æ¼”ç¤º where å­å¥çš„ä½¿ç”¨</span><br><span class="line">-- select * from users where status=1</span><br><span class="line">-- select * from users where id&gt;=2</span><br><span class="line">-- select * from users where username&lt;&gt;&#x27;ls&#x27;</span><br><span class="line">-- select * from users where username!=&#x27;ls&#x27;</span><br><span class="line"></span><br><span class="line">-- ä½¿ç”¨ AND æ¥æ˜¾ç¤ºæ‰€æœ‰çŠ¶æ€ä¸º0ä¸”idå°äº3çš„ç”¨æˆ·</span><br><span class="line">-- select * from users where status=0 and id&lt;3</span><br><span class="line"></span><br><span class="line">-- ä½¿ç”¨ or æ¥æ˜¾ç¤ºæ‰€æœ‰çŠ¶æ€ä¸º1 æˆ– username ä¸º zs çš„ç”¨æˆ·</span><br><span class="line">-- select * from users where status=1 or username=&#x27;zs&#x27;</span><br><span class="line"></span><br><span class="line">-- å¯¹usersè¡¨ä¸­çš„æ•°æ®ï¼ŒæŒ‰ç…§ status å­—æ®µè¿›è¡Œå‡åºæ’åº</span><br><span class="line">-- select * from users order by status</span><br><span class="line"></span><br><span class="line">-- æŒ‰ç…§ id å¯¹ç»“æœè¿›è¡Œé™åºçš„æ’åº  desc è¡¨ç¤ºé™åºæ’åº   asc è¡¨ç¤ºå‡åºæ’åºï¼ˆé»˜è®¤æƒ…å†µä¸‹ï¼Œå°±æ˜¯å‡åºæ’åºçš„ï¼‰</span><br><span class="line">-- select * from users order by id desc</span><br><span class="line"></span><br><span class="line">-- å¯¹ users è¡¨ä¸­çš„æ•°æ®ï¼Œå…ˆæŒ‰ç…§ status è¿›è¡Œé™åºæ’åºï¼Œå†æŒ‰ç…§ username å­—æ¯çš„é¡ºåºï¼Œè¿›è¡Œå‡åºçš„æ’åº</span><br><span class="line">-- select * from users order by status desc, username asc</span><br><span class="line"></span><br><span class="line">-- ä½¿ç”¨ count(*) æ¥ç»Ÿè®¡ users è¡¨ä¸­ï¼ŒçŠ¶æ€ä¸º 0 ç”¨æˆ·çš„æ€»æ•°é‡</span><br><span class="line">-- select count(*) from users where status=0</span><br><span class="line"></span><br><span class="line">-- ä½¿ç”¨ AS å…³é”®å­—ç»™åˆ—èµ·åˆ«å</span><br><span class="line">-- select count(*) as total from users where status=0</span><br><span class="line">-- select username as uname, password as upwd from users</span><br></pre></td></tr></table></figure>



<h4 id="SQL-çš„-SELECT-è¯­å¥"><a href="#SQL-çš„-SELECT-è¯­å¥" class="headerlink" title="SQL çš„ SELECT è¯­å¥"></a>SQL çš„ SELECT è¯­å¥</h4><h5 id="è¯­æ³•"><a href="#è¯­æ³•" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h5><blockquote>
<p>SELECT è¯­å¥ç”¨äºä»è¡¨ä¸­æŸ¥è¯¢æ•°æ®ã€‚æ‰§è¡Œçš„ç»“æœè¢«å­˜å‚¨åœ¨ä¸€ä¸ªç»“æœè¡¨ä¸­ï¼ˆç§°ä¸ºç»“æœé›†ï¼‰ã€‚è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-- è¿™æ˜¯æ³¨é‡Š</span><br><span class="line">-- ä» from æŒ‡å®šçš„ã€è¡¨ä¸­ã€‘ï¼ŒæŸ¥è¯¢å‡ºã€æ‰€æœ‰çš„ã€‘æ•°æ®ï¼Œ*è¡¨ç¤ºæ‰€æœ‰åˆ—</span><br><span class="line">select * from åˆ—åç§°</span><br><span class="line"></span><br><span class="line">-- ä» from æŒ‡å®šçš„ã€è¡¨ä¸­ã€‘ï¼ŒæŸ¥è¯¢å‡ºæŒ‡å®šçš„ åˆ—åç§°ï¼ˆå­—æ®µï¼‰çš„æ•°æ®</span><br><span class="line">select åˆ—å from è¡¨å</span><br></pre></td></tr></table></figure>

<p><code>æ³¨æ„ï¼šSQL è¯­å¥ä¸­çš„å…³é”®å­—å¯¹å¤§å°å†™ä¸æ•æ„Ÿã€‚SELECT ç­‰æ•ˆäº selectï¼ŒFROM ç­‰æ•ˆäº fromã€‚</code></p>
<h5 id="SELECT-ç¤ºä¾‹"><a href="#SELECT-ç¤ºä¾‹" class="headerlink" title="SELECT * ç¤ºä¾‹"></a>SELECT * ç¤ºä¾‹</h5><blockquote>
<p>æˆ‘ä»¬å¸Œæœ›ä» users è¡¨ä¸­é€‰å–æ‰€æœ‰çš„åˆ—ï¼Œå¯ä»¥ä½¿ç”¨ç¬¦å· * å–ä»£åˆ—çš„åç§°ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pph2GYq"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/./NodeJs.assets/pph2GYq.png" alt="pph2GYq.png"></a></p>
<h5 id="SELECT-åˆ—åç§°-ç¤ºä¾‹"><a href="#SELECT-åˆ—åç§°-ç¤ºä¾‹" class="headerlink" title="SELECT åˆ—åç§° ç¤ºä¾‹"></a>SELECT åˆ—åç§° ç¤ºä¾‹</h5><blockquote>
<p>å¦‚éœ€è·å–åä¸º "username" å’Œ "password" çš„åˆ—çš„å†…å®¹ï¼ˆä»åä¸º "users" çš„æ•°æ®åº“è¡¨ï¼‰ï¼Œè¯·ä½¿ç”¨ä¸‹é¢çš„ SELECT è¯­å¥ï¼š</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pph2NlT"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/./NodeJs.assets/pph2NlT.png" alt="pph2NlT.png"></a></p>
<h4 id="SQL-çš„-INSERT-INTO-è¯­å¥"><a href="#SQL-çš„-INSERT-INTO-è¯­å¥" class="headerlink" title="SQL çš„ INSERT INTO è¯­å¥"></a>SQL çš„ INSERT INTO è¯­å¥</h4><h5 id="è¯­æ³•-1"><a href="#è¯­æ³•-1" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h5><blockquote>
<p>INSERT INTO è¯­å¥ç”¨äºå‘æ•°æ®è¡¨ä¸­æ’å…¥æ–°çš„æ•°æ®è¡Œï¼Œè¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-- è¯­æ³•è§£è¯»ï¼šå‘æŒ‡å®šçš„è¡¨ä¸­ï¼Œæ’å…¥å¦‚ä¸‹å‡ åˆ—æ•°æ®ï¼Œåˆ—çš„å€¼é€šè¿‡ values --æŒ‡å®š</span><br><span class="line">-- æ³¨æ„ï¼šåˆ—å’Œå€¼è¦ä¸€ä¸€å¯¹åº”ï¼Œå¤šä¸ªåˆ—å’Œå¤šä¸ªå€¼ä¹‹é—´ï¼Œä½¿ç”¨è‹±æ–‡é€—å·åˆ†éš”</span><br><span class="line">insert into è¡¨å(åˆ—1,åˆ—2,...) values (å€¼1,å€¼2...)</span><br></pre></td></tr></table></figure>



<h5 id="INSERT-INTO-ç¤ºä¾‹"><a href="#INSERT-INTO-ç¤ºä¾‹" class="headerlink" title="INSERT INTO ç¤ºä¾‹"></a>INSERT INTO ç¤ºä¾‹</h5><blockquote>
<p>å‘ users è¡¨ä¸­ï¼Œæ’å…¥ä¸€æ¡ username ä¸º tony starkï¼Œpassword ä¸º 098123 çš„ç”¨æˆ·æ•°æ®ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pph2wm4"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/./NodeJs.assets/pph2wm4.png" alt="pph2wm4.png"></a></p>
<h4 id="SQL-çš„-UPDATE-è¯­å¥"><a href="#SQL-çš„-UPDATE-è¯­å¥" class="headerlink" title="SQL çš„ UPDATE è¯­å¥"></a>SQL çš„ UPDATE è¯­å¥</h4><h5 id="è¯­æ³•-2"><a href="#è¯­æ³•-2" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h5><blockquote>
<p>Update è¯­å¥ç”¨äºä¿®æ”¹è¡¨ä¸­çš„æ•°æ®ã€‚è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-- è¯­æ³•è§£è¯»</span><br><span class="line">-- 1. ç”¨ update æŒ‡å®šè¦æ›´æ–°å“ªä¸ªè¡¨çš„æ•°æ®</span><br><span class="line">-- 2. ç”¨ set æŒ‡å®šåˆ—å¯¹åº”çš„æ–°å€¼</span><br><span class="line">-- 3. ç”¨ where æŒ‡å®šæ›´æ–°çš„æ¡ä»¶</span><br><span class="line">update è¡¨å set åˆ—å = æ–°å€¼ where åˆ—å = æŸå€¼</span><br></pre></td></tr></table></figure>



<h5 id="UPDATE-ç¤ºä¾‹-æ›´æ–°æŸä¸€è¡Œä¸­çš„ä¸€ä¸ªåˆ—"><a href="#UPDATE-ç¤ºä¾‹-æ›´æ–°æŸä¸€è¡Œä¸­çš„ä¸€ä¸ªåˆ—" class="headerlink" title="UPDATE ç¤ºä¾‹ - æ›´æ–°æŸä¸€è¡Œä¸­çš„ä¸€ä¸ªåˆ—"></a>UPDATE ç¤ºä¾‹ - æ›´æ–°æŸä¸€è¡Œä¸­çš„ä¸€ä¸ªåˆ—</h5><blockquote>
<p>æŠŠ users è¡¨ä¸­ id ä¸º 7 çš„ç”¨æˆ·å¯†ç ï¼Œæ›´æ–°ä¸º 888888ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pph2rkR"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/./NodeJs.assets/pph2rkR.png" alt="pph2rkR.png"></a></p>
<h5 id="UPDATE-ç¤ºä¾‹-æ›´æ–°æŸä¸€è¡Œä¸­çš„è‹¥å¹²åˆ—"><a href="#UPDATE-ç¤ºä¾‹-æ›´æ–°æŸä¸€è¡Œä¸­çš„è‹¥å¹²åˆ—" class="headerlink" title="UPDATE ç¤ºä¾‹ - æ›´æ–°æŸä¸€è¡Œä¸­çš„è‹¥å¹²åˆ—"></a>UPDATE ç¤ºä¾‹ - æ›´æ–°æŸä¸€è¡Œä¸­çš„è‹¥å¹²åˆ—</h5><blockquote>
<p>æŠŠ users è¡¨ä¸­ id ä¸º 2 çš„ç”¨æˆ·å¯†ç å’Œç”¨æˆ·çŠ¶æ€ï¼Œåˆ†åˆ«æ›´æ–°ä¸º admin123 å’Œ 1ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pph4mqO"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/./NodeJs.assets/pph4mqO.png" alt="pph4mqO.png"></a></p>
<h4 id="SQL-çš„-DELETE-è¯­å¥"><a href="#SQL-çš„-DELETE-è¯­å¥" class="headerlink" title="SQL çš„ DELETE è¯­å¥"></a>SQL çš„ DELETE è¯­å¥</h4><h5 id="è¯­æ³•-3"><a href="#è¯­æ³•-3" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h5><blockquote>
<p>DELETE è¯­å¥ç”¨äºåˆ é™¤è¡¨ä¸­çš„è¡Œã€‚è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-- è¯­æ³•è§£è¯»</span><br><span class="line">-- ä»æŒ‡å®šçš„è¡¨ä¸­ï¼Œæ ¹æ® where æ¡ä»¶ï¼Œåˆ é™¤å¯¹åº”çš„æ•°æ®è¡Œ</span><br><span class="line">delete from è¡¨å where åˆ—å = å€¼</span><br></pre></td></tr></table></figure>



<h5 id="DELETE-ç¤ºä¾‹"><a href="#DELETE-ç¤ºä¾‹" class="headerlink" title="DELETE ç¤ºä¾‹"></a>DELETE ç¤ºä¾‹</h5><blockquote>
<p>ä» users è¡¨ä¸­ï¼Œåˆ é™¤ id ä¸º 4 çš„ç”¨æˆ·ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pph4rzq"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/./NodeJs.assets/pph4rzq.png" alt="pph4rzq.png"></a></p>
<h4 id="SQL-çš„-WHERE-å­å¥"><a href="#SQL-çš„-WHERE-å­å¥" class="headerlink" title="SQL çš„ WHERE å­å¥"></a>SQL çš„ WHERE å­å¥</h4><h5 id="è¯­æ³•-4"><a href="#è¯­æ³•-4" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h5><blockquote>
<p>WHERE å­å¥ç”¨äºé™å®šé€‰æ‹©çš„æ ‡å‡†ã€‚åœ¨ SELECTã€UPDATEã€DELETE è¯­å¥ä¸­ï¼Œçš†å¯ä½¿ç”¨ WHERE å­å¥æ¥é™å®šé€‰æ‹©çš„æ ‡å‡†ã€‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-- æŸ¥è¯¢è¯­å¥ä¸­çš„ where æ¡ä»¶</span><br><span class="line">select åˆ—å from è¡¨å where åˆ—è¿ç®—ç¬¦ å€¼</span><br><span class="line">-- æ›´æ–°è¯­å¥ä¸­çš„ where æ¡ä»¶</span><br><span class="line">update è¡¨å set åˆ— = æ–°å€¼ where åˆ— è¿ç®—ç¬¦ å€¼</span><br><span class="line">-- åˆ é™¤è¯­å¥ä¸­çš„ where æ¡ä»¶</span><br><span class="line">delete from è¡¨å where åˆ—è¿ç®—ç¬¦ å€¼</span><br></pre></td></tr></table></figure>



<h5 id="å¯åœ¨-WHERE-å­å¥ä¸­ä½¿ç”¨çš„è¿ç®—ç¬¦"><a href="#å¯åœ¨-WHERE-å­å¥ä¸­ä½¿ç”¨çš„è¿ç®—ç¬¦" class="headerlink" title="å¯åœ¨ WHERE å­å¥ä¸­ä½¿ç”¨çš„è¿ç®—ç¬¦"></a>å¯åœ¨ WHERE å­å¥ä¸­ä½¿ç”¨çš„è¿ç®—ç¬¦</h5><blockquote>
<p>ä¸‹é¢çš„è¿ç®—ç¬¦å¯åœ¨ WHERE å­å¥ä¸­ä½¿ç”¨ï¼Œç”¨æ¥é™å®šé€‰æ‹©çš„æ ‡å‡†ï¼š</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pph4RwF"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/./NodeJs.assets/pph4RwF.png" alt="pph4RwF.png"></a></p>
<p><code>æ³¨æ„ï¼šåœ¨æŸäº›ç‰ˆæœ¬çš„ SQL ä¸­ï¼Œæ“ä½œç¬¦ &lt;&gt; å¯ä»¥å†™ä¸º !=</code></p>
<h5 id="WHERE-å­å¥ç¤ºä¾‹"><a href="#WHERE-å­å¥ç¤ºä¾‹" class="headerlink" title="WHERE å­å¥ç¤ºä¾‹"></a>WHERE å­å¥ç¤ºä¾‹</h5><blockquote>
<p>å¯ä»¥é€šè¿‡ WHERE å­å¥æ¥é™å®š SELECT çš„æŸ¥è¯¢æ¡ä»¶ï¼š</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-- æŸ¥è¯¢ status ä¸º 1 çš„æ‰€æœ‰ç”¨æˆ·</span><br><span class="line">selest * from user where status=1</span><br><span class="line">-- æŸ¥è¯¢ id å¤§äº 2 çš„æ‰€æœ‰ç”¨æˆ·</span><br><span class="line">select * from user where id &gt; 2</span><br><span class="line">-- æŸ¥è¯¢ username ä¸ç­‰äº admin çš„æ‰€æœ‰ç”¨æˆ·</span><br><span class="line">select * from user where username&lt;&gt;&#x27;admin&#x27;</span><br></pre></td></tr></table></figure>







<h4 id="SQL-çš„-AND-å’Œ-OR-è¿ç®—ç¬¦"><a href="#SQL-çš„-AND-å’Œ-OR-è¿ç®—ç¬¦" class="headerlink" title="SQL çš„ AND å’Œ OR è¿ç®—ç¬¦"></a>SQL çš„ AND å’Œ OR è¿ç®—ç¬¦</h4><h5 id="è¯­æ³•-5"><a href="#è¯­æ³•-5" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h5><blockquote>
<p>AND å’Œ OR å¯åœ¨ WHERE å­è¯­å¥ä¸­æŠŠä¸¤ä¸ªæˆ–å¤šä¸ªæ¡ä»¶ç»“åˆèµ·æ¥ã€‚</p>
<p> AND è¡¨ç¤ºå¿…é¡»åŒæ—¶æ»¡è¶³å¤šä¸ªæ¡ä»¶ï¼Œç›¸å½“äº JavaScript ä¸­çš„ && è¿ç®—ç¬¦ï¼Œä¾‹å¦‚ if (a !== 10 && a !== 20) </p>
<p>OR è¡¨ç¤ºåªè¦æ»¡è¶³ä»»æ„ä¸€ä¸ªæ¡ä»¶å³å¯ï¼Œç›¸å½“äº JavaScript ä¸­çš„ || è¿ç®—ç¬¦ï¼Œä¾‹å¦‚ if(a !== 10 || a !== 20)</p>
</blockquote>
<h5 id="AND-è¿ç®—ç¬¦ç¤ºä¾‹"><a href="#AND-è¿ç®—ç¬¦ç¤ºä¾‹" class="headerlink" title="AND è¿ç®—ç¬¦ç¤ºä¾‹"></a>AND è¿ç®—ç¬¦ç¤ºä¾‹</h5><blockquote>
<p>ä½¿ç”¨ AND æ¥æ˜¾ç¤ºæ‰€æœ‰ status ä¸º 0ï¼Œå¹¶ä¸” id å°äº 3 çš„ç”¨æˆ·ï¼š</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pph4oS1"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/./NodeJs.assets/pph4oS1.png" alt="pph4oS1.png"></a></p>
<h5 id="OR-è¿ç®—ç¬¦ç¤ºä¾‹"><a href="#OR-è¿ç®—ç¬¦ç¤ºä¾‹" class="headerlink" title="OR è¿ç®—ç¬¦ç¤ºä¾‹"></a>OR è¿ç®—ç¬¦ç¤ºä¾‹</h5><blockquote>
<p>ä½¿ç”¨ OR æ¥æ˜¾ç¤ºæ‰€æœ‰ status ä¸º 1ï¼Œæˆ–è€… username ä¸º zs çš„ç”¨æˆ·ï¼š</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pph47y6"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/./NodeJs.assets/pph47y6.png" alt="pph47y6.png"></a></p>
<h4 id="SQL-çš„-ORDER-BY-å­å¥"><a href="#SQL-çš„-ORDER-BY-å­å¥" class="headerlink" title="SQL çš„ ORDER BY å­å¥"></a>SQL çš„ ORDER BY å­å¥</h4><h5 id="è¯­æ³•-6"><a href="#è¯­æ³•-6" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h5><blockquote>
<p>ORDER BY è¯­å¥ç”¨äºæ ¹æ®æŒ‡å®šçš„åˆ—å¯¹ç»“æœé›†è¿›è¡Œæ’åºã€‚ </p>
<p>ORDER BY è¯­å¥é»˜è®¤æŒ‰ç…§å‡åºå¯¹è®°å½•è¿›è¡Œæ’åºã€‚ </p>
<p>å¦‚æœæ‚¨å¸Œæœ›æŒ‰ç…§é™åºå¯¹è®°å½•è¿›è¡Œæ’åºï¼Œå¯ä»¥ä½¿ç”¨ DESC å…³é”®å­—ã€‚</p>
</blockquote>
<h5 id="ORDER-BY-å­å¥-å‡åºæ’åº"><a href="#ORDER-BY-å­å¥-å‡åºæ’åº" class="headerlink" title="ORDER BY å­å¥ - å‡åºæ’åº"></a>ORDER BY å­å¥ - å‡åºæ’åº</h5><blockquote>
<p>å¯¹ users è¡¨ä¸­çš„æ•°æ®ï¼ŒæŒ‰ç…§ status å­—æ®µè¿›è¡Œå‡åºæ’åºï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pph4OTe"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/./NodeJs.assets/pph4OTe.png" alt="pph4OTe.png"></a></p>
<h5 id="ORDER-BY-å­å¥-â€“-é™åºæ’åº"><a href="#ORDER-BY-å­å¥-â€“-é™åºæ’åº" class="headerlink" title="ORDER BY å­å¥ â€“ é™åºæ’åº"></a>ORDER BY å­å¥ â€“ é™åºæ’åº</h5><blockquote>
<p>å¯¹ users è¡¨ä¸­çš„æ•°æ®ï¼ŒæŒ‰ç…§ id å­—æ®µè¿›è¡Œé™åºæ’åºï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pph5EkQ"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/./NodeJs.assets/pph5EkQ.png" alt="pph5EkQ.png"></a></p>
<h5 id="ORDER-BY-å­å¥-â€“-å¤šé‡æ’åº"><a href="#ORDER-BY-å­å¥-â€“-å¤šé‡æ’åº" class="headerlink" title="ORDER BY å­å¥ â€“ å¤šé‡æ’åº"></a>ORDER BY å­å¥ â€“ å¤šé‡æ’åº</h5><blockquote>
<p>å¯¹ users è¡¨ä¸­çš„æ•°æ®ï¼Œå…ˆæŒ‰ç…§ status å­—æ®µè¿›è¡Œé™åºæ’åºï¼Œå†æŒ‰ç…§ username çš„å­—æ¯é¡ºåºï¼Œè¿›è¡Œå‡åºæ’åºï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pph5mpn"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/./NodeJs.assets/pph5mpn.png" alt="pph5mpn.png"></a>	</p>
<h4 id="SQL-çš„-COUNT-å‡½æ•°"><a href="#SQL-çš„-COUNT-å‡½æ•°" class="headerlink" title="SQL çš„ COUNT(*) å‡½æ•°"></a>SQL çš„ COUNT(*) å‡½æ•°</h4><h5 id="è¯­æ³•-7"><a href="#è¯­æ³•-7" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h5><blockquote>
<p>COUNT(*) å‡½æ•°ç”¨äºè¿”å›æŸ¥è¯¢ç»“æœçš„æ€»æ•°æ®æ¡æ•°ï¼Œè¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select count(*) from è¡¨å</span><br></pre></td></tr></table></figure>



<h5 id="COUNT-ç¤ºä¾‹"><a href="#COUNT-ç¤ºä¾‹" class="headerlink" title="COUNT(*) ç¤ºä¾‹"></a>COUNT(*) ç¤ºä¾‹</h5><blockquote>
<p>æŸ¥è¯¢ users è¡¨ä¸­ status ä¸º 0 çš„æ€»æ•°æ®æ¡æ•°ï¼š</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pph5N11"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/./NodeJs.assets/pph5N11.png" alt="pph5N11.png"></a></p>
<h4 id="ä½¿ç”¨-AS-ä¸ºåˆ—è®¾ç½®åˆ«å"><a href="#ä½¿ç”¨-AS-ä¸ºåˆ—è®¾ç½®åˆ«å" class="headerlink" title="ä½¿ç”¨ AS ä¸ºåˆ—è®¾ç½®åˆ«å"></a>ä½¿ç”¨ AS ä¸ºåˆ—è®¾ç½®åˆ«å</h4><blockquote>
<p>å¦‚æœå¸Œæœ›ç»™æŸ¥è¯¢å‡ºæ¥çš„åˆ—åç§°è®¾ç½®åˆ«åï¼Œå¯ä»¥ä½¿ç”¨ AS å…³é”®å­—ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pph5aX6"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/./NodeJs.assets/pph5aX6.png" alt="pph5aX6.png"></a></p>
<h3 id="åœ¨é¡¹ç›®ä¸­æ“ä½œ-MySQL"><a href="#åœ¨é¡¹ç›®ä¸­æ“ä½œ-MySQL" class="headerlink" title="åœ¨é¡¹ç›®ä¸­æ“ä½œ MySQL"></a>åœ¨é¡¹ç›®ä¸­æ“ä½œ MySQL</h3><h4 id="åœ¨é¡¹ç›®ä¸­æ“ä½œæ•°æ®åº“çš„æ­¥éª¤"><a href="#åœ¨é¡¹ç›®ä¸­æ“ä½œæ•°æ®åº“çš„æ­¥éª¤" class="headerlink" title="åœ¨é¡¹ç›®ä¸­æ“ä½œæ•°æ®åº“çš„æ­¥éª¤"></a>åœ¨é¡¹ç›®ä¸­æ“ä½œæ•°æ®åº“çš„æ­¥éª¤</h4><blockquote>
<ol>
<li>å®‰è£…æ“ä½œ MySQL æ•°æ®åº“çš„ç¬¬ä¸‰æ–¹æ¨¡å—ï¼ˆmysqlï¼‰</li>
<li>é€šè¿‡ mysql æ¨¡å—è¿æ¥åˆ° MySQL æ•°æ®åº“</li>
<li>é€šè¿‡ mysql æ¨¡å—æ‰§è¡Œ SQL è¯­å¥</li>
</ol>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pph5stH"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/./NodeJs.assets/pph5stH.png" alt="pph5stH.png"></a></p>
<h4 id="å®‰è£…ä¸é…ç½®-mysql-æ¨¡å—"><a href="#å®‰è£…ä¸é…ç½®-mysql-æ¨¡å—" class="headerlink" title="å®‰è£…ä¸é…ç½® mysql æ¨¡å—"></a>å®‰è£…ä¸é…ç½® mysql æ¨¡å—</h4><h5 id="å®‰è£…-mysql-æ¨¡å—"><a href="#å®‰è£…-mysql-æ¨¡å—" class="headerlink" title="å®‰è£… mysql æ¨¡å—"></a>å®‰è£… mysql æ¨¡å—</h5><blockquote>
<p>mysql æ¨¡å—æ˜¯æ‰˜ç®¡äº npm ä¸Šçš„ç¬¬ä¸‰æ–¹æ¨¡å—ã€‚å®ƒæä¾›äº†åœ¨ Node.js é¡¹ç›®ä¸­è¿æ¥å’Œæ“ä½œ MySQL æ•°æ®åº“çš„èƒ½åŠ›ã€‚ æƒ³è¦åœ¨é¡¹ç›®ä¸­ä½¿ç”¨å®ƒï¼Œéœ€è¦å…ˆè¿è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå°† mysql å®‰è£…ä¸ºé¡¹ç›®çš„ä¾èµ–åŒ…ï¼š</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install mysql</span><br></pre></td></tr></table></figure>



<h5 id="é…ç½®-mysql-æ¨¡å—"><a href="#é…ç½®-mysql-æ¨¡å—" class="headerlink" title="é…ç½® mysql æ¨¡å—"></a>é…ç½® mysql æ¨¡å—</h5><blockquote>
<p>åœ¨ä½¿ç”¨ mysql æ¨¡å—æ“ä½œ MySQL æ•°æ®åº“ä¹‹å‰ï¼Œå¿…é¡»å…ˆå¯¹ mysql æ¨¡å—è¿›è¡Œå¿…è¦çš„é…ç½®ï¼Œä¸»è¦çš„é…ç½®æ­¥éª¤å¦‚ä¸‹ï¼š</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// 1. å¯¼å…¥ mysql æ¨¡å—</span><br><span class="line">const mysql = require(&#x27;mysql&#x27;)</span><br><span class="line">// 2. å»ºç«‹ä¸ MySQL æ•°æ®åº“çš„è¿æ¥å…³ç³»</span><br><span class="line">const db = mysql.createPool(&#123;</span><br><span class="line">  host: &#x27;127.0.0.1&#x27;, // æ•°æ®åº“çš„ IP åœ°å€</span><br><span class="line">  port: 3306,</span><br><span class="line">  user: &#x27;ache&#x27;, // ç™»å½•æ•°æ®åº“çš„è´¦å·</span><br><span class="line">  password: &#x27;mysql&#x27;, // ç™»å½•æ•°æ®åº“çš„å¯†ç </span><br><span class="line">  database: &#x27;nodejs&#x27;, // æŒ‡å®šè¦æ“ä½œå“ªä¸ªæ•°æ®åº“</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h5 id="æµ‹è¯•-mysql-æ¨¡å—èƒ½å¦æ­£å¸¸å·¥ä½œ"><a href="#æµ‹è¯•-mysql-æ¨¡å—èƒ½å¦æ­£å¸¸å·¥ä½œ" class="headerlink" title="æµ‹è¯• mysql æ¨¡å—èƒ½å¦æ­£å¸¸å·¥ä½œ"></a>æµ‹è¯• mysql æ¨¡å—èƒ½å¦æ­£å¸¸å·¥ä½œ</h5><blockquote>
<p>è°ƒç”¨ db.query() å‡½æ•°ï¼ŒæŒ‡å®šè¦æ‰§è¡Œçš„ SQL è¯­å¥ï¼Œé€šè¿‡å›è°ƒå‡½æ•°æ‹¿åˆ°æ‰§è¡Œçš„ç»“æœï¼š</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æµ‹è¯• mysql æ¨¡å—èƒ½å¦æ­£å¸¸å·¥ä½œã€&#x27;select 1&#x27;æ²¡æœ‰ä»»ä½•å®è´¨æ€§çš„æ„ä¹‰ï¼Œåªæ˜¯ä¸ºäº†æ£€æŸ¥æ˜¯å¦é…ç½®æˆåŠŸã€‘</span></span><br><span class="line">db.<span class="title function_">query</span>(<span class="string">&#x27;select 1&#x27;</span>, <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// mysql æ¨¡å—å·¥ä½œæœŸé—´æŠ¥é”™äº†</span></span><br><span class="line">  <span class="keyword">if</span>(err)</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(err.<span class="property">message</span>)</span><br><span class="line">  <span class="comment">// èƒ½å¤ŸæˆåŠŸçš„æ‰§è¡Œ SQL è¯­å¥</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(results)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ§åˆ¶å°è¾“å‡º</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">D:\Java\NodeJs\node.exe <span class="string">&quot;D:\Java\idea project\NodeJsStudy\04\01_æ“ä½œæ•°æ®åº“.js&quot;</span></span><br><span class="line">[ RowDataPacket &#123; <span class="string">&#x27;1&#x27;</span>: 1 &#125; ]</span><br></pre></td></tr></table></figure>



<h4 id="ä½¿ç”¨-mysql-æ¨¡å—æ“ä½œ-MySQL-æ•°æ®åº“"><a href="#ä½¿ç”¨-mysql-æ¨¡å—æ“ä½œ-MySQL-æ•°æ®åº“" class="headerlink" title="ä½¿ç”¨ mysql æ¨¡å—æ“ä½œ MySQL æ•°æ®åº“"></a>ä½¿ç”¨ mysql æ¨¡å—æ“ä½œ MySQL æ•°æ®åº“</h4><h5 id="æŸ¥è¯¢æ•°æ®"><a href="#æŸ¥è¯¢æ•°æ®" class="headerlink" title="æŸ¥è¯¢æ•°æ®"></a>æŸ¥è¯¢æ•°æ®</h5><blockquote>
<p>æŸ¥è¯¢ users è¡¨ä¸­æ‰€æœ‰çš„æ•°æ®ï¼š</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æŸ¥è¯¢ users è¡¨ä¸­æ‰€æœ‰çš„æ•°æ®</span></span><br><span class="line"><span class="keyword">const</span> sqlStr = <span class="string">&#x27;select * from student&#x27;</span></span><br><span class="line">db.<span class="title function_">query</span>(sqlStr, <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// æŸ¥è¯¢æ•°æ®å¤±è´¥</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(err.<span class="property">message</span>)</span><br><span class="line">  <span class="comment">// æŸ¥è¯¢æ•°æ®æˆåŠŸ</span></span><br><span class="line">  <span class="comment">// æ³¨æ„ï¼šå¦‚æœæ‰§è¡Œçš„æ˜¯ select æŸ¥è¯¢è¯­å¥ï¼Œåˆ™æ‰§è¡Œçš„ç»“æœæ˜¯æ•°ç»„</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(results)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>





<h5 id="æ’å…¥æ•°æ®"><a href="#æ’å…¥æ•°æ®" class="headerlink" title="æ’å…¥æ•°æ®"></a>æ’å…¥æ•°æ®</h5><blockquote>
<p>â€‹	å‘ studentè¡¨ä¸­æ–°å¢æ•°æ®ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‘ student è¡¨ä¸­ï¼Œæ–°å¢ä¸€æ¡æ•°æ®ï¼Œå…¶ä¸­ username çš„å€¼ä¸º Spider-Manï¼Œpassword çš„å€¼ä¸º pcc123</span></span><br><span class="line"><span class="keyword">const</span> student = &#123; <span class="title class_">Sno</span>: <span class="string">&#x27;2021304490&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;A&#x27;</span>, <span class="attr">age</span>: <span class="number">20</span>, <span class="attr">sex</span>: <span class="string">&#x27;ç”·&#x27;</span>&#125;</span><br><span class="line"><span class="comment">// å®šä¹‰å¾…æ‰§è¡Œçš„ SQL è¯­å¥</span></span><br><span class="line"><span class="keyword">const</span> sqlStr = <span class="string">&#x27;insert into student (Sno, name, age, sex) values (?, ?, ?, ?)&#x27;</span></span><br><span class="line"><span class="comment">// æ‰§è¡Œ SQL è¯­å¥</span></span><br><span class="line">db.<span class="title function_">query</span>(sqlStr, [student.<span class="property">Sno</span>, student.<span class="property">name</span>, student.<span class="property">age</span>, student.<span class="property">sex</span>], <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// æ‰§è¡Œ SQL è¯­å¥å¤±è´¥äº†</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(err.<span class="property">message</span>)</span><br><span class="line">  <span class="comment">// æˆåŠŸäº†</span></span><br><span class="line">  <span class="comment">// æ³¨æ„ï¼šå¦‚æœæ‰§è¡Œçš„æ˜¯ insert into æ’å…¥è¯­å¥ï¼Œåˆ™ results æ˜¯ä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line">  <span class="comment">// å¯ä»¥é€šè¿‡ affectedRows å±æ€§ï¼Œæ¥åˆ¤æ–­æ˜¯å¦æ’å…¥æ•°æ®æˆåŠŸ</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">affectedRows</span> === <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;æ’å…¥æ•°æ®æˆåŠŸ!&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h5 id="æ’å…¥æ•°æ®çš„ä¾¿æ·æ–¹å¼"><a href="#æ’å…¥æ•°æ®çš„ä¾¿æ·æ–¹å¼" class="headerlink" title="æ’å…¥æ•°æ®çš„ä¾¿æ·æ–¹å¼"></a>æ’å…¥æ•°æ®çš„ä¾¿æ·æ–¹å¼</h5><blockquote>
<p>å‘è¡¨ä¸­æ–°å¢æ•°æ®æ—¶ï¼Œå¦‚æœæ•°æ®å¯¹è±¡çš„æ¯ä¸ªå±æ€§å’Œæ•°æ®è¡¨çš„å­—æ®µä¸€ä¸€å¯¹åº”ï¼Œåˆ™å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼å¿«é€Ÿæ’å…¥æ•°æ®ï¼š</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ¼”ç¤ºæ’å…¥æ•°æ®çš„ä¾¿æ·æ–¹å¼</span></span><br><span class="line"><span class="keyword">const</span> student = &#123; <span class="title class_">Sno</span>: <span class="string">&#x27;2021304491&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;B&#x27;</span>, <span class="attr">age</span>: <span class="number">20</span>, <span class="attr">sex</span>: <span class="string">&#x27;ç”·&#x27;</span>&#125;</span><br><span class="line"><span class="comment">// å®šä¹‰å¾…æ‰§è¡Œçš„ SQL è¯­å¥</span></span><br><span class="line"><span class="keyword">const</span> sqlStr = <span class="string">&#x27;insert into student set ?&#x27;</span></span><br><span class="line"><span class="comment">// æ‰§è¡Œ SQL è¯­å¥</span></span><br><span class="line">db.<span class="title function_">query</span>(sqlStr, student, <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(err.<span class="property">message</span>)</span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">affectedRows</span> === <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;æ’å…¥æ•°æ®æˆåŠŸ!&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h5 id="æ›´æ–°æ•°æ®"><a href="#æ›´æ–°æ•°æ®" class="headerlink" title="æ›´æ–°æ•°æ®"></a>æ›´æ–°æ•°æ®</h5><blockquote>
<p>å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼ï¼Œæ›´æ–°è¡¨ä¸­çš„æ•°æ®ï¼š</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ¼”ç¤ºå¦‚ä½•æ›´æ–°ç”¨æˆ·çš„ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">const</span> student = &#123; <span class="title class_">Sno</span>: <span class="string">&#x27;2021304491&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;B&#x27;</span>, <span class="attr">age</span>: <span class="number">21</span>, <span class="attr">sex</span>: <span class="string">&#x27;ç”·&#x27;</span>&#125;</span><br><span class="line"><span class="comment">// å®šä¹‰ SQL è¯­å¥</span></span><br><span class="line"><span class="keyword">const</span> sqlStr = <span class="string">&#x27;update student set name=?, age=?,sex=? where Sno=?&#x27;</span></span><br><span class="line"><span class="comment">// æ‰§è¡Œ SQL è¯­å¥ã€æ­¤å¤„çš„ values ä¸ä¸Šé¢çš„ sql è¯­å¥ éœ€è¦ä¸€è‡´ã€‘</span></span><br><span class="line">db.<span class="title function_">query</span>(sqlStr, [student.<span class="property">name</span>, student.<span class="property">age</span>, student.<span class="property">sex</span>, student.<span class="property">Sno</span>], <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (err)</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(err.<span class="property">message</span>)</span><br><span class="line">  <span class="comment">// æ³¨æ„ï¼šæ‰§è¡Œäº† update è¯­å¥ä¹‹åï¼Œæ‰§è¡Œçš„ç»“æœï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡ affectedRows åˆ¤æ–­æ˜¯å¦æ›´æ–°æˆåŠŸ</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">affectedRows</span> === <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;æ›´æ–°æˆåŠŸ!&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>





<h5 id="æ›´æ–°æ•°æ®çš„ä¾¿æ·æ–¹å¼"><a href="#æ›´æ–°æ•°æ®çš„ä¾¿æ·æ–¹å¼" class="headerlink" title="æ›´æ–°æ•°æ®çš„ä¾¿æ·æ–¹å¼"></a>æ›´æ–°æ•°æ®çš„ä¾¿æ·æ–¹å¼</h5><blockquote>
<p>æ›´æ–°è¡¨æ•°æ®æ—¶ï¼Œå¦‚æœæ•°æ®å¯¹è±¡çš„æ¯ä¸ªå±æ€§å’Œæ•°æ®è¡¨çš„å­—æ®µä¸€ä¸€å¯¹åº”ï¼Œåˆ™å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼å¿«é€Ÿæ›´æ–°è¡¨æ•°æ®ï¼š</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ¼”ç¤ºæ›´æ–°æ•°æ®çš„ä¾¿æ·æ–¹å¼</span></span><br><span class="line"><span class="keyword">const</span> student = &#123; <span class="title class_">Sno</span>: <span class="string">&#x27;2021304491&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;B&#x27;</span>, <span class="attr">age</span>: <span class="number">22</span>, <span class="attr">sex</span>: <span class="string">&#x27;ç”·&#x27;</span>&#125;</span><br><span class="line"><span class="comment">// å®šä¹‰ SQL è¯­å¥</span></span><br><span class="line"><span class="keyword">const</span> sqlStr = <span class="string">&#x27;update student set ? where Sno=?&#x27;</span></span><br><span class="line"><span class="comment">// æ‰§è¡Œ SQL è¯­å¥</span></span><br><span class="line">db.<span class="title function_">query</span>(sqlStr, [student, student.<span class="property">Sno</span>], <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (err)</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(err.<span class="property">message</span>)</span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">affectedRows</span> === <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;æ›´æ–°æ•°æ®æˆåŠŸ&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h5 id="åˆ é™¤æ•°æ®"><a href="#åˆ é™¤æ•°æ®" class="headerlink" title="åˆ é™¤æ•°æ®"></a>åˆ é™¤æ•°æ®</h5><blockquote>
<p>åœ¨åˆ é™¤æ•°æ®æ—¶ï¼Œæ¨èæ ¹æ® id è¿™æ ·çš„å”¯ä¸€æ ‡è¯†ï¼Œæ¥åˆ é™¤å¯¹åº”çš„æ•°æ®ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ é™¤ Sno ä¸º 2021304491 çš„ç”¨æˆ·</span></span><br><span class="line"><span class="keyword">const</span> sqlStr = <span class="string">&#x27;delete from student where Sno=?&#x27;</span></span><br><span class="line">db.<span class="title function_">query</span>(sqlStr, <span class="string">&#x27;2021304491&#x27;</span>, <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (err)</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(err.<span class="property">message</span>)</span><br><span class="line">  <span class="comment">// æ³¨æ„ï¼šæ‰§è¡Œ delete è¯­å¥ä¹‹åï¼Œç»“æœä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä¹Ÿä¼šåŒ…å« affectedRows å±æ€§</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">affectedRows</span> === <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;åˆ é™¤æ•°æ®æˆåŠŸ&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h5 id="æ ‡è®°åˆ é™¤"><a href="#æ ‡è®°åˆ é™¤" class="headerlink" title="æ ‡è®°åˆ é™¤"></a>æ ‡è®°åˆ é™¤</h5><blockquote>
<p>ä½¿ç”¨ DELETE è¯­å¥ï¼Œä¼šæŠŠçœŸæ­£çš„æŠŠæ•°æ®ä»è¡¨ä¸­åˆ é™¤æ‰ã€‚ä¸ºäº†ä¿é™©èµ·è§ï¼Œæ¨èä½¿ç”¨æ ‡è®°åˆ é™¤çš„å½¢å¼ï¼Œæ¥æ¨¡æ‹Ÿåˆ é™¤çš„åŠ¨ä½œã€‚ æ‰€è°“çš„æ ‡è®°åˆ é™¤ï¼Œå°±æ˜¯åœ¨è¡¨ä¸­è®¾ç½®ç±»ä¼¼äº status è¿™æ ·çš„çŠ¶æ€å­—æ®µï¼Œæ¥æ ‡è®°å½“å‰è¿™æ¡æ•°æ®æ˜¯å¦è¢«åˆ é™¤ã€‚ å½“ç”¨æˆ·æ‰§è¡Œäº†åˆ é™¤çš„åŠ¨ä½œæ—¶ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰æ‰§è¡Œ DELETE è¯­å¥æŠŠæ•°æ®åˆ é™¤æ‰ï¼Œè€Œæ˜¯æ‰§è¡Œäº† UPDATE è¯­å¥ï¼Œå°†è¿™æ¡æ•°æ®å¯¹åº” çš„ status å­—æ®µæ ‡è®°ä¸ºåˆ é™¤å³å¯ã€‚</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ ‡è®°åˆ é™¤ã€ä¼ªåˆ é™¤ã€‘</span></span><br><span class="line"><span class="keyword">const</span> sqlStr = <span class="string">&#x27;update student set status=? where Sno=?&#x27;</span></span><br><span class="line">db.<span class="title function_">query</span>(sqlStr, [<span class="number">1</span>,<span class="string">&#x27;2021304491&#x27;</span>], <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) </span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(err.<span class="property">message</span>)</span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">affectedRows</span> === <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;æ ‡è®°åˆ é™¤æˆåŠŸ&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>





<h3 id="å‰åç«¯çš„èº«ä»½è®¤è¯"><a href="#å‰åç«¯çš„èº«ä»½è®¤è¯" class="headerlink" title="å‰åç«¯çš„èº«ä»½è®¤è¯"></a>å‰åç«¯çš„èº«ä»½è®¤è¯</h3><h4 id="Web-å¼€å‘æ¨¡å¼"><a href="#Web-å¼€å‘æ¨¡å¼" class="headerlink" title="Web å¼€å‘æ¨¡å¼"></a>Web å¼€å‘æ¨¡å¼</h4><blockquote>
<p>ç›®å‰ä¸»æµçš„ Web å¼€å‘æ¨¡å¼æœ‰ä¸¤ç§ï¼Œåˆ†åˆ«æ˜¯ï¼š </p>
<ol>
<li>åŸºäºæœåŠ¡ç«¯æ¸²æŸ“çš„ä¼ ç»Ÿ Web å¼€å‘æ¨¡å¼</li>
<li>åŸºäºå‰åç«¯åˆ†ç¦»çš„æ–°å‹ Web å¼€å‘æ¨¡å¼</li>
</ol>
</blockquote>
<h5 id="æœåŠ¡ç«¯æ¸²æŸ“çš„-Web-å¼€å‘æ¨¡å¼"><a href="#æœåŠ¡ç«¯æ¸²æŸ“çš„-Web-å¼€å‘æ¨¡å¼" class="headerlink" title="æœåŠ¡ç«¯æ¸²æŸ“çš„ Web å¼€å‘æ¨¡å¼"></a>æœåŠ¡ç«¯æ¸²æŸ“çš„ Web å¼€å‘æ¨¡å¼</h5><blockquote>
<p>æœåŠ¡ç«¯æ¸²æŸ“çš„æ¦‚å¿µï¼šæœåŠ¡å™¨å‘é€ç»™å®¢æˆ·ç«¯çš„ HTML é¡µé¢ï¼Œæ˜¯åœ¨æœåŠ¡å™¨é€šè¿‡å­—ç¬¦ä¸²çš„æ‹¼æ¥ï¼ŒåŠ¨æ€ç”Ÿæˆçš„ã€‚å› æ­¤ï¼Œå®¢æˆ·ç«¯ä¸ éœ€è¦ä½¿ç”¨ Ajax è¿™æ ·çš„æŠ€æœ¯é¢å¤–è¯·æ±‚é¡µé¢çš„æ•°æ®ã€‚ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">``</span><span class="string">`</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">##### æœåŠ¡ç«¯æ¸²æŸ“çš„ä¼˜ç¼ºç‚¹</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&gt; ä¼˜ç‚¹ï¼š â‘  </span></span><br><span class="line"><span class="string">&gt;</span></span><br><span class="line"><span class="string">&gt; 1. å‰ç«¯è€—æ—¶å°‘ã€‚å› ä¸ºæœåŠ¡å™¨ç«¯è´Ÿè´£åŠ¨æ€ç”Ÿæˆ HTML å†…å®¹ï¼Œæµè§ˆå™¨åªéœ€è¦ç›´æ¥æ¸²æŸ“é¡µé¢å³å¯ã€‚å°¤å…¶æ˜¯ç§»åŠ¨ç«¯ï¼Œæ›´çœç”µã€‚</span></span><br><span class="line"><span class="string">&gt; 2. æœ‰åˆ©äºSEOã€‚å› ä¸ºæœåŠ¡å™¨ç«¯å“åº”çš„æ˜¯å®Œæ•´çš„ HTML é¡µé¢å†…å®¹ï¼Œæ‰€ä»¥çˆ¬è™«æ›´å®¹æ˜“çˆ¬å–è·å¾—ä¿¡æ¯ï¼Œæ›´æœ‰åˆ©äº SEOã€‚</span></span><br><span class="line"><span class="string">&gt;</span></span><br><span class="line"><span class="string">&gt;  ç¼ºç‚¹ï¼š â‘  </span></span><br><span class="line"><span class="string">&gt;</span></span><br><span class="line"><span class="string">&gt; 1. å ç”¨æœåŠ¡å™¨ç«¯èµ„æºã€‚å³æœåŠ¡å™¨ç«¯å®Œæˆ HTML é¡µé¢å†…å®¹çš„æ‹¼æ¥ï¼Œå¦‚æœè¯·æ±‚è¾ƒå¤šï¼Œä¼šå¯¹æœåŠ¡å™¨é€ æˆä¸€å®šçš„è®¿é—®å‹åŠ›ã€‚</span></span><br><span class="line"><span class="string">&gt; 2. ä¸åˆ©äºå‰åç«¯åˆ†ç¦»ï¼Œå¼€å‘æ•ˆç‡ä½ã€‚ä½¿ç”¨æœåŠ¡å™¨ç«¯æ¸²æŸ“ï¼Œåˆ™æ— æ³•è¿›è¡Œåˆ†å·¥åˆä½œï¼Œå°¤å…¶å¯¹äºå‰ç«¯å¤æ‚åº¦é«˜çš„é¡¹ç›®ï¼Œä¸åˆ©äº é¡¹ç›®é«˜æ•ˆå¼€å‘ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">##### å‰åç«¯åˆ†ç¦»çš„ Web å¼€å‘æ¨¡å¼</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&gt; å‰åç«¯åˆ†ç¦»çš„æ¦‚å¿µï¼šå‰åç«¯åˆ†ç¦»çš„å¼€å‘æ¨¡å¼ï¼Œä¾èµ–äº Ajax æŠ€æœ¯çš„å¹¿æ³›åº”ç”¨ã€‚ç®€è€Œè¨€ä¹‹ï¼Œå‰åç«¯åˆ†ç¦»çš„ Web å¼€å‘æ¨¡å¼ï¼Œ å°±æ˜¯åç«¯åªè´Ÿè´£æä¾› API æ¥å£ï¼Œå‰ç«¯ä½¿ç”¨ Ajax è°ƒç”¨æ¥å£çš„å¼€å‘æ¨¡å¼ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">##### å‰åç«¯åˆ†ç¦»çš„ä¼˜ç¼ºç‚¹</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&gt; ä¼˜ç‚¹ï¼š </span></span><br><span class="line"><span class="string">&gt;</span></span><br><span class="line"><span class="string">&gt; 1. å¼€å‘ä½“éªŒå¥½ã€‚å‰ç«¯ä¸“æ³¨äº UI é¡µé¢çš„å¼€å‘ï¼Œåç«¯ä¸“æ³¨äºapi çš„å¼€å‘ï¼Œä¸”å‰ç«¯æœ‰æ›´å¤šçš„é€‰æ‹©æ€§ã€‚ </span></span><br><span class="line"><span class="string">&gt; 2. ç”¨æˆ·ä½“éªŒå¥½ã€‚Ajax æŠ€æœ¯çš„å¹¿æ³›åº”ç”¨ï¼Œæå¤§çš„æé«˜äº†ç”¨æˆ·çš„ä½“éªŒï¼Œå¯ä»¥è½»æ¾å®ç°é¡µé¢çš„å±€éƒ¨åˆ·æ–°ã€‚ </span></span><br><span class="line"><span class="string">&gt; 3. å‡è½»äº†æœåŠ¡å™¨ç«¯çš„æ¸²æŸ“å‹åŠ›ã€‚å› ä¸ºé¡µé¢æœ€ç»ˆæ˜¯åœ¨æ¯ä¸ªç”¨æˆ·çš„æµè§ˆå™¨ä¸­ç”Ÿæˆçš„ã€‚</span></span><br><span class="line"><span class="string">&gt;</span></span><br><span class="line"><span class="string">&gt;  ç¼ºç‚¹ï¼š </span></span><br><span class="line"><span class="string">&gt;</span></span><br><span class="line"><span class="string">&gt; 1. ä¸åˆ©äº SEOã€‚å› ä¸ºå®Œæ•´çš„ HTML é¡µé¢éœ€è¦åœ¨å®¢æˆ·ç«¯åŠ¨æ€æ‹¼æ¥å®Œæˆï¼Œæ‰€ä»¥çˆ¬è™«å¯¹æ— æ³•çˆ¬å–é¡µé¢çš„æœ‰æ•ˆä¿¡æ¯ã€‚ï¼ˆè§£å†³æ–¹ æ¡ˆï¼šåˆ©ç”¨ Vueã€React ç­‰å‰ç«¯æ¡†æ¶çš„ SSR ï¼ˆserver side renderï¼‰æŠ€æœ¯èƒ½å¤Ÿå¾ˆå¥½çš„è§£å†³ SEO é—®é¢˜ï¼ï¼‰</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#####  å¦‚ä½•é€‰æ‹© Web å¼€å‘æ¨¡å¼</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&gt; ä¸è°ˆä¸šåŠ¡åœºæ™¯è€Œç›²ç›®é€‰æ‹©ä½¿ç”¨ä½•ç§å¼€å‘æ¨¡å¼éƒ½æ˜¯è€æµæ°“ã€‚</span></span><br><span class="line"><span class="string">&gt;</span></span><br><span class="line"><span class="string">&gt; + æ¯”å¦‚ä¼ä¸šçº§ç½‘ç«™ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å±•ç¤ºè€Œæ²¡æœ‰å¤æ‚çš„äº¤äº’ï¼Œå¹¶ä¸”éœ€è¦è‰¯å¥½çš„ SEOï¼Œåˆ™è¿™æ—¶æˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨æœåŠ¡å™¨ç«¯æ¸²æŸ“ï¼›</span></span><br><span class="line"><span class="string">&gt; + è€Œç±»ä¼¼åå°ç®¡ç†é¡¹ç›®ï¼Œäº¤äº’æ€§æ¯”è¾ƒå¼ºï¼Œä¸éœ€è¦è€ƒè™‘ SEOï¼Œé‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨å‰åç«¯åˆ†ç¦»çš„å¼€å‘æ¨¡å¼ã€‚</span></span><br><span class="line"><span class="string">&gt;</span></span><br><span class="line"><span class="string">&gt; å¦å¤–ï¼Œå…·ä½“ä½¿ç”¨ä½•ç§å¼€å‘æ¨¡å¼å¹¶ä¸æ˜¯ç»å¯¹çš„ï¼Œä¸ºäº†åŒæ—¶å…¼é¡¾äº†é¦–é¡µçš„æ¸²æŸ“é€Ÿåº¦å’Œå‰åç«¯åˆ†ç¦»çš„å¼€å‘æ•ˆç‡ï¼Œä¸€äº›ç½‘ç«™é‡‡ç”¨äº† é¦–å±æœåŠ¡å™¨ç«¯æ¸²æŸ“ + å…¶ä»–é¡µé¢å‰åç«¯åˆ†ç¦»çš„å¼€å‘æ¨¡å¼ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#### èº«ä»½è®¤è¯</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">##### ä»€ä¹ˆæ˜¯èº«ä»½è®¤è¯</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&gt; èº«ä»½è®¤è¯ï¼ˆAuthenticationï¼‰åˆç§°â€œèº«ä»½éªŒè¯â€ã€â€œé‰´æƒâ€ï¼Œæ˜¯æŒ‡é€šè¿‡ä¸€å®šçš„æ‰‹æ®µï¼Œå®Œæˆå¯¹ç”¨æˆ·èº«ä»½çš„ç¡®è®¤ã€‚</span></span><br><span class="line"><span class="string">&gt;</span></span><br><span class="line"><span class="string">&gt; + æ—¥å¸¸ç”Ÿæ´»ä¸­çš„èº«ä»½è®¤è¯éšå¤„å¯è§ï¼Œä¾‹å¦‚ï¼šé«˜é“çš„éªŒç¥¨ä¹˜è½¦ï¼Œæ‰‹æœºçš„å¯†ç æˆ–æŒ‡çº¹è§£é”ï¼Œæ”¯ä»˜å®æˆ–å¾®ä¿¡çš„æ”¯ä»˜å¯†ç ç­‰ã€‚</span></span><br><span class="line"><span class="string">&gt; + åœ¨ Web å¼€å‘ä¸­ï¼Œä¹Ÿæ¶‰åŠåˆ°ç”¨æˆ·èº«ä»½çš„è®¤è¯ï¼Œä¾‹å¦‚ï¼šå„å¤§ç½‘ç«™çš„æ‰‹æœºéªŒè¯ç ç™»å½•ã€é‚®ç®±å¯†ç ç™»å½•ã€äºŒç»´ç ç™»å½•ç­‰ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">##### ä¸ºä»€ä¹ˆéœ€è¦èº«ä»½è®¤è¯</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&gt; èº«ä»½è®¤è¯çš„ç›®çš„ï¼Œæ˜¯ä¸ºäº†ç¡®è®¤å½“å‰æ‰€å£°ç§°ä¸ºæŸç§èº«ä»½çš„ç”¨æˆ·ï¼Œç¡®å®æ˜¯æ‰€å£°ç§°çš„ç”¨æˆ·ã€‚ä¾‹å¦‚ï¼Œä½ å»æ‰¾å¿«é€’å‘˜å–å¿«é€’ï¼Œä½ è¦æ€ ä¹ˆè¯æ˜è¿™ä»½å¿«é€’æ˜¯ä½ çš„ã€‚</span></span><br><span class="line"><span class="string">&gt;</span></span><br><span class="line"><span class="string">&gt; åœ¨äº’è”ç½‘é¡¹ç›®å¼€å‘ä¸­ï¼Œå¦‚ä½•å¯¹ç”¨æˆ·çš„èº«ä»½è¿›è¡Œè®¤è¯ï¼Œæ˜¯ä¸€ä¸ªå€¼å¾—æ·±å…¥æ¢è®¨çš„é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œå¦‚ä½•æ‰èƒ½ä¿è¯ç½‘ç«™ä¸ä¼šé”™è¯¯çš„å°† â€œé©¬äº‘çš„å­˜æ¬¾æ•°é¢â€æ˜¾ç¤ºåˆ°â€œé©¬åŒ–è…¾çš„è´¦æˆ·â€ä¸Šã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">##### ä¸åŒå¼€å‘æ¨¡å¼ä¸‹çš„èº«ä»½è®¤è¯</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&gt; å¯¹äºæœåŠ¡ç«¯æ¸²æŸ“å’Œå‰åç«¯åˆ†ç¦»è¿™ä¸¤ç§å¼€å‘æ¨¡å¼æ¥è¯´ï¼Œåˆ†åˆ«æœ‰ç€ä¸åŒçš„èº«ä»½è®¤è¯æ–¹æ¡ˆï¼š</span></span><br><span class="line"><span class="string">&gt;</span></span><br><span class="line"><span class="string">&gt; 1. æœåŠ¡ç«¯æ¸²æŸ“æ¨èä½¿ç”¨ Session è®¤è¯æœºåˆ¶</span></span><br><span class="line"><span class="string">&gt; 2. å‰åç«¯åˆ†ç¦»æ¨èä½¿ç”¨ JWT è®¤è¯æœºåˆ¶</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#### Session è®¤è¯æœºåˆ¶</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">##### HTTP åè®®çš„æ— çŠ¶æ€æ€§</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&gt; äº†è§£ HTTP åè®®çš„æ— çŠ¶æ€æ€§æ˜¯è¿›ä¸€æ­¥å­¦ä¹  Session è®¤è¯æœºåˆ¶çš„å¿…è¦å‰æã€‚ </span></span><br><span class="line"><span class="string">&gt;</span></span><br><span class="line"><span class="string">&gt; HTTP åè®®çš„æ— çŠ¶æ€æ€§ï¼ŒæŒ‡çš„æ˜¯å®¢æˆ·ç«¯çš„æ¯æ¬¡ HTTP è¯·æ±‚éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œè¿ç»­å¤šä¸ªè¯·æ±‚ä¹‹é—´æ²¡æœ‰ç›´æ¥çš„å…³ç³»ï¼ŒæœåŠ¡å™¨ä¸ä¼š ä¸»åŠ¨ä¿ç•™æ¯æ¬¡ HTTP è¯·æ±‚çš„çŠ¶æ€ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[![pp44LVS.png](./NodeJs.assets/pp44LVS.png)](https://imgse.com/i/pp44LVS)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">##### å¦‚ä½•çªç ´ HTTP æ— çŠ¶æ€çš„é™åˆ¶</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&gt; å¯¹äºè¶…å¸‚æ¥è¯´ï¼Œä¸ºäº†æ–¹ä¾¿æ”¶é“¶å‘˜åœ¨è¿›è¡Œç»“ç®—æ—¶ç»™ VIP ç”¨æˆ·æ‰“æŠ˜ï¼Œè¶…å¸‚å¯ä»¥ä¸ºæ¯ä¸ª VIP ç”¨æˆ·å‘æ”¾ä¼šå‘˜å¡ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[![pp44vCj.png](./NodeJs.assets/pp44vCj.png)](https://imgse.com/i/pp44vCj)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">`</span>æ³¨æ„ï¼šç°å®ç”Ÿæ´»ä¸­çš„ä¼šå‘˜å¡èº«ä»½è®¤è¯æ–¹å¼ï¼Œåœ¨ <span class="title class_">Web</span> å¼€å‘ä¸­çš„ä¸“ä¸šæœ¯è¯­å«åš <span class="title class_">Cookie</span>ã€‚<span class="string">`</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">##### ä»€ä¹ˆæ˜¯ Cookie</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&gt; Cookie æ˜¯å­˜å‚¨åœ¨ç”¨æˆ·æµè§ˆå™¨ä¸­çš„ä¸€æ®µä¸è¶…è¿‡ 4 KB çš„å­—ç¬¦ä¸²ã€‚å®ƒç”±ä¸€ä¸ªåç§°ï¼ˆNameï¼‰ã€ä¸€ä¸ªå€¼ï¼ˆValueï¼‰å’Œå…¶å®ƒå‡ ä¸ªç”¨ äºæ§åˆ¶ Cookie æœ‰æ•ˆæœŸã€å®‰å…¨æ€§ã€ä½¿ç”¨èŒƒå›´çš„å¯é€‰å±æ€§ç»„æˆã€‚ </span></span><br><span class="line"><span class="string">&gt;</span></span><br><span class="line"><span class="string">&gt; ä¸åŒåŸŸåä¸‹çš„ Cookie å„è‡ªç‹¬ç«‹ï¼Œæ¯å½“å®¢æˆ·ç«¯å‘èµ·è¯·æ±‚æ—¶ï¼Œä¼šè‡ªåŠ¨æŠŠå½“å‰åŸŸåä¸‹æ‰€æœ‰æœªè¿‡æœŸçš„ Cookie ä¸€åŒå‘é€åˆ°æœåŠ¡å™¨ã€‚</span></span><br><span class="line"><span class="string">&gt;</span></span><br><span class="line"><span class="string">&gt; Cookieçš„å‡ å¤§ç‰¹æ€§ï¼š</span></span><br><span class="line"><span class="string">&gt;</span></span><br><span class="line"><span class="string">&gt; + è‡ªåŠ¨å‘é€</span></span><br><span class="line"><span class="string">&gt; + åŸŸåç‹¬ç«‹</span></span><br><span class="line"><span class="string">&gt; + è¿‡æœŸæ—¶é™</span></span><br><span class="line"><span class="string">&gt; + 4KB é™åˆ¶</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">##### Cookie åœ¨èº«ä»½è®¤è¯ä¸­çš„ä½œç”¨</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&gt; å®¢æˆ·ç«¯ç¬¬ä¸€æ¬¡è¯·æ±‚æœåŠ¡å™¨çš„æ—¶å€™ï¼ŒæœåŠ¡å™¨é€šè¿‡å“åº”å¤´çš„å½¢å¼ï¼Œå‘å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªèº«ä»½è®¤è¯çš„ Cookieï¼Œå®¢æˆ·ç«¯ä¼šè‡ªåŠ¨ å°† Cookie ä¿å­˜åœ¨æµè§ˆå™¨ä¸­ã€‚</span></span><br><span class="line"><span class="string">&gt;</span></span><br><span class="line"><span class="string">&gt; éšåï¼Œå½“å®¢æˆ·ç«¯æµè§ˆå™¨æ¯æ¬¡è¯·æ±‚æœåŠ¡å™¨çš„æ—¶å€™ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨å°†èº«ä»½è®¤è¯ç›¸å…³çš„ Cookieï¼Œé€šè¿‡è¯·æ±‚å¤´çš„å½¢å¼å‘é€ç»™ æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨å³å¯éªŒæ˜å®¢æˆ·ç«¯çš„èº«ä»½ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[![pp45CrV.png](./NodeJs.assets/pp45CrV.png)](https://imgse.com/i/pp45CrV)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">##### Cookie ä¸å…·æœ‰å®‰å…¨æ€§</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&gt; ç”±äº Cookie æ˜¯å­˜å‚¨åœ¨æµè§ˆå™¨ä¸­çš„ï¼Œè€Œä¸”æµè§ˆå™¨ä¹Ÿæä¾›äº†è¯»å†™ Cookie çš„ APIï¼Œå› æ­¤ Cookie å¾ˆå®¹æ˜“è¢«ä¼ªé€ ï¼Œä¸å…·æœ‰å®‰å…¨ æ€§ã€‚å› æ­¤ä¸å»ºè®®æœåŠ¡å™¨å°†é‡è¦çš„éšç§æ•°æ®ï¼Œé€šè¿‡ Cookie çš„å½¢å¼å‘é€ç»™æµè§ˆå™¨ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[![pp45kaF.png](./NodeJs.assets/pp45kaF.png)](https://imgse.com/i/pp45kaF)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">`</span>æ³¨æ„ï¼šåƒä¸‡ä¸è¦ä½¿ç”¨ <span class="title class_">Cookie</span> å­˜å‚¨é‡è¦ä¸”éšç§çš„æ•°æ®ï¼æ¯”å¦‚ç”¨æˆ·çš„èº«ä»½ä¿¡æ¯ã€å¯†ç ç­‰ã€‚<span class="string">`</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">##### æé«˜èº«ä»½è®¤è¯çš„å®‰å…¨æ€§</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&gt; ä¸ºäº†é˜²æ­¢å®¢æˆ·ä¼ªé€ ä¼šå‘˜å¡ï¼Œæ”¶é“¶å‘˜åœ¨æ‹¿åˆ°å®¢æˆ·å‡ºç¤ºçš„ä¼šå‘˜å¡ä¹‹åï¼Œå¯ä»¥åœ¨æ”¶é“¶æœºä¸Šè¿›è¡Œåˆ·å¡è®¤è¯ã€‚åªæœ‰æ”¶é“¶æœºç¡®è®¤å­˜åœ¨çš„ ä¼šå‘˜å¡ï¼Œæ‰èƒ½è¢«æ­£å¸¸ä½¿ç”¨ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[![pp4xcAs.png](./NodeJs.assets/pp4xcAs.png)](https://imgse.com/i/pp4xcAs)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#####  Session çš„å·¥ä½œåŸç†</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&gt; 1. å½“ä¸€ä¸ªsessionç¬¬ä¸€æ¬¡è¢«å¯ç”¨æ—¶ï¼Œä¸€ä¸ªç‹¬ä¸€çš„æ ‡è¯†è¢«å­˜å‚¨äºæœ¬åœ°çš„[cookie](https://baike.baidu.com/item/cookie/1119?fromModule=lemma_inlink)ä¸­ã€‚</span></span><br><span class="line"><span class="string">&gt; 2. é¦–å…ˆä½¿ç”¨session_start()å‡½æ•°ï¼Œ[PHP](https://baike.baidu.com/item/PHP/9337?fromModule=lemma_inlink)ä»sessionä»“åº“ä¸­åŠ è½½å·²ç»å­˜å‚¨çš„sessionå˜é‡ã€‚</span></span><br><span class="line"><span class="string">&gt; 3. å½“æ‰§è¡ŒPHPè„šæœ¬æ—¶ï¼Œé€šè¿‡ä½¿ç”¨session_register()å‡½æ•°æ³¨å†Œsessionå˜é‡ã€‚</span></span><br><span class="line"><span class="string">&gt; 4. å½“PHPè„šæœ¬æ‰§è¡Œç»“æŸæ—¶ï¼Œæœªè¢«é”€æ¯çš„sessionå˜é‡ä¼šè¢«[è‡ªåŠ¨ä¿å­˜](https://baike.baidu.com/item/è‡ªåŠ¨ä¿å­˜/3766727?fromModule=lemma_inlink)åœ¨æœ¬åœ°ä¸€å®šè·¯å¾„ä¸‹çš„sessionåº“ä¸­ï¼Œè¿™ä¸ªè·¯å¾„å¯ä»¥é€šè¿‡php.[iniæ–‡ä»¶](https://baike.baidu.com/item/iniæ–‡ä»¶/9718973?fromModule=lemma_inlink)ä¸­çš„session.save_pathæŒ‡å®šï¼Œä¸‹æ¬¡æµè§ˆç½‘é¡µæ—¶å¯ä»¥åŠ è½½ä½¿ç”¨ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[![pp4x2hq.png](./NodeJs.assets/pp4x2hq.png)](https://imgse.com/i/pp4x2hq)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#### åœ¨ Express ä¸­ä½¿ç”¨ Session è®¤è¯</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">##### å®‰è£… express-session ä¸­é—´ä»¶</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&gt; åœ¨ Express é¡¹ç›®ä¸­ï¼Œåªéœ€è¦å®‰è£… express-session ä¸­é—´ä»¶ï¼Œå³å¯åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ Session è®¤è¯ï¼š</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>bash</span><br><span class="line">npm install express-session</span><br></pre></td></tr></table></figure>



<h5 id="é…ç½®-express-session-ä¸­é—´ä»¶"><a href="#é…ç½®-express-session-ä¸­é—´ä»¶" class="headerlink" title="é…ç½® express-session ä¸­é—´ä»¶"></a>é…ç½® express-session ä¸­é—´ä»¶</h5><blockquote>
<p>express-session ä¸­é—´ä»¶å®‰è£…æˆåŠŸåï¼Œéœ€è¦é€šè¿‡ app.use() æ¥æ³¨å†Œ session ä¸­é—´ä»¶ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥ session ä¸­é—´ä»¶</span></span><br><span class="line"><span class="keyword">var</span> session = <span class="built_in">require</span>(<span class="string">&#x27;express-session&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// é…ç½® session ä¸­é—´ä»¶</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">session</span>(&#123;</span><br><span class="line">    <span class="comment">// secret å±æ€§çš„å€¼å¯ä»¥ä¸ºä»»æ„å­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="attr">secret</span>: <span class="string">&#x27;ache&#x27;</span>,</span><br><span class="line">    <span class="comment">// å›ºå®šå†™æ³•</span></span><br><span class="line">    <span class="attr">resave</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="comment">// å›ºå®šå†™æ³•</span></span><br><span class="line">    <span class="attr">saveUninitialized</span>: <span class="literal">true</span></span><br><span class="line">&#125;))</span><br></pre></td></tr></table></figure>





<h5 id="å‘-session-ä¸­å­˜æ•°æ®"><a href="#å‘-session-ä¸­å­˜æ•°æ®" class="headerlink" title="å‘ session ä¸­å­˜æ•°æ®"></a>å‘ session ä¸­å­˜æ•°æ®</h5><blockquote>
<p>å½“ express-session ä¸­é—´ä»¶é…ç½®æˆåŠŸåï¼Œå³å¯é€šè¿‡ req.session æ¥è®¿é—®å’Œä½¿ç”¨ session å¯¹è±¡ï¼Œä»è€Œå­˜å‚¨ç”¨æˆ·çš„å…³é”®ä¿¡æ¯ï¼š</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç™»å½•çš„ API æ¥å£</span></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/api/login&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// åˆ¤æ–­ç”¨æˆ·æäº¤çš„ç™»å½•ä¿¡æ¯æ˜¯å¦æ­£ç¡®</span></span><br><span class="line">  <span class="keyword">if</span> (req.<span class="property">body</span>.<span class="property">username</span> !== <span class="string">&#x27;admin&#x27;</span> || req.<span class="property">body</span>.<span class="property">password</span> !== <span class="string">&#x27;000000&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">send</span>(&#123; <span class="attr">status</span>: <span class="number">1</span>, <span class="attr">msg</span>: <span class="string">&#x27;ç™»å½•å¤±è´¥&#x27;</span> &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// TODO_02ï¼šè¯·å°†ç™»å½•æˆåŠŸåçš„ç”¨æˆ·ä¿¡æ¯ï¼Œä¿å­˜åˆ° Session ä¸­</span></span><br><span class="line">  <span class="comment">// æ³¨æ„ï¼šåªæœ‰æˆåŠŸé…ç½®äº† express-session è¿™ä¸ªä¸­é—´ä»¶ä¹‹åï¼Œæ‰èƒ½å¤Ÿé€šè¿‡ req ç‚¹å‡ºæ¥ session è¿™ä¸ªå±æ€§</span></span><br><span class="line">  req.<span class="property">session</span>.<span class="property">user</span> = req.<span class="property">body</span> <span class="comment">// ç”¨æˆ·çš„ä¿¡æ¯</span></span><br><span class="line">  req.<span class="property">session</span>.<span class="property">islogin</span> = <span class="literal">true</span> <span class="comment">// ç”¨æˆ·çš„ç™»å½•çŠ¶æ€</span></span><br><span class="line"></span><br><span class="line">  res.<span class="title function_">send</span>(&#123; <span class="attr">status</span>: <span class="number">0</span>, <span class="attr">msg</span>: <span class="string">&#x27;ç™»å½•æˆåŠŸ&#x27;</span> &#125;)</span><br><span class="line"></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>





<h5 id="ä»-session-ä¸­å–æ•°æ®"><a href="#ä»-session-ä¸­å–æ•°æ®" class="headerlink" title="ä» session ä¸­å–æ•°æ®"></a>ä» session ä¸­å–æ•°æ®</h5><blockquote>
<p>å¯ä»¥ç›´æ¥ä» req.session å¯¹è±¡ä¸Šè·å–ä¹‹å‰å­˜å‚¨çš„æ•°æ®ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è·å–ç”¨æˆ·å§“åçš„æ¥å£</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/api/username&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// TODO_03ï¼šè¯·ä» Session ä¸­è·å–ç”¨æˆ·çš„åç§°ï¼Œå“åº”ç»™å®¢æˆ·ç«¯</span></span><br><span class="line">  <span class="keyword">if</span> (!req.<span class="property">session</span>.<span class="property">islogin</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">send</span>(&#123; <span class="attr">status</span>: <span class="number">1</span>, <span class="attr">msg</span>: <span class="string">&#x27;fail&#x27;</span> &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  res.<span class="title function_">send</span>(&#123;</span><br><span class="line">    <span class="attr">status</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">msg</span>: <span class="string">&#x27;success&#x27;</span>,</span><br><span class="line">    <span class="attr">username</span>: req.<span class="property">session</span>.<span class="property">user</span>.<span class="property">username</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>





<h5 id="æ¸…ç©º-session"><a href="#æ¸…ç©º-session" class="headerlink" title="æ¸…ç©º session"></a>æ¸…ç©º session</h5><blockquote>
<p>è°ƒç”¨ req.session.destroy() å‡½æ•°ï¼Œå³å¯æ¸…ç©ºæœåŠ¡å™¨ä¿å­˜çš„ session ä¿¡æ¯ã€‚</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é€€å‡ºç™»å½•çš„æ¥å£</span></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/api/logout&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// TODO_04ï¼šæ¸…ç©º Session ä¿¡æ¯</span></span><br><span class="line">  req.<span class="property">session</span>.<span class="title function_">destroy</span>()</span><br><span class="line">  res.<span class="title function_">send</span>(&#123;</span><br><span class="line">    <span class="attr">status</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">msg</span>: <span class="string">&#x27;é€€å‡ºç™»å½•æˆåŠŸ&#x27;</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>





<h4 id="JWT-è®¤è¯æœºåˆ¶"><a href="#JWT-è®¤è¯æœºåˆ¶" class="headerlink" title="JWT è®¤è¯æœºåˆ¶"></a>JWT è®¤è¯æœºåˆ¶</h4><h5 id="äº†è§£-Session-è®¤è¯çš„å±€é™æ€§"><a href="#äº†è§£-Session-è®¤è¯çš„å±€é™æ€§" class="headerlink" title="äº†è§£ Session è®¤è¯çš„å±€é™æ€§"></a>äº†è§£ Session è®¤è¯çš„å±€é™æ€§</h5><blockquote>
<p>Session è®¤è¯æœºåˆ¶éœ€è¦é…åˆ Cookie æ‰èƒ½å®ç°ã€‚ç”±äº Cookie é»˜è®¤ä¸æ”¯æŒè·¨åŸŸè®¿é—®ï¼Œæ‰€ä»¥ï¼Œå½“æ¶‰åŠåˆ°<strong>å‰ç«¯è·¨åŸŸè¯·æ±‚åç«¯ å£</strong>çš„æ—¶å€™ï¼Œéœ€è¦åšå¾ˆå¤šé¢å¤–çš„é…ç½®ï¼Œæ‰èƒ½å®ç°è·¨åŸŸ Session è®¤è¯ã€‚</p>
<p>æ³¨æ„ï¼š</p>
<ul>
<li>å½“å‰ç«¯è¯·æ±‚åç«¯æ¥å£ä¸å­˜åœ¨è·¨åŸŸé—®é¢˜çš„æ—¶å€™ï¼Œæ¨èä½¿ç”¨ Session èº«ä»½è®¤è¯æœºåˆ¶ã€‚</li>
<li>å½“å‰ç«¯éœ€è¦è·¨åŸŸè¯·æ±‚åç«¯æ¥å£çš„æ—¶å€™ï¼Œä¸æ¨èä½¿ç”¨ Session èº«ä»½è®¤è¯æœºåˆ¶ï¼Œæ¨èä½¿ç”¨ JWT è®¤è¯æœºåˆ¶ã€‚</li>
</ul>
</blockquote>
<h5 id="ä»€ä¹ˆæ˜¯-JWT"><a href="#ä»€ä¹ˆæ˜¯-JWT" class="headerlink" title="ä»€ä¹ˆæ˜¯ JWT"></a>ä»€ä¹ˆæ˜¯ JWT</h5><blockquote>
<p>JWTï¼ˆè‹±æ–‡å…¨ç§°ï¼šJSON Web Tokenï¼‰æ˜¯ç›®å‰æœ€æµè¡Œçš„è·¨åŸŸè®¤è¯è§£å†³æ–¹æ¡ˆã€‚</p>
</blockquote>
<h5 id="JWT-çš„å·¥ä½œåŸç†"><a href="#JWT-çš„å·¥ä½œåŸç†" class="headerlink" title="JWT çš„å·¥ä½œåŸç†"></a>JWT çš„å·¥ä½œåŸç†</h5><blockquote>
<p>æ€»ç»“ï¼šç”¨æˆ·çš„ä¿¡æ¯é€šè¿‡ Token å­—ç¬¦ä¸²çš„å½¢å¼ï¼Œä¿å­˜åœ¨å®¢æˆ·ç«¯æµè§ˆå™¨ä¸­ã€‚æœåŠ¡å™¨é€šè¿‡è¿˜åŸ Token å­—ç¬¦ä¸²çš„å½¢å¼æ¥è®¤è¯ç”¨æˆ·çš„èº«ä»½ã€‚</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pp4xW90"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/./NodeJs.assets/pp4xW90.png" alt="pp4xW90.png"></a></p>
<h5 id="JWT-çš„ç»„æˆéƒ¨åˆ†"><a href="#JWT-çš„ç»„æˆéƒ¨åˆ†" class="headerlink" title="JWT çš„ç»„æˆéƒ¨åˆ†"></a>JWT çš„ç»„æˆéƒ¨åˆ†</h5><blockquote>
<p>JWT é€šå¸¸ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼Œåˆ†åˆ«æ˜¯ Headerï¼ˆå¤´éƒ¨ï¼‰ã€Payloadï¼ˆæœ‰æ•ˆè·è½½ï¼‰ã€Signatureï¼ˆç­¾åï¼‰ã€‚ ä¸‰è€…ä¹‹é—´ä½¿ç”¨è‹±æ–‡çš„â€œ.â€åˆ†éš”ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Header</span>.<span class="property">Payload</span>.<span class="property">Singnature</span></span><br></pre></td></tr></table></figure>



<h5 id="JWT-çš„ä¸‰ä¸ªéƒ¨åˆ†å„è‡ªä»£è¡¨çš„å«ä¹‰"><a href="#JWT-çš„ä¸‰ä¸ªéƒ¨åˆ†å„è‡ªä»£è¡¨çš„å«ä¹‰" class="headerlink" title="JWT çš„ä¸‰ä¸ªéƒ¨åˆ†å„è‡ªä»£è¡¨çš„å«ä¹‰"></a>JWT çš„ä¸‰ä¸ªéƒ¨åˆ†å„è‡ªä»£è¡¨çš„å«ä¹‰</h5><blockquote>
<p>JWT çš„ä¸‰ä¸ªç»„æˆéƒ¨åˆ†ï¼Œä»å‰åˆ°ååˆ†åˆ«æ˜¯ Headerã€Payloadã€Signatureã€‚</p>
<p> å…¶ä¸­ï¼š</p>
<ol>
<li><strong>Payload éƒ¨åˆ†æ‰æ˜¯çœŸæ­£çš„ç”¨æˆ·ä¿¡æ¯</strong>ï¼Œå®ƒæ˜¯ç”¨æˆ·ä¿¡æ¯ç»è¿‡åŠ å¯†ä¹‹åç”Ÿæˆçš„å­—ç¬¦ä¸²ã€‚</li>
<li>Header å’Œ Signature æ˜¯<strong>å®‰å…¨æ€§ç›¸å…³</strong>çš„éƒ¨åˆ†ï¼Œåªæ˜¯ä¸ºäº†ä¿è¯ Token çš„å®‰å…¨æ€§ã€‚</li>
</ol>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pp4xhcT"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/blog/./NodeJs.assets/pp4xhcT.png" alt="pp4xhcT.png"></a></p>
<h5 id="JWT-çš„ä½¿ç”¨æ–¹å¼"><a href="#JWT-çš„ä½¿ç”¨æ–¹å¼" class="headerlink" title="JWT çš„ä½¿ç”¨æ–¹å¼"></a>JWT çš„ä½¿ç”¨æ–¹å¼</h5><blockquote>
<p>å®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡å™¨è¿”å›çš„ JWT ä¹‹åï¼Œé€šå¸¸ä¼šå°†å®ƒå‚¨å­˜åœ¨ localStorage æˆ– sessionStorage ä¸­ã€‚ </p>
<p>æ­¤åï¼Œå®¢æˆ·ç«¯æ¯æ¬¡ä¸æœåŠ¡å™¨é€šä¿¡ï¼Œéƒ½è¦å¸¦ä¸Šè¿™ä¸ª JWT çš„å­—ç¬¦ä¸²ï¼Œä»è€Œè¿›è¡Œèº«ä»½è®¤è¯ã€‚æ¨èçš„åšæ³•æ˜¯æŠŠ JWT æ”¾åœ¨ HTTP  è¯·æ±‚å¤´çš„ Authorization å­—æ®µä¸­ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Authorization</span>: <span class="title class_">Bearer</span> &lt;token&gt;</span><br></pre></td></tr></table></figure>





<h4 id="åœ¨-Express-ä¸­ä½¿ç”¨-JWT"><a href="#åœ¨-Express-ä¸­ä½¿ç”¨-JWT" class="headerlink" title="åœ¨ Express ä¸­ä½¿ç”¨ JWT"></a>åœ¨ Express ä¸­ä½¿ç”¨ JWT</h4><h5 id="å®‰è£…-JWT-ç›¸å…³çš„åŒ…"><a href="#å®‰è£…-JWT-ç›¸å…³çš„åŒ…" class="headerlink" title="å®‰è£… JWT ç›¸å…³çš„åŒ…"></a>å®‰è£… JWT ç›¸å…³çš„åŒ…</h5><blockquote>
<p>è¿è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå®‰è£…å¦‚ä¸‹ä¸¤ä¸ª JWT ç›¸å…³çš„åŒ…ï¼š</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install jsonwebtoken express-jwt</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å…¶ä¸­ï¼š</p>
<ul>
<li>jsonwebtoken ç”¨äºç”Ÿæˆ JWT å­—ç¬¦ä¸²</li>
<li>express-jwt ç”¨äºå°† JWT å­—ç¬¦ä¸²è§£æè¿˜åŸæˆ JSON å¯¹è±¡</li>
</ul>
</blockquote>
<h5 id="å¯¼å…¥-JWT-ç›¸å…³çš„åŒ…"><a href="#å¯¼å…¥-JWT-ç›¸å…³çš„åŒ…" class="headerlink" title="å¯¼å…¥ JWT ç›¸å…³çš„åŒ…"></a>å¯¼å…¥ JWT ç›¸å…³çš„åŒ…</h5><blockquote>
<p>ä½¿ç”¨ require() å‡½æ•°ï¼Œåˆ†åˆ«å¯¼å…¥ JWT ç›¸å…³çš„ä¸¤ä¸ªåŒ…ï¼š</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®‰è£…å¹¶å¯¼å…¥ JWT ç›¸å…³çš„ä¸¤ä¸ªåŒ…ï¼Œåˆ†åˆ«æ˜¯ jsonwebtoken å’Œ express-jwt</span></span><br><span class="line"><span class="keyword">const</span> jwt = <span class="built_in">require</span>(<span class="string">&#x27;jsonwebtoken&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> expressJWT = <span class="built_in">require</span>(<span class="string">&#x27;express-jwt&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h5 id="å®šä¹‰-secret-å¯†é’¥"><a href="#å®šä¹‰-secret-å¯†é’¥" class="headerlink" title="å®šä¹‰ secret å¯†é’¥"></a>å®šä¹‰ secret å¯†é’¥</h5><blockquote>
<p>ä¸ºäº†ä¿è¯ JWT å­—ç¬¦ä¸²çš„å®‰å…¨æ€§ï¼Œé˜²æ­¢ JWT å­—ç¬¦ä¸²åœ¨ç½‘ç»œä¼ è¾“è¿‡ç¨‹ä¸­è¢«åˆ«äººç ´è§£ï¼Œæˆ‘ä»¬éœ€è¦ä¸“é—¨å®šä¹‰ä¸€ä¸ªç”¨äºåŠ å¯†å’Œè§£å¯† çš„ secret å¯†é’¥ï¼š</p>
<ol>
<li>å½“ç”Ÿæˆ JWT å­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œéœ€è¦ä½¿ç”¨ secret å¯†é’¥å¯¹ç”¨æˆ·çš„ä¿¡æ¯è¿›è¡ŒåŠ å¯†ï¼Œæœ€ç»ˆå¾—åˆ°åŠ å¯†å¥½çš„ JWT å­—ç¬¦ä¸²</li>
<li>å½“æŠŠ JWT å­—ç¬¦ä¸²è§£æè¿˜åŸæˆ JSON å¯¹è±¡çš„æ—¶å€™ï¼Œéœ€è¦ä½¿ç”¨ secret å¯†é’¥è¿›è¡Œè§£å¯†</li>
</ol>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰ secret å¯†é’¥ï¼Œå»ºè®®å°†å¯†é’¥å‘½åä¸º secretKey</span></span><br><span class="line"><span class="keyword">const</span> secretKey = <span class="string">&#x27;ache ^_^&#x27;</span></span><br></pre></td></tr></table></figure>





<h5 id="åœ¨ç™»å½•æˆåŠŸåç”Ÿæˆ-JWT-å­—ç¬¦ä¸²"><a href="#åœ¨ç™»å½•æˆåŠŸåç”Ÿæˆ-JWT-å­—ç¬¦ä¸²" class="headerlink" title="åœ¨ç™»å½•æˆåŠŸåç”Ÿæˆ JWT å­—ç¬¦ä¸²"></a>åœ¨ç™»å½•æˆåŠŸåç”Ÿæˆ JWT å­—ç¬¦ä¸²</h5><blockquote>
<p>è°ƒç”¨ jsonwebtoken åŒ…æä¾›çš„ sign() æ–¹æ³•ï¼Œå°†ç”¨æˆ·çš„ä¿¡æ¯åŠ å¯†æˆ JWT å­—ç¬¦ä¸²ï¼Œå“åº”ç»™å®¢æˆ·ç«¯ï¼š</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç™»å½•æ¥å£</span></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/api/login&#x27;</span>, <span class="keyword">function</span> (<span class="params">req, res</span>) &#123;</span><br><span class="line">  <span class="comment">// å°† req.body è¯·æ±‚ä½“ä¸­çš„æ•°æ®ï¼Œè½¬å­˜ä¸º userinfo å¸¸é‡</span></span><br><span class="line">  <span class="keyword">const</span> userinfo = req.<span class="property">body</span></span><br><span class="line">  <span class="comment">// ç™»å½•å¤±è´¥</span></span><br><span class="line">  <span class="keyword">if</span> (userinfo.<span class="property">username</span> !== <span class="string">&#x27;admin&#x27;</span> || userinfo.<span class="property">password</span> !== <span class="string">&#x27;000000&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">send</span>(&#123;</span><br><span class="line">      <span class="attr">status</span>: <span class="number">400</span>,</span><br><span class="line">      <span class="attr">message</span>: <span class="string">&#x27;ç™»å½•å¤±è´¥ï¼&#x27;</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// ç™»å½•æˆåŠŸ</span></span><br><span class="line">  <span class="comment">// åœ¨ç™»å½•æˆåŠŸä¹‹åï¼Œè°ƒç”¨ jwt.sign() æ–¹æ³•ç”Ÿæˆ JWT å­—ç¬¦ä¸²ã€‚å¹¶é€šè¿‡ token å±æ€§å‘é€ç»™å®¢æˆ·ç«¯</span></span><br><span class="line">  <span class="comment">// å‚æ•°1ï¼šç”¨æˆ·çš„ä¿¡æ¯å¯¹è±¡</span></span><br><span class="line">  <span class="comment">// å‚æ•°2ï¼šåŠ å¯†çš„ç§˜é’¥</span></span><br><span class="line">  <span class="comment">// å‚æ•°3ï¼šé…ç½®å¯¹è±¡ï¼Œå¯ä»¥é…ç½®å½“å‰ token çš„æœ‰æ•ˆæœŸ</span></span><br><span class="line">  <span class="comment">// è®°ä½ï¼šåƒä¸‡ä¸è¦æŠŠå¯†ç åŠ å¯†åˆ° token å­—ç¬¦ä¸­</span></span><br><span class="line">  <span class="keyword">const</span> tokenStr = jwt.<span class="title function_">sign</span>(&#123; <span class="attr">username</span>: userinfo.<span class="property">username</span> &#125;, secretKey, &#123; <span class="attr">expiresIn</span>: <span class="string">&#x27;30s&#x27;</span> &#125;)</span><br><span class="line">  res.<span class="title function_">send</span>(&#123;</span><br><span class="line">    <span class="attr">status</span>: <span class="number">200</span>,</span><br><span class="line">    <span class="attr">message</span>: <span class="string">&#x27;ç™»å½•æˆåŠŸï¼&#x27;</span>,</span><br><span class="line">    <span class="attr">token</span>: tokenStr, <span class="comment">// è¦å‘é€ç»™å®¢æˆ·ç«¯çš„ token å­—ç¬¦ä¸²</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>





<h5 id="å°†-JWT-å­—ç¬¦ä¸²è¿˜åŸä¸º-JSON-å¯¹è±¡"><a href="#å°†-JWT-å­—ç¬¦ä¸²è¿˜åŸä¸º-JSON-å¯¹è±¡" class="headerlink" title="å°† JWT å­—ç¬¦ä¸²è¿˜åŸä¸º JSON å¯¹è±¡"></a>å°† JWT å­—ç¬¦ä¸²è¿˜åŸä¸º JSON å¯¹è±¡</h5><blockquote>
<p>å®¢æˆ·ç«¯æ¯æ¬¡åœ¨è®¿é—®é‚£äº›æœ‰æƒé™æ¥å£çš„æ—¶å€™ï¼Œéƒ½éœ€è¦ä¸»åŠ¨é€šè¿‡è¯·æ±‚å¤´ä¸­çš„ Authorization å­—æ®µï¼Œå°† Token å­—ç¬¦ä¸²å‘ é€åˆ°æœåŠ¡å™¨è¿›è¡Œèº«ä»½è®¤è¯ã€‚ </p>
<p>æ­¤æ—¶ï¼ŒæœåŠ¡å™¨å¯ä»¥é€šè¿‡ express-jwt è¿™ä¸ªä¸­é—´ä»¶ï¼Œè‡ªåŠ¨å°†å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„ Token è§£æè¿˜åŸæˆ JSON å¯¹è±¡ï¼š</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ³¨å†Œå°† JWT å­—ç¬¦ä¸²è§£æè¿˜åŸæˆ JSON å¯¹è±¡çš„ä¸­é—´ä»¶</span></span><br><span class="line"><span class="comment">// æ³¨æ„ï¼šåªè¦é…ç½®æˆåŠŸäº† express-jwt è¿™ä¸ªä¸­é—´ä»¶ï¼Œå°±å¯ä»¥æŠŠè§£æå‡ºæ¥çš„ç”¨æˆ·ä¿¡æ¯ï¼ŒæŒ‚è½½åˆ° req.user å±æ€§ä¸Š</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">expressJWT</span>(&#123; <span class="attr">secret</span>: secretKey &#125;).<span class="title function_">unless</span>(&#123; <span class="attr">path</span>: [<span class="regexp">/^\/api\//</span>] &#125;))</span><br></pre></td></tr></table></figure>

<p><code>åªè¦é…ç½®æˆåŠŸäº† express-jwt è¿™ä¸ªä¸­é—´ä»¶ï¼Œå°±å¯ä»¥æŠŠè§£æå‡ºæ¥çš„ç”¨æˆ·ä¿¡æ¯ï¼ŒæŒ‚è½½åˆ° req.user å±æ€§ä¸Š</code></p>
<h5 id="ä½¿ç”¨-req-user-è·å–ç”¨æˆ·ä¿¡æ¯"><a href="#ä½¿ç”¨-req-user-è·å–ç”¨æˆ·ä¿¡æ¯" class="headerlink" title="ä½¿ç”¨ req.user è·å–ç”¨æˆ·ä¿¡æ¯"></a>ä½¿ç”¨ req.user è·å–ç”¨æˆ·ä¿¡æ¯</h5><blockquote>
<p>å½“ express-jwt è¿™ä¸ªä¸­é—´ä»¶é…ç½®æˆåŠŸä¹‹åï¼Œå³å¯åœ¨é‚£äº›æœ‰æƒé™çš„æ¥å£ä¸­ï¼Œä½¿ç”¨ req.user å¯¹è±¡ï¼Œæ¥è®¿é—®ä» JWT å­—ç¬¦ä¸² ä¸­è§£æå‡ºæ¥çš„ç”¨æˆ·ä¿¡æ¯äº†ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¿™æ˜¯ä¸€ä¸ªæœ‰æƒé™çš„ API æ¥å£</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/admin/getinfo&#x27;</span>, <span class="keyword">function</span> (<span class="params">req, res</span>) &#123;</span><br><span class="line">  <span class="comment">// TODO_05ï¼šä½¿ç”¨ req.user è·å–ç”¨æˆ·ä¿¡æ¯ï¼Œå¹¶ä½¿ç”¨ data å±æ€§å°†ç”¨æˆ·ä¿¡æ¯å‘é€ç»™å®¢æˆ·ç«¯</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">user</span>)</span><br><span class="line">  res.<span class="title function_">send</span>(&#123;</span><br><span class="line">    <span class="attr">status</span>: <span class="number">200</span>,</span><br><span class="line">    <span class="attr">message</span>: <span class="string">&#x27;è·å–ç”¨æˆ·ä¿¡æ¯æˆåŠŸï¼&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>: req.<span class="property">user</span>, <span class="comment">// è¦å‘é€ç»™å®¢æˆ·ç«¯çš„ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;status&quot;</span><span class="punctuation">:</span> <span class="number">200</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;message&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ç™»å½•æˆåŠŸï¼&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;token&quot;</span><span class="punctuation">:</span> <span class="string">&quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFjaGUiLCJpYXQiOjE2ODA2MDcyNzksImV4cCI6MTY4MDYwNzMwOX0.fwi0wHfJHhyVudF2O44-BGH_XkIBTADjxq8cy_t7ht0&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;status&quot;</span><span class="punctuation">:</span> <span class="number">200</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;message&quot;</span><span class="punctuation">:</span> <span class="string">&quot;è·å–ç”¨æˆ·ä¿¡æ¯æˆåŠŸï¼&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;username&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ache&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;iat&quot;</span><span class="punctuation">:</span> <span class="number">1680607767</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;exp&quot;</span><span class="punctuation">:</span> <span class="number">1680607797</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>



<h5 id="æ•è·è§£æ-JWT-å¤±è´¥åäº§ç”Ÿçš„é”™è¯¯"><a href="#æ•è·è§£æ-JWT-å¤±è´¥åäº§ç”Ÿçš„é”™è¯¯" class="headerlink" title="æ•è·è§£æ JWT å¤±è´¥åäº§ç”Ÿçš„é”™è¯¯"></a>æ•è·è§£æ JWT å¤±è´¥åäº§ç”Ÿçš„é”™è¯¯</h5><blockquote>
<p>å½“ä½¿ç”¨ express-jwt è§£æ Token å­—ç¬¦ä¸²æ—¶ï¼Œå¦‚æœå®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„ Token å­—ç¬¦ä¸²è¿‡æœŸæˆ–ä¸åˆæ³•ï¼Œä¼šäº§ç”Ÿä¸€ä¸ªè§£æå¤±è´¥ çš„é”™è¯¯ï¼Œå½±å“é¡¹ç›®çš„æ­£å¸¸è¿è¡Œã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ Express çš„é”™è¯¯ä¸­é—´ä»¶ï¼Œæ•è·è¿™ä¸ªé”™è¯¯å¹¶è¿›è¡Œç›¸å…³çš„å¤„ç†ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹: </p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä½¿ç”¨å…¨å±€é”™è¯¯å¤„ç†ä¸­é—´ä»¶ï¼Œæ•è·è§£æ JWT å¤±è´¥åäº§ç”Ÿçš„é”™è¯¯</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">err, req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// è¿™æ¬¡é”™è¯¯æ˜¯ç”± token è§£æå¤±è´¥å¯¼è‡´çš„</span></span><br><span class="line">  <span class="keyword">if</span> (err.<span class="property">name</span> === <span class="string">&#x27;UnauthorizedError&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">send</span>(&#123;</span><br><span class="line">      <span class="attr">status</span>: <span class="number">401</span>,</span><br><span class="line">      <span class="attr">message</span>: <span class="string">&#x27;æ— æ•ˆçš„token&#x27;</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  res.<span class="title function_">send</span>(&#123;</span><br><span class="line">    <span class="attr">status</span>: <span class="number">500</span>,</span><br><span class="line">    <span class="attr">message</span>: <span class="string">&#x27;æœªçŸ¥çš„é”™è¯¯&#x27;</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h5 id="å®Œæ•´ä»£ç -1"><a href="#å®Œæ•´ä»£ç -1" class="headerlink" title="å®Œæ•´ä»£ç "></a>å®Œæ•´ä»£ç </h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥ express æ¨¡å—</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="comment">// åˆ›å»º express çš„æœåŠ¡å™¨å®ä¾‹</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// TODO_01ï¼šå®‰è£…å¹¶å¯¼å…¥ JWT ç›¸å…³çš„ä¸¤ä¸ªåŒ…ï¼Œåˆ†åˆ«æ˜¯ jsonwebtoken å’Œ express-jwt</span></span><br><span class="line"><span class="keyword">const</span> jwt = <span class="built_in">require</span>(<span class="string">&#x27;jsonwebtoken&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> expressJWT = <span class="built_in">require</span>(<span class="string">&#x27;express-jwt&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å…è®¸è·¨åŸŸèµ„æºå…±äº«</span></span><br><span class="line"><span class="keyword">const</span> cors = <span class="built_in">require</span>(<span class="string">&#x27;cors&#x27;</span>)</span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">cors</span>())</span><br><span class="line"></span><br><span class="line"><span class="comment">// è§£æ post è¡¨å•æ•°æ®çš„ä¸­é—´ä»¶</span></span><br><span class="line"><span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>)</span><br><span class="line">app.<span class="title function_">use</span>(bodyParser.<span class="title function_">urlencoded</span>(&#123; <span class="attr">extended</span>: <span class="literal">false</span> &#125;))</span><br><span class="line"></span><br><span class="line"><span class="comment">// TODO_02ï¼šå®šä¹‰ secret å¯†é’¥ï¼Œå»ºè®®å°†å¯†é’¥å‘½åä¸º secretKey</span></span><br><span class="line"><span class="keyword">const</span> secretKey = <span class="string">&#x27;ache ^_^&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// TODO_04ï¼šæ³¨å†Œå°† JWT å­—ç¬¦ä¸²è§£æè¿˜åŸæˆ JSON å¯¹è±¡çš„ä¸­é—´ä»¶</span></span><br><span class="line"><span class="comment">// æ³¨æ„ï¼šåªè¦é…ç½®æˆåŠŸäº† express-jwt è¿™ä¸ªä¸­é—´ä»¶ï¼Œå°±å¯ä»¥æŠŠè§£æå‡ºæ¥çš„ç”¨æˆ·ä¿¡æ¯ï¼ŒæŒ‚è½½åˆ° req.user å±æ€§ä¸Š</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">expressJWT</span>(&#123; <span class="attr">secret</span>: secretKey &#125;).<span class="title function_">unless</span>(&#123; <span class="attr">path</span>: [<span class="regexp">/^\/api\//</span>] &#125;))</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç™»å½•æ¥å£</span></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/api/login&#x27;</span>, <span class="keyword">function</span> (<span class="params">req, res</span>) &#123;</span><br><span class="line">  <span class="comment">// å°† req.body è¯·æ±‚ä½“ä¸­çš„æ•°æ®ï¼Œè½¬å­˜ä¸º userinfo å¸¸é‡</span></span><br><span class="line">  <span class="keyword">const</span> userinfo = req.<span class="property">body</span></span><br><span class="line">  <span class="comment">// ç™»å½•å¤±è´¥</span></span><br><span class="line">  <span class="keyword">if</span> (userinfo.<span class="property">username</span> !== <span class="string">&#x27;ache&#x27;</span> || userinfo.<span class="property">password</span> !== <span class="string">&#x27;1&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">send</span>(&#123;</span><br><span class="line">      <span class="attr">status</span>: <span class="number">400</span>,</span><br><span class="line">      <span class="attr">message</span>: <span class="string">&#x27;ç™»å½•å¤±è´¥ï¼&#x27;</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// ç™»å½•æˆåŠŸ</span></span><br><span class="line">  <span class="comment">// TODO_03ï¼šåœ¨ç™»å½•æˆåŠŸä¹‹åï¼Œè°ƒç”¨ jwt.sign() æ–¹æ³•ç”Ÿæˆ JWT å­—ç¬¦ä¸²ã€‚å¹¶é€šè¿‡ token å±æ€§å‘é€ç»™å®¢æˆ·ç«¯</span></span><br><span class="line">  <span class="comment">// å‚æ•°1ï¼šç”¨æˆ·çš„ä¿¡æ¯å¯¹è±¡</span></span><br><span class="line">  <span class="comment">// å‚æ•°2ï¼šåŠ å¯†çš„ç§˜é’¥</span></span><br><span class="line">  <span class="comment">// å‚æ•°3ï¼šé…ç½®å¯¹è±¡ï¼Œå¯ä»¥é…ç½®å½“å‰ token çš„æœ‰æ•ˆæœŸ</span></span><br><span class="line">  <span class="comment">// è®°ä½ï¼šåƒä¸‡ä¸è¦æŠŠå¯†ç åŠ å¯†åˆ° token å­—ç¬¦ä¸­</span></span><br><span class="line">  <span class="keyword">const</span> tokenStr = jwt.<span class="title function_">sign</span>(&#123; <span class="attr">username</span>: userinfo.<span class="property">username</span> &#125;, secretKey, &#123; <span class="attr">expiresIn</span>: <span class="string">&#x27;30s&#x27;</span> &#125;)</span><br><span class="line">  res.<span class="title function_">send</span>(&#123;</span><br><span class="line">    <span class="attr">status</span>: <span class="number">200</span>,</span><br><span class="line">    <span class="attr">message</span>: <span class="string">&#x27;ç™»å½•æˆåŠŸï¼&#x27;</span>,</span><br><span class="line">    <span class="attr">token</span>: tokenStr, <span class="comment">// è¦å‘é€ç»™å®¢æˆ·ç«¯çš„ token å­—ç¬¦ä¸²</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿™æ˜¯ä¸€ä¸ªæœ‰æƒé™çš„ API æ¥å£</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/admin/getinfo&#x27;</span>, <span class="keyword">function</span> (<span class="params">req, res</span>) &#123;</span><br><span class="line">  <span class="comment">// TODO_05ï¼šä½¿ç”¨ req.user è·å–ç”¨æˆ·ä¿¡æ¯ï¼Œå¹¶ä½¿ç”¨ data å±æ€§å°†ç”¨æˆ·ä¿¡æ¯å‘é€ç»™å®¢æˆ·ç«¯</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">user</span>)</span><br><span class="line">  res.<span class="title function_">send</span>(&#123;</span><br><span class="line">    <span class="attr">status</span>: <span class="number">200</span>,</span><br><span class="line">    <span class="attr">message</span>: <span class="string">&#x27;è·å–ç”¨æˆ·ä¿¡æ¯æˆåŠŸï¼&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>: req.<span class="property">user</span>, <span class="comment">// è¦å‘é€ç»™å®¢æˆ·ç«¯çš„ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// TODO_06ï¼šä½¿ç”¨å…¨å±€é”™è¯¯å¤„ç†ä¸­é—´ä»¶ï¼Œæ•è·è§£æ JWT å¤±è´¥åäº§ç”Ÿçš„é”™è¯¯</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">err, req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// è¿™æ¬¡é”™è¯¯æ˜¯ç”± token è§£æå¤±è´¥å¯¼è‡´çš„</span></span><br><span class="line">  <span class="keyword">if</span> (err.<span class="property">name</span> === <span class="string">&#x27;UnauthorizedError&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">send</span>(&#123;</span><br><span class="line">      <span class="attr">status</span>: <span class="number">401</span>,</span><br><span class="line">      <span class="attr">message</span>: <span class="string">&#x27;æ— æ•ˆçš„token&#x27;</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  res.<span class="title function_">send</span>(&#123;</span><br><span class="line">    <span class="attr">status</span>: <span class="number">500</span>,</span><br><span class="line">    <span class="attr">message</span>: <span class="string">&#x27;æœªçŸ¥çš„é”™è¯¯&#x27;</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// è°ƒç”¨ app.listen æ–¹æ³•ï¼ŒæŒ‡å®šç«¯å£å·å¹¶å¯åŠ¨webæœåŠ¡å™¨</span></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">8888</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Express server running at http://127.0.0.1:8888&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h3 id="Headline"><a href="#Headline" class="headerlink" title="Headline"></a>Headline</h3><blockquote>
<p>å¤§äº‹ä»¶åå° API é¡¹ç›®ï¼ŒAPI æ¥å£æ–‡æ¡£è¯·å‚è€ƒ <a target="_blank" rel="noopener" href="https://www.showdoc.cc/escook?page_id=3707158761215217">https://www.showdoc.cc/escook?page_id=3707158761215217</a></p>
</blockquote>
<h4 id="åˆå§‹åŒ–"><a href="#åˆå§‹åŒ–" class="headerlink" title="åˆå§‹åŒ–"></a>åˆå§‹åŒ–</h4><h5 id="åˆ›å»ºé¡¹ç›®"><a href="#åˆ›å»ºé¡¹ç›®" class="headerlink" title="åˆ›å»ºé¡¹ç›®"></a>åˆ›å»ºé¡¹ç›®</h5><ol>
<li>æ–°å»º <code>api_server</code> æ–‡ä»¶å¤¹ä½œä¸ºé¡¹ç›®æ ¹ç›®å½•ï¼Œå¹¶åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸­è¿è¡Œå¦‚ä¸‹çš„å‘½ä»¤ï¼Œåˆå§‹åŒ–åŒ…ç®¡ç†é…ç½®æ–‡ä»¶ï¼š</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm init -y</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>è¿è¡Œå¦‚ä¸‹çš„å‘½ä»¤ï¼Œå®‰è£…ç‰¹å®šç‰ˆæœ¬çš„ <code>express</code>ï¼š</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i express@4.17.1</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸­æ–°å»º <code>app.js</code> ä½œä¸ºæ•´ä¸ªé¡¹ç›®çš„å…¥å£æ–‡ä»¶ï¼Œå¹¶åˆå§‹åŒ–å¦‚ä¸‹çš„ä»£ç ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥ express æ¨¡å—</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="comment">// åˆ›å»º express çš„æœåŠ¡å™¨å®ä¾‹</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// write your code here...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è°ƒç”¨ app.listen æ–¹æ³•ï¼ŒæŒ‡å®šç«¯å£å·å¹¶å¯åŠ¨webæœåŠ¡å™¨</span></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">3007</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;api server running at http://127.0.0.1:3007&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h5 id="é…ç½®-cors-è·¨åŸŸ"><a href="#é…ç½®-cors-è·¨åŸŸ" class="headerlink" title="é…ç½® cors è·¨åŸŸ"></a>é…ç½® cors è·¨åŸŸ</h5><ol>
<li>è¿è¡Œå¦‚ä¸‹çš„å‘½ä»¤ï¼Œå®‰è£… <code>cors</code> ä¸­é—´ä»¶ï¼š</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i cors@2.8.5</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>åœ¨ <code>app.js</code> ä¸­å¯¼å…¥å¹¶é…ç½® <code>cors</code> ä¸­é—´ä»¶ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥ cors ä¸­é—´ä»¶</span></span><br><span class="line"><span class="keyword">const</span> cors = <span class="built_in">require</span>(<span class="string">&#x27;cors&#x27;</span>)</span><br><span class="line"><span class="comment">// å°† cors æ³¨å†Œä¸ºå…¨å±€ä¸­é—´ä»¶</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">cors</span>())</span><br></pre></td></tr></table></figure>

<h5 id="é…ç½®è§£æè¡¨å•æ•°æ®çš„ä¸­é—´ä»¶"><a href="#é…ç½®è§£æè¡¨å•æ•°æ®çš„ä¸­é—´ä»¶" class="headerlink" title="é…ç½®è§£æè¡¨å•æ•°æ®çš„ä¸­é—´ä»¶"></a>é…ç½®è§£æè¡¨å•æ•°æ®çš„ä¸­é—´ä»¶</h5><p>é€šè¿‡å¦‚ä¸‹çš„ä»£ç ï¼Œé…ç½®è§£æ <code>application/x-www-form-urlencoded</code> æ ¼å¼çš„è¡¨å•æ•°æ®çš„ä¸­é—´ä»¶ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">urlencoded</span>(&#123; <span class="attr">extended</span>: <span class="literal">false</span> &#125;))</span><br></pre></td></tr></table></figure>

<h5 id="åˆå§‹åŒ–è·¯ç”±ç›¸å…³çš„æ–‡ä»¶å¤¹"><a href="#åˆå§‹åŒ–è·¯ç”±ç›¸å…³çš„æ–‡ä»¶å¤¹" class="headerlink" title="åˆå§‹åŒ–è·¯ç”±ç›¸å…³çš„æ–‡ä»¶å¤¹"></a>åˆå§‹åŒ–è·¯ç”±ç›¸å…³çš„æ–‡ä»¶å¤¹</h5><ol>
<li>åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸­ï¼Œæ–°å»º <code>router</code> æ–‡ä»¶å¤¹ï¼Œç”¨æ¥å­˜æ”¾æ‰€æœ‰çš„<code>è·¯ç”±</code>æ¨¡å—<blockquote>
<p>è·¯ç”±æ¨¡å—ä¸­ï¼Œåªå­˜æ”¾å®¢æˆ·ç«¯çš„è¯·æ±‚ä¸å¤„ç†å‡½æ•°ä¹‹é—´çš„æ˜ å°„å…³ç³»</p>
</blockquote>
</li>
<li>åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸­ï¼Œæ–°å»º <code>router_handler</code> æ–‡ä»¶å¤¹ï¼Œç”¨æ¥å­˜æ”¾æ‰€æœ‰çš„ <code>è·¯ç”±å¤„ç†å‡½æ•°æ¨¡å—</code><blockquote>
<p>è·¯ç”±å¤„ç†å‡½æ•°æ¨¡å—ä¸­ï¼Œä¸“é—¨è´Ÿè´£å­˜æ”¾æ¯ä¸ªè·¯ç”±å¯¹åº”çš„å¤„ç†å‡½æ•°</p>
</blockquote>
</li>
</ol>
<h5 id="åˆå§‹åŒ–ç”¨æˆ·è·¯ç”±æ¨¡å—"><a href="#åˆå§‹åŒ–ç”¨æˆ·è·¯ç”±æ¨¡å—" class="headerlink" title="åˆå§‹åŒ–ç”¨æˆ·è·¯ç”±æ¨¡å—"></a>åˆå§‹åŒ–ç”¨æˆ·è·¯ç”±æ¨¡å—</h5><ol>
<li>åœ¨ <code>router</code> æ–‡ä»¶å¤¹ä¸­ï¼Œæ–°å»º <code>user.js</code> æ–‡ä»¶ï¼Œä½œä¸ºç”¨æˆ·çš„è·¯ç”±æ¨¡å—ï¼Œå¹¶åˆå§‹åŒ–ä»£ç å¦‚ä¸‹ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="comment">// åˆ›å»ºè·¯ç”±å¯¹è±¡</span></span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ³¨å†Œæ–°ç”¨æˆ·</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/reguser&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;reguser OK&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç™»å½•</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/login&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;login OK&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å°†è·¯ç”±å¯¹è±¡å…±äº«å‡ºå»</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>åœ¨ <code>app.js</code> ä¸­ï¼Œå¯¼å…¥å¹¶ä½¿ç”¨ <code>ç”¨æˆ·è·¯ç”±æ¨¡å—</code> ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥å¹¶æ³¨å†Œç”¨æˆ·è·¯ç”±æ¨¡å—</span></span><br><span class="line"><span class="keyword">const</span> userRouter = <span class="built_in">require</span>(<span class="string">&#x27;./router/user&#x27;</span>)</span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/api&#x27;</span>, userRouter)</span><br></pre></td></tr></table></figure>

<h5 id="æŠ½ç¦»ç”¨æˆ·è·¯ç”±æ¨¡å—ä¸­çš„å¤„ç†å‡½æ•°"><a href="#æŠ½ç¦»ç”¨æˆ·è·¯ç”±æ¨¡å—ä¸­çš„å¤„ç†å‡½æ•°" class="headerlink" title="æŠ½ç¦»ç”¨æˆ·è·¯ç”±æ¨¡å—ä¸­çš„å¤„ç†å‡½æ•°"></a>æŠ½ç¦»ç”¨æˆ·è·¯ç”±æ¨¡å—ä¸­çš„å¤„ç†å‡½æ•°</h5><blockquote>
<p>ç›®çš„ï¼šä¸ºäº†ä¿è¯ <code>è·¯ç”±æ¨¡å—</code> çš„çº¯ç²¹æ€§ï¼Œæ‰€æœ‰çš„ <code>è·¯ç”±å¤„ç†å‡½æ•°</code>ï¼Œå¿…é¡»æŠ½ç¦»åˆ°å¯¹åº”çš„ <code>è·¯ç”±å¤„ç†å‡½æ•°æ¨¡å—</code> ä¸­</p>
</blockquote>
<ol>
<li>åœ¨ <code>/router_handler/user.js</code> ä¸­ï¼Œä½¿ç”¨ <code>exports</code> å¯¹è±¡ï¼Œåˆ†åˆ«å‘å¤–å…±äº«å¦‚ä¸‹ä¸¤ä¸ª <code>è·¯ç”±å¤„ç†å‡½æ•°</code> ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åœ¨è¿™é‡Œå®šä¹‰å’Œç”¨æˆ·ç›¸å…³çš„è·¯ç”±å¤„ç†å‡½æ•°ï¼Œä¾› /router/user.js æ¨¡å—è¿›è¡Œè°ƒç”¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ³¨å†Œç”¨æˆ·çš„å¤„ç†å‡½æ•°</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">regUser</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;reguser OK&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç™»å½•çš„å¤„ç†å‡½æ•°</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">login</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;login OK&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>å°† <code>/router/user.js</code> ä¸­çš„ä»£ç ä¿®æ”¹ä¸ºå¦‚ä¸‹ç»“æ„ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¼å…¥ç”¨æˆ·è·¯ç”±å¤„ç†å‡½æ•°æ¨¡å—</span></span><br><span class="line"><span class="keyword">const</span> userHandler = <span class="built_in">require</span>(<span class="string">&#x27;../router_handler/user&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ³¨å†Œæ–°ç”¨æˆ·</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/reguser&#x27;</span>, userHandler.<span class="property">regUser</span>)</span><br><span class="line"><span class="comment">// ç™»å½•</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/login&#x27;</span>, userHandler.<span class="property">login</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router</span><br></pre></td></tr></table></figure>

<h4 id="ç™»å½•æ³¨å†Œ"><a href="#ç™»å½•æ³¨å†Œ" class="headerlink" title="ç™»å½•æ³¨å†Œ"></a>ç™»å½•æ³¨å†Œ</h4><h5 id="æ–°å»º-ec-user-è¡¨"><a href="#æ–°å»º-ec-user-è¡¨" class="headerlink" title="æ–°å»º ec_user è¡¨"></a>æ–°å»º ec_user è¡¨</h5><ol>
<li>åœ¨ <code>my_db_01</code> æ•°æ®åº“ä¸­ï¼Œæ–°å»º <code>ec_user</code> è¡¨å¦‚ä¸‹ï¼š</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE `nodejs`.`ev_user`  (</span><br><span class="line">  `id` int NOT NULL AUTO_INCREMENT,</span><br><span class="line">  `username` varchar(255) NOT NULL,</span><br><span class="line">  `password` varchar(255) NOT NULL,</span><br><span class="line">  `nickname` varchar(255) NULL,</span><br><span class="line">  `email` varchar(255) NULL,</span><br><span class="line">  `user_pic` text NULL,</span><br><span class="line">  PRIMARY KEY (`id`)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>



<h5 id="å®‰è£…å¹¶é…ç½®-mysql-æ¨¡å—"><a href="#å®‰è£…å¹¶é…ç½®-mysql-æ¨¡å—" class="headerlink" title="å®‰è£…å¹¶é…ç½® mysql æ¨¡å—"></a>å®‰è£…å¹¶é…ç½® mysql æ¨¡å—</h5><blockquote>
<p>åœ¨ API æ¥å£é¡¹ç›®ä¸­ï¼Œéœ€è¦å®‰è£…å¹¶é…ç½® <code>mysql</code> è¿™ä¸ªç¬¬ä¸‰æ–¹æ¨¡å—ï¼Œæ¥è¿æ¥å’Œæ“ä½œ MySQL æ•°æ®åº“</p>
</blockquote>
<ol>
<li>è¿è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå®‰è£… <code>mysql</code> æ¨¡å—ï¼š</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i mysql@2.18.1</span><br></pre></td></tr></table></figure>



<ol start="2">
<li>åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸­æ–°å»º <code>/db/index.js</code> æ–‡ä»¶ï¼Œåœ¨æ­¤è‡ªå®šä¹‰æ¨¡å—ä¸­åˆ›å»ºæ•°æ®åº“çš„è¿æ¥å¯¹è±¡ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥ mysql æ¨¡å—</span></span><br><span class="line"><span class="keyword">const</span> mysql = <span class="built_in">require</span>(<span class="string">&#x27;mysql&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºæ•°æ®åº“è¿æ¥å¯¹è±¡</span></span><br><span class="line"><span class="keyword">const</span> db = mysql.<span class="title function_">createPool</span>(&#123;</span><br><span class="line">  <span class="attr">host</span>: <span class="string">&#x27;127.0.0.1&#x27;</span>,</span><br><span class="line">  <span class="attr">user</span>: <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">  <span class="attr">password</span>: <span class="string">&#x27;admin123&#x27;</span>,</span><br><span class="line">  <span class="attr">database</span>: <span class="string">&#x27;my_db_01&#x27;</span>,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‘å¤–å…±äº« db æ•°æ®åº“è¿æ¥å¯¹è±¡</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = db</span><br></pre></td></tr></table></figure>



<h5 id="æ³¨å†Œ"><a href="#æ³¨å†Œ" class="headerlink" title="æ³¨å†Œ"></a>æ³¨å†Œ</h5><h6 id="å®ç°æ­¥éª¤"><a href="#å®ç°æ­¥éª¤" class="headerlink" title="å®ç°æ­¥éª¤"></a>å®ç°æ­¥éª¤</h6><ol>
<li>æ£€æµ‹è¡¨å•æ•°æ®æ˜¯å¦åˆæ³•</li>
<li>æ£€æµ‹ç”¨æˆ·åæ˜¯å¦è¢«å ç”¨</li>
<li>å¯¹å¯†ç è¿›è¡ŒåŠ å¯†å¤„ç†</li>
<li>æ’å…¥æ–°ç”¨æˆ·</li>
</ol>
<h6 id="æ£€æµ‹è¡¨å•æ•°æ®æ˜¯å¦åˆæ³•"><a href="#æ£€æµ‹è¡¨å•æ•°æ®æ˜¯å¦åˆæ³•" class="headerlink" title="æ£€æµ‹è¡¨å•æ•°æ®æ˜¯å¦åˆæ³•"></a>æ£€æµ‹è¡¨å•æ•°æ®æ˜¯å¦åˆæ³•</h6><ol>
<li>åˆ¤æ–­ç”¨æˆ·åå’Œå¯†ç æ˜¯å¦ä¸ºç©º</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ¥æ”¶è¡¨å•æ•°æ®</span></span><br><span class="line"><span class="keyword">const</span> userinfo = req.<span class="property">body</span></span><br><span class="line"><span class="comment">// åˆ¤æ–­æ•°æ®æ˜¯å¦åˆæ³•</span></span><br><span class="line"><span class="keyword">if</span> (!userinfo.<span class="property">username</span> || !userinfo.<span class="property">password</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> res.<span class="title function_">send</span>(&#123; <span class="attr">status</span>: <span class="number">1</span>, <span class="attr">message</span>: <span class="string">&#x27;ç”¨æˆ·åæˆ–å¯†ç ä¸èƒ½ä¸ºç©ºï¼&#x27;</span> &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="æ£€æµ‹ç”¨æˆ·åæ˜¯å¦è¢«å ç”¨"><a href="#æ£€æµ‹ç”¨æˆ·åæ˜¯å¦è¢«å ç”¨" class="headerlink" title="æ£€æµ‹ç”¨æˆ·åæ˜¯å¦è¢«å ç”¨"></a>æ£€æµ‹ç”¨æˆ·åæ˜¯å¦è¢«å ç”¨</h6><ol>
<li>å¯¼å…¥æ•°æ®åº“æ“ä½œæ¨¡å—ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> db = <span class="built_in">require</span>(<span class="string">&#x27;../db/index&#x27;</span>)</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>å®šä¹‰ SQL è¯­å¥ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sql = <span class="string">`select * from ec_user where username=?`</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>æ‰§è¡Œ SQL è¯­å¥å¹¶æ ¹æ®ç»“æœåˆ¤æ–­ç”¨æˆ·åæ˜¯å¦è¢«å ç”¨ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">db.<span class="title function_">query</span>(sql, [userinfo.<span class="property">username</span>], <span class="keyword">function</span> (<span class="params">err, results</span>) &#123;</span><br><span class="line">  <span class="comment">// æ‰§è¡Œ SQL è¯­å¥å¤±è´¥</span></span><br><span class="line">  <span class="keyword">if</span> (err) &#123;</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">send</span>(&#123; <span class="attr">status</span>: <span class="number">1</span>, <span class="attr">message</span>: err.<span class="property">message</span> &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// ç”¨æˆ·åè¢«å ç”¨</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">send</span>(&#123; <span class="attr">status</span>: <span class="number">1</span>, <span class="attr">message</span>: <span class="string">&#x27;ç”¨æˆ·åè¢«å ç”¨ï¼Œè¯·æ›´æ¢å…¶ä»–ç”¨æˆ·åï¼&#x27;</span> &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// <span class="doctag">TODO:</span> ç”¨æˆ·åå¯ç”¨ï¼Œç»§ç»­åç»­æµç¨‹...</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[Object: null prototype] &#123; username: <span class="string">&#x27;æŸšç¨šä¸ç€æ€¥&#x27;</span>, password: <span class="string">&#x27;2&#x27;</span> &#125;</span><br><span class="line">[Object: null prototype] &#123;</span><br><span class="line">  username: <span class="string">&#x27;æŸšç¨šä¸ç€æ€¥&#x27;</span>,</span><br><span class="line">  password: <span class="string">&#x27;$2a$10$x02b9xUjZSY7A4W.mVqGvu92w1QpBPF65jv7yZpG2yVD54dEB6IR.&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h6 id="å¯¹å¯†ç è¿›è¡ŒåŠ å¯†å¤„ç†"><a href="#å¯¹å¯†ç è¿›è¡ŒåŠ å¯†å¤„ç†" class="headerlink" title="å¯¹å¯†ç è¿›è¡ŒåŠ å¯†å¤„ç†"></a>å¯¹å¯†ç è¿›è¡ŒåŠ å¯†å¤„ç†</h6><blockquote>
<p>ä¸ºäº†ä¿è¯å¯†ç çš„å®‰å…¨æ€§ï¼Œä¸å»ºè®®åœ¨æ•°æ®åº“ä»¥ <code>æ˜æ–‡</code> çš„å½¢å¼ä¿å­˜ç”¨æˆ·å¯†ç ï¼Œæ¨èå¯¹å¯†ç è¿›è¡Œ <code>åŠ å¯†å­˜å‚¨</code></p>
</blockquote>
<hr>
<p>åœ¨å½“å‰é¡¹ç›®ä¸­ï¼Œä½¿ç”¨ <code>bcryptjs</code> å¯¹ç”¨æˆ·å¯†ç è¿›è¡ŒåŠ å¯†ï¼Œä¼˜ç‚¹ï¼š</p>
<ul>
<li>åŠ å¯†ä¹‹åçš„å¯†ç ï¼Œ<strong>æ— æ³•è¢«é€†å‘ç ´è§£</strong></li>
<li>åŒä¸€æ˜æ–‡å¯†ç å¤šæ¬¡åŠ å¯†ï¼Œå¾—åˆ°çš„<strong>åŠ å¯†ç»“æœå„ä¸ç›¸åŒ</strong>ï¼Œä¿è¯äº†å®‰å…¨æ€§</li>
</ul>
<hr>
<ol>
<li>è¿è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå®‰è£…æŒ‡å®šç‰ˆæœ¬çš„ <code>bcryptjs</code> ï¼š</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i bcryptjs@2.4.3</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>åœ¨ <code>/router_handler/user.js</code> ä¸­ï¼Œå¯¼å…¥ <code>bcryptjs</code> ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> bcrypt = <span class="built_in">require</span>(<span class="string">&#x27;bcryptjs&#x27;</span>)</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>åœ¨æ³¨å†Œç”¨æˆ·çš„å¤„ç†å‡½æ•°ä¸­ï¼Œç¡®è®¤ç”¨æˆ·åå¯ç”¨ä¹‹åï¼Œè°ƒç”¨ <code>bcrypt.hashSync(æ˜æ–‡å¯†ç , éšæœºç›çš„é•¿åº¦)</code> æ–¹æ³•ï¼Œå¯¹ç”¨æˆ·çš„å¯†ç è¿›è¡ŒåŠ å¯†å¤„ç†ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¹ç”¨æˆ·çš„å¯†ç ,è¿›è¡Œ bcrype åŠ å¯†ï¼Œè¿”å›å€¼æ˜¯åŠ å¯†ä¹‹åçš„å¯†ç å­—ç¬¦ä¸²</span></span><br><span class="line">userinfo.<span class="property">password</span> = bcrypt.<span class="title function_">hashSync</span>(userinfo.<span class="property">password</span>, <span class="number">10</span>)</span><br></pre></td></tr></table></figure>

<h6 id="æ’å…¥æ–°ç”¨æˆ·"><a href="#æ’å…¥æ–°ç”¨æˆ·" class="headerlink" title="æ’å…¥æ–°ç”¨æˆ·"></a>æ’å…¥æ–°ç”¨æˆ·</h6><ol>
<li>å®šä¹‰æ’å…¥ç”¨æˆ·çš„ SQL è¯­å¥ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sql = <span class="string">&#x27;insert into ec_user set ?&#x27;</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>è°ƒç”¨ <code>db.query()</code> æ‰§è¡Œ SQL è¯­å¥ï¼Œæ’å…¥æ–°ç”¨æˆ·ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">db.<span class="title function_">query</span>(sql,&#123;<span class="attr">username</span>: userinfo.<span class="property">username</span>,<span class="attr">password</span>: userinfo.<span class="property">password</span>&#125;,<span class="function">(<span class="params">err,results</span>)=&gt;</span>&#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// åˆ¤æ–­ sql è¯­å¥æ˜¯å¦æ‰§è¡ŒæˆåŠŸ</span></span><br><span class="line">            <span class="keyword">if</span>(err)&#123;</span><br><span class="line">                <span class="keyword">return</span> res.<span class="title function_">send</span>(&#123;</span><br><span class="line">                    <span class="attr">status</span>: <span class="number">1</span>,</span><br><span class="line">                    <span class="attr">message</span>: err.<span class="property">message</span></span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// åˆ¤æ–­å½±å“è¡Œæ•°æ˜¯å¦ä¸º 1</span></span><br><span class="line">            <span class="keyword">if</span>(results.<span class="property">affectedRows</span> !== <span class="number">1</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> res.<span class="title function_">send</span>(&#123;</span><br><span class="line">                    <span class="attr">status</span>: <span class="number">1</span>,</span><br><span class="line">                    <span class="attr">message</span>: <span class="string">&#x27;æ³¨å†Œå¤±è´¥ï¼Œè¯·ç¨åå†è¯•&#x27;</span></span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// æ³¨å†ŒæˆåŠŸ</span></span><br><span class="line">            res.<span class="title function_">send</span>(&#123;</span><br><span class="line">                <span class="attr">status</span>: <span class="number">1</span>,</span><br><span class="line">                <span class="attr">message</span>: <span class="string">&#x27;æ³¨å†ŒæˆåŠŸ&#x27;</span></span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;)</span><br></pre></td></tr></table></figure>



<h6 id="å®Œæ•´ä»£ç -2"><a href="#å®Œæ•´ä»£ç -2" class="headerlink" title="å®Œæ•´ä»£ç "></a>å®Œæ•´ä»£ç </h6><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åœ¨è¿™é‡Œå®šä¹‰å’Œç”¨æˆ·ç›¸å…³çš„è·¯ç”±å¤„ç†å‡½æ•°ï¼Œä¾› /router/user.js æ¨¡å—è¿›è¡Œè°ƒç”¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¼å…¥æ•°æ®åº“æ“ä½œæ¨¡å—</span></span><br><span class="line"><span class="keyword">const</span> db = <span class="built_in">require</span>(<span class="string">&#x27;../db/index&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¼å…¥ bcryptjs è¿™ä¸ªåŒ…</span></span><br><span class="line"><span class="keyword">const</span> bcrypt = <span class="built_in">require</span>(<span class="string">&#x27;bcryptjs&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> e = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ³¨å†Œç”¨æˆ·çš„å¤„ç†å‡½æ•°</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">regUser</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–å®¢æˆ·ç«¯æäº¤åˆ°æœåŠ¡å™¨çš„ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">    <span class="keyword">const</span> userinfo = req.<span class="property">body</span></span><br><span class="line">    <span class="comment">// å¯¹è¡¨å•ä¸­çš„æ•°æ®ï¼Œè¿›è¡Œåˆæ³•æ€§çš„æ ¡éªŒ</span></span><br><span class="line">    <span class="keyword">if</span> (!userinfo.<span class="property">username</span> || !userinfo.<span class="property">password</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> res.<span class="title function_">send</span>(&#123; <span class="attr">status</span>: <span class="number">1</span>, <span class="attr">message</span>: <span class="string">&#x27;ç”¨æˆ·åæˆ–å¯†ç ä¸åˆæ³•ï¼&#x27;</span> &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å®šä¹‰ sql è¯­å¥ï¼ŒæŸ¥è¯¢ç”¨æˆ·åæ˜¯å¦è¢«å ç”¨</span></span><br><span class="line">    <span class="keyword">const</span> sqlStr = <span class="string">&#x27;select * from ec_user where username = ?&#x27;</span></span><br><span class="line">    db.<span class="title function_">query</span>(sqlStr,userinfo.<span class="property">username</span>,<span class="function">(<span class="params">err,results</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="comment">// æ‰§è¡Œ sql è¯­å¥å¤±è´¥</span></span><br><span class="line">        <span class="keyword">if</span>(err)&#123;</span><br><span class="line">            <span class="keyword">return</span> res.<span class="title function_">send</span>(&#123;</span><br><span class="line">                <span class="attr">status</span>: <span class="number">1</span>,</span><br><span class="line">                <span class="attr">message</span>: err.<span class="property">message</span></span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// åˆ¤æ–­ç”¨æˆ·åæ˜¯å¦å¯ç”¨</span></span><br><span class="line">        <span class="keyword">if</span>(results.<span class="property">length</span> &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> res.<span class="title function_">send</span>(&#123;</span><br><span class="line">                <span class="attr">status</span>: <span class="number">1</span>,</span><br><span class="line">                <span class="attr">message</span>: <span class="string">&#x27;ç”¨æˆ·åè¢«å ç”¨ï¼Œè¯·æ›´æ¢åˆ«çš„ç”¨æˆ·å&#x27;</span></span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// <span class="doctag">TODO:</span>ç”¨æˆ·åå¯ä»¥ç”¨</span></span><br><span class="line">        <span class="comment">// è°ƒç”¨ bcrypt.hashSync() å¯¹å¯†ç è¿›è¡ŒåŠ å¯†</span></span><br><span class="line">        userinfo.<span class="property">password</span> = bcrypt.<span class="title function_">hashSync</span>(userinfo.<span class="property">password</span>,<span class="number">10</span>)</span><br><span class="line">        <span class="comment">// è°ƒç”¨æ’å…¥æ–°ç”¨æˆ·çš„ sql è¯­å¥</span></span><br><span class="line">        <span class="keyword">const</span> sql = <span class="string">&#x27;insert into ec_user set ?&#x27;</span></span><br><span class="line">        db.<span class="title function_">query</span>(sql,&#123;<span class="attr">username</span>: userinfo.<span class="property">username</span>,<span class="attr">password</span>: userinfo.<span class="property">password</span>&#125;,<span class="function">(<span class="params">err,results</span>)=&gt;</span>&#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// åˆ¤æ–­ sql è¯­å¥æ˜¯å¦æ‰§è¡ŒæˆåŠŸ</span></span><br><span class="line">            <span class="keyword">if</span>(err)&#123;</span><br><span class="line">                <span class="keyword">return</span> res.<span class="title function_">send</span>(&#123;</span><br><span class="line">                    <span class="attr">status</span>: <span class="number">1</span>,</span><br><span class="line">                    <span class="attr">message</span>: err.<span class="property">message</span></span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// åˆ¤æ–­å½±å“è¡Œæ•°æ˜¯å¦ä¸º 1</span></span><br><span class="line">            <span class="keyword">if</span>(results.<span class="property">affectedRows</span> !== <span class="number">1</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> res.<span class="title function_">send</span>(&#123;</span><br><span class="line">                    <span class="attr">status</span>: <span class="number">1</span>,</span><br><span class="line">                    <span class="attr">message</span>: <span class="string">&#x27;æ³¨å†Œå¤±è´¥ï¼Œè¯·ç¨åå†è¯•&#x27;</span></span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// æ³¨å†ŒæˆåŠŸ</span></span><br><span class="line">            res.<span class="title function_">send</span>(&#123;</span><br><span class="line">                <span class="attr">status</span>: <span class="number">1</span>,</span><br><span class="line">                <span class="attr">message</span>: <span class="string">&#x27;æ³¨å†ŒæˆåŠŸ&#x27;</span></span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç™»å½•çš„å¤„ç†å‡½æ•°</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">login</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&#x27;login OK&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="ä¼˜åŒ–-res-send-ä»£ç "><a href="#ä¼˜åŒ–-res-send-ä»£ç " class="headerlink" title="ä¼˜åŒ– res.send() ä»£ç "></a>ä¼˜åŒ– res.send() ä»£ç </h5><blockquote>
<p>åœ¨å¤„ç†å‡½æ•°ä¸­ï¼Œéœ€è¦å¤šæ¬¡è°ƒç”¨ <code>res.send()</code> å‘å®¢æˆ·ç«¯å“åº” <code>å¤„ç†å¤±è´¥</code> çš„ç»“æœï¼Œä¸ºäº†ç®€åŒ–ä»£ç ï¼Œå¯ä»¥æ‰‹åŠ¨å°è£…ä¸€ä¸ª res.cc() å‡½æ•°</p>
</blockquote>
<ol>
<li>åœ¨ <code>app.js</code> ä¸­ï¼Œæ‰€æœ‰è·¯ç”±ä¹‹å‰ï¼Œå£°æ˜ä¸€ä¸ªå…¨å±€ä¸­é—´ä»¶ï¼Œä¸º res å¯¹è±¡æŒ‚è½½ä¸€ä¸ª <code>res.cc()</code> å‡½æ•° ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å“åº”æ•°æ®çš„ä¸­é—´ä»¶</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="keyword">function</span> (<span class="params">req, res, next</span>) &#123;</span><br><span class="line">  <span class="comment">// status = 0 ä¸ºæˆåŠŸï¼› status = 1 ä¸ºå¤±è´¥ï¼› é»˜è®¤å°† status çš„å€¼è®¾ç½®ä¸º 1ï¼Œæ–¹ä¾¿å¤„ç†å¤±è´¥çš„æƒ…å†µ</span></span><br><span class="line">  res.<span class="property">cc</span> = <span class="keyword">function</span> (<span class="params">err, status = <span class="number">1</span></span>) &#123;</span><br><span class="line">    res.<span class="title function_">send</span>(&#123;</span><br><span class="line">      <span class="comment">// çŠ¶æ€</span></span><br><span class="line">      status,</span><br><span class="line">      <span class="comment">// çŠ¶æ€æè¿°ï¼Œåˆ¤æ–­ err æ˜¯ é”™è¯¯å¯¹è±¡ è¿˜æ˜¯ å­—ç¬¦ä¸²</span></span><br><span class="line">      <span class="attr">message</span>: err <span class="keyword">instanceof</span> <span class="title class_">Error</span> ? err.<span class="property">message</span> : err,</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">next</span>()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h5 id="ä¼˜åŒ–è¡¨å•æ•°æ®éªŒè¯"><a href="#ä¼˜åŒ–è¡¨å•æ•°æ®éªŒè¯" class="headerlink" title="ä¼˜åŒ–è¡¨å•æ•°æ®éªŒè¯"></a>ä¼˜åŒ–è¡¨å•æ•°æ®éªŒè¯</h5><blockquote>
<p>è¡¨å•éªŒè¯çš„åŸåˆ™ï¼šå‰ç«¯éªŒè¯ä¸ºè¾…ï¼Œåç«¯éªŒè¯ä¸ºä¸»ï¼Œåç«¯<strong>æ°¸è¿œä¸è¦ç›¸ä¿¡</strong>å‰ç«¯æäº¤è¿‡æ¥çš„<strong>ä»»ä½•å†…å®¹</strong></p>
</blockquote>
<p>åœ¨å®é™…å¼€å‘ä¸­ï¼Œå‰åç«¯éƒ½éœ€è¦å¯¹è¡¨å•çš„æ•°æ®è¿›è¡Œåˆæ³•æ€§çš„éªŒè¯ï¼Œè€Œä¸”ï¼Œ<strong>åç«¯åšä¸ºæ•°æ®åˆæ³•æ€§éªŒè¯çš„æœ€åä¸€ä¸ªå…³å£</strong>ï¼Œåœ¨æ‹¦æˆªéæ³•æ•°æ®æ–¹é¢ï¼Œèµ·åˆ°äº†è‡³å…³é‡è¦çš„ä½œç”¨ã€‚</p>
<p>å•çº¯çš„ä½¿ç”¨ <code>if...else...</code> çš„å½¢å¼å¯¹æ•°æ®åˆæ³•æ€§è¿›è¡ŒéªŒè¯ï¼Œæ•ˆç‡ä½ä¸‹ã€å‡ºé”™ç‡é«˜ã€ç»´æŠ¤æ€§å·®ã€‚å› æ­¤ï¼Œæ¨èä½¿ç”¨<strong>ç¬¬ä¸‰æ–¹æ•°æ®éªŒè¯æ¨¡å—</strong>ï¼Œæ¥é™ä½å‡ºé”™ç‡ã€æé«˜éªŒè¯çš„æ•ˆç‡ä¸å¯ç»´æŠ¤æ€§ï¼Œ<strong>è®©åç«¯ç¨‹åºå‘˜æŠŠæ›´å¤šçš„ç²¾åŠ›æ”¾åœ¨æ ¸å¿ƒä¸šåŠ¡é€»è¾‘çš„å¤„ç†ä¸Š</strong>ã€‚</p>
<ol>
<li>å®‰è£… <code>@escook/express-joi</code> ä¸­é—´ä»¶ï¼Œæ¥å®ç°è‡ªåŠ¨å¯¹è¡¨å•æ•°æ®è¿›è¡ŒéªŒè¯çš„åŠŸèƒ½ï¼š</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i @escook/express-joi</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>å®‰è£… <code>@hapi/joi</code> åŒ…ï¼Œä¸ºè¡¨å•ä¸­æºå¸¦çš„æ¯ä¸ªæ•°æ®é¡¹ï¼Œå®šä¹‰éªŒè¯è§„åˆ™ï¼š</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install @hapi/joi@17.1.0</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>æ–°å»º <code>/schema/user.js</code> ç”¨æˆ·ä¿¡æ¯éªŒè¯è§„åˆ™æ¨¡å—ï¼Œå¹¶åˆå§‹åŒ–ä»£ç å¦‚ä¸‹ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> joi = <span class="built_in">require</span>(<span class="string">&#x27;@hapi/joi&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * string() å€¼å¿…é¡»æ˜¯å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="comment"> * alphanum() å€¼åªèƒ½æ˜¯åŒ…å« a-zA-Z0-9 çš„å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="comment"> * min(length) æœ€å°é•¿åº¦</span></span><br><span class="line"><span class="comment"> * max(length) æœ€å¤§é•¿åº¦</span></span><br><span class="line"><span class="comment"> * required() å€¼æ˜¯å¿…å¡«é¡¹ï¼Œä¸èƒ½ä¸º undefined</span></span><br><span class="line"><span class="comment"> * pattern(æ­£åˆ™è¡¨è¾¾å¼) å€¼å¿…é¡»ç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼çš„è§„åˆ™</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”¨æˆ·åçš„éªŒè¯è§„åˆ™</span></span><br><span class="line"><span class="keyword">const</span> username = joi.<span class="title function_">string</span>().<span class="title function_">alphanum</span>().<span class="title function_">min</span>(<span class="number">1</span>).<span class="title function_">max</span>(<span class="number">10</span>).required()</span><br><span class="line"><span class="comment">// å¯†ç çš„éªŒè¯è§„åˆ™</span></span><br><span class="line"><span class="keyword">const</span> password = joi.<span class="title function_">string</span>().<span class="title function_">pattern</span>(<span class="regexp">/^[\S]&#123;6,12&#125;$/</span>).required()</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ³¨å†Œå’Œç™»å½•è¡¨å•çš„éªŒè¯è§„åˆ™å¯¹è±¡</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">reg_login_schema</span> = &#123;</span><br><span class="line">  <span class="comment">// è¡¨ç¤ºéœ€è¦å¯¹ req.body ä¸­çš„æ•°æ®è¿›è¡ŒéªŒè¯</span></span><br><span class="line">  <span class="attr">body</span>: &#123;</span><br><span class="line">    username,</span><br><span class="line">    password,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>ä¿®æ”¹ <code>/router/user.js</code> ä¸­çš„ä»£ç å¦‚ä¸‹ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¼å…¥ç”¨æˆ·è·¯ç”±å¤„ç†å‡½æ•°æ¨¡å—</span></span><br><span class="line"><span class="keyword">const</span> userHandler = <span class="built_in">require</span>(<span class="string">&#x27;../router_handler/user&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. å¯¼å…¥éªŒè¯è¡¨å•æ•°æ®çš„ä¸­é—´ä»¶</span></span><br><span class="line"><span class="keyword">const</span> expressJoi = <span class="built_in">require</span>(<span class="string">&#x27;@escook/express-joi&#x27;</span>)</span><br><span class="line"><span class="comment">// 2. å¯¼å…¥éœ€è¦çš„éªŒè¯è§„åˆ™å¯¹è±¡</span></span><br><span class="line"><span class="keyword">const</span> &#123; reg_login_schema &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../schema/user&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ³¨å†Œæ–°ç”¨æˆ·</span></span><br><span class="line"><span class="comment">// 3. åœ¨æ³¨å†Œæ–°ç”¨æˆ·çš„è·¯ç”±ä¸­ï¼Œå£°æ˜å±€éƒ¨ä¸­é—´ä»¶ï¼Œå¯¹å½“å‰è¯·æ±‚ä¸­æºå¸¦çš„æ•°æ®è¿›è¡ŒéªŒè¯</span></span><br><span class="line"><span class="comment">// 3.1 æ•°æ®éªŒè¯é€šè¿‡åï¼Œä¼šæŠŠè¿™æ¬¡è¯·æ±‚æµè½¬ç»™åé¢çš„è·¯ç”±å¤„ç†å‡½æ•°</span></span><br><span class="line"><span class="comment">// 3.2 æ•°æ®éªŒè¯å¤±è´¥åï¼Œç»ˆæ­¢åç»­ä»£ç çš„æ‰§è¡Œï¼Œå¹¶æŠ›å‡ºä¸€ä¸ªå…¨å±€çš„ Error é”™è¯¯ï¼Œè¿›å…¥å…¨å±€é”™è¯¯çº§åˆ«ä¸­é—´ä»¶ä¸­è¿›è¡Œå¤„ç†</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/reguser&#x27;</span>, <span class="title function_">expressJoi</span>(reg_login_schema), userHandler.<span class="property">regUser</span>)</span><br><span class="line"><span class="comment">// ç™»å½•</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/login&#x27;</span>, userHandler.<span class="property">login</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router</span><br></pre></td></tr></table></figure>

<ol start="5">
<li>åœ¨ <code>app.js</code> çš„å…¨å±€é”™è¯¯çº§åˆ«ä¸­é—´ä»¶ä¸­ï¼Œæ•è·éªŒè¯å¤±è´¥çš„é”™è¯¯ï¼Œå¹¶æŠŠéªŒè¯å¤±è´¥çš„ç»“æœå“åº”ç»™å®¢æˆ·ç«¯ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> joi = <span class="built_in">require</span>(<span class="string">&#x27;@hapi/joi&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// é”™è¯¯ä¸­é—´ä»¶</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="keyword">function</span> (<span class="params">err, req, res, next</span>) &#123;</span><br><span class="line">  <span class="comment">// æ•°æ®éªŒè¯å¤±è´¥</span></span><br><span class="line">  <span class="keyword">if</span> (err <span class="keyword">instanceof</span> joi.<span class="property">ValidationError</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line">  <span class="comment">// æœªçŸ¥é”™è¯¯</span></span><br><span class="line">  res.<span class="title function_">cc</span>(err)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<h5 id="ç™»å½•"><a href="#ç™»å½•" class="headerlink" title="ç™»å½•"></a>ç™»å½•</h5><h6 id="å®ç°æ­¥éª¤-1"><a href="#å®ç°æ­¥éª¤-1" class="headerlink" title="å®ç°æ­¥éª¤"></a>å®ç°æ­¥éª¤</h6><ol>
<li>æ£€æµ‹è¡¨å•æ•°æ®æ˜¯å¦åˆæ³•</li>
<li>æ ¹æ®ç”¨æˆ·åæŸ¥è¯¢ç”¨æˆ·çš„æ•°æ®</li>
<li>åˆ¤æ–­ç”¨æˆ·è¾“å…¥çš„å¯†ç æ˜¯å¦æ­£ç¡®</li>
<li>ç”Ÿæˆ JWT çš„ Token å­—ç¬¦ä¸²</li>
</ol>
<h6 id="æ£€æµ‹ç™»å½•è¡¨å•çš„æ•°æ®æ˜¯å¦åˆæ³•"><a href="#æ£€æµ‹ç™»å½•è¡¨å•çš„æ•°æ®æ˜¯å¦åˆæ³•" class="headerlink" title="æ£€æµ‹ç™»å½•è¡¨å•çš„æ•°æ®æ˜¯å¦åˆæ³•"></a>æ£€æµ‹ç™»å½•è¡¨å•çš„æ•°æ®æ˜¯å¦åˆæ³•</h6><ol>
<li>å°† <code>/router/user.js</code> ä¸­ <code>ç™»å½•</code> çš„è·¯ç”±ä»£ç ä¿®æ”¹å¦‚ä¸‹ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç™»å½•çš„è·¯ç”±</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/login&#x27;</span>, <span class="title function_">expressJoi</span>(reg_login_schema), userHandler.<span class="property">login</span>)</span><br></pre></td></tr></table></figure>

<h6 id="æ ¹æ®ç”¨æˆ·åæŸ¥è¯¢ç”¨æˆ·çš„æ•°æ®"><a href="#æ ¹æ®ç”¨æˆ·åæŸ¥è¯¢ç”¨æˆ·çš„æ•°æ®" class="headerlink" title="æ ¹æ®ç”¨æˆ·åæŸ¥è¯¢ç”¨æˆ·çš„æ•°æ®"></a>æ ¹æ®ç”¨æˆ·åæŸ¥è¯¢ç”¨æˆ·çš„æ•°æ®</h6><ol>
<li>æ¥æ”¶è¡¨å•æ•°æ®ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> userinfo = req.<span class="property">body</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>å®šä¹‰ SQL è¯­å¥ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sql = <span class="string">`select * from ec_user where username=?`</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>æ‰§è¡Œ SQL è¯­å¥ï¼ŒæŸ¥è¯¢ç”¨æˆ·çš„æ•°æ®ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">db.<span class="title function_">query</span>(sql, userinfo.<span class="property">username</span>, <span class="keyword">function</span> (<span class="params">err, results</span>) &#123;</span><br><span class="line">  <span class="comment">// æ‰§è¡Œ SQL è¯­å¥å¤±è´¥</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line">  <span class="comment">// æ‰§è¡Œ SQL è¯­å¥æˆåŠŸï¼Œä½†æ˜¯æŸ¥è¯¢åˆ°æ•°æ®æ¡æ•°ä¸ç­‰äº 1</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">length</span> !== <span class="number">1</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;ç™»å½•å¤±è´¥ï¼&#x27;</span>)</span><br><span class="line">  <span class="comment">// TODOï¼šåˆ¤æ–­ç”¨æˆ·è¾“å…¥çš„ç™»å½•å¯†ç æ˜¯å¦å’Œæ•°æ®åº“ä¸­çš„å¯†ç ä¸€è‡´</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h6 id="åˆ¤æ–­ç”¨æˆ·è¾“å…¥çš„å¯†ç æ˜¯å¦æ­£ç¡®"><a href="#åˆ¤æ–­ç”¨æˆ·è¾“å…¥çš„å¯†ç æ˜¯å¦æ­£ç¡®" class="headerlink" title="åˆ¤æ–­ç”¨æˆ·è¾“å…¥çš„å¯†ç æ˜¯å¦æ­£ç¡®"></a>åˆ¤æ–­ç”¨æˆ·è¾“å…¥çš„å¯†ç æ˜¯å¦æ­£ç¡®</h6><blockquote>
<p>æ ¸å¿ƒå®ç°æ€è·¯ï¼šè°ƒç”¨ <code>bcrypt.compareSync(ç”¨æˆ·æäº¤çš„å¯†ç , æ•°æ®åº“ä¸­çš„å¯†ç )</code> æ–¹æ³•æ¯”è¾ƒå¯†ç æ˜¯å¦ä¸€è‡´</p>
</blockquote>
<blockquote>
<p>è¿”å›å€¼æ˜¯å¸ƒå°”å€¼ï¼ˆtrue ä¸€è‡´ã€false ä¸ä¸€è‡´ï¼‰</p>
</blockquote>
<p>å…·ä½“çš„å®ç°ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ‹¿ç€ç”¨æˆ·è¾“å…¥çš„å¯†ç ,å’Œæ•°æ®åº“ä¸­å­˜å‚¨çš„å¯†ç è¿›è¡Œå¯¹æ¯”</span></span><br><span class="line"><span class="keyword">const</span> compareResult = bcrypt.<span class="title function_">compareSync</span>(userinfo.<span class="property">password</span>, results[<span class="number">0</span>].<span class="property">password</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¦‚æœå¯¹æ¯”çš„ç»“æœç­‰äº false, åˆ™è¯æ˜ç”¨æˆ·è¾“å…¥çš„å¯†ç é”™è¯¯</span></span><br><span class="line"><span class="keyword">if</span> (!compareResult) &#123;</span><br><span class="line">  <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;ç™»å½•å¤±è´¥ï¼&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// TODOï¼šç™»å½•æˆåŠŸï¼Œç”Ÿæˆ Token å­—ç¬¦ä¸²</span></span><br></pre></td></tr></table></figure>

<h6 id="ç”Ÿæˆ-JWT-çš„-Token-å­—ç¬¦ä¸²"><a href="#ç”Ÿæˆ-JWT-çš„-Token-å­—ç¬¦ä¸²" class="headerlink" title="ç”Ÿæˆ JWT çš„ Token å­—ç¬¦ä¸²"></a>ç”Ÿæˆ JWT çš„ Token å­—ç¬¦ä¸²</h6><blockquote>
<p>æ ¸å¿ƒæ³¨æ„ç‚¹ï¼šåœ¨ç”Ÿæˆ Token å­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œä¸€å®šè¦å‰”é™¤ <strong>å¯†ç </strong> å’Œ <strong>å¤´åƒ</strong> çš„å€¼</p>
</blockquote>
<ol>
<li>é€šè¿‡ ES6 çš„é«˜çº§è¯­æ³•ï¼Œå¿«é€Ÿå‰”é™¤ <code>å¯†ç </code> å’Œ <code>å¤´åƒ</code> çš„å€¼ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‰”é™¤å®Œæ¯•ä¹‹åï¼Œuser ä¸­åªä¿ç•™äº†ç”¨æˆ·çš„ id, username, nickname, email è¿™å››ä¸ªå±æ€§çš„å€¼</span></span><br><span class="line"><span class="keyword">const</span> user = &#123; ...results[<span class="number">0</span>], <span class="attr">password</span>: <span class="string">&#x27;&#x27;</span>, <span class="attr">user_pic</span>: <span class="string">&#x27;&#x27;</span> &#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>è¿è¡Œå¦‚ä¸‹çš„å‘½ä»¤ï¼Œå®‰è£…ç”Ÿæˆ Token å­—ç¬¦ä¸²çš„åŒ…ï¼š</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i jsonwebtoken@8.5.1</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>åœ¨ <code>/router_handler/user.js</code> æ¨¡å—çš„å¤´éƒ¨åŒºåŸŸï¼Œå¯¼å…¥ <code>jsonwebtoken</code> åŒ…ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç”¨è¿™ä¸ªåŒ…æ¥ç”Ÿæˆ Token å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="keyword">const</span> jwt = <span class="built_in">require</span>(<span class="string">&#x27;jsonwebtoken&#x27;</span>)</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>åˆ›å»º <code>config.js</code> æ–‡ä»¶ï¼Œå¹¶å‘å¤–å…±äº« <strong>åŠ å¯†</strong> å’Œ <strong>è¿˜åŸ</strong> Token çš„ <code>jwtSecretKey</code> å­—ç¬¦ä¸²ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">jwtSecretKey</span>: <span class="string">&#x27;itheima No1. ^_^&#x27;</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="5">
<li>å°†ç”¨æˆ·ä¿¡æ¯å¯¹è±¡åŠ å¯†æˆ Token å­—ç¬¦ä¸²ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥é…ç½®æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">const</span> config = <span class="built_in">require</span>(<span class="string">&#x27;../config&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”Ÿæˆ Token å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="keyword">const</span> tokenStr = jwt.<span class="title function_">sign</span>(user, config.<span class="property">jwtSecretKey</span>, &#123;</span><br><span class="line">  <span class="attr">expiresIn</span>: <span class="string">&#x27;10h&#x27;</span>, <span class="comment">// token æœ‰æ•ˆæœŸä¸º 10 ä¸ªå°æ—¶</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<ol start="6">
<li>å°†ç”Ÿæˆçš„ Token å­—ç¬¦ä¸²å“åº”ç»™å®¢æˆ·ç«¯ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">res.<span class="title function_">send</span>(&#123;</span><br><span class="line">  <span class="attr">status</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="attr">message</span>: <span class="string">&#x27;ç™»å½•æˆåŠŸï¼&#x27;</span>,</span><br><span class="line">  <span class="comment">// ä¸ºäº†æ–¹ä¾¿å®¢æˆ·ç«¯ä½¿ç”¨ Tokenï¼Œåœ¨æœåŠ¡å™¨ç«¯ç›´æ¥æ‹¼æ¥ä¸Š Bearer çš„å‰ç¼€</span></span><br><span class="line">  <span class="attr">token</span>: <span class="string">&#x27;Bearer &#x27;</span> + tokenStr,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MjAyMTMwNDQ5NSwidXNlcm5hbWUiOiJhZG1pbiIsInBhc3N3b3JkIjoiIiwibmlja25hbWUiOm51bGwsImVtYWlsIjpudWxsLCJ1c2VyX3BpYyI6IiIsImlhdCI6MTY4MDY2MTY4MSwiZXhwIjoxNjgwNjk3NjgxfQ.WCI6wEk1XJDcKoYCSsZiDaRdZpTsVXqExnK84NfIbpk</span><br></pre></td></tr></table></figure>



<h6 id="2-7-é…ç½®è§£æ-Token-çš„ä¸­é—´ä»¶"><a href="#2-7-é…ç½®è§£æ-Token-çš„ä¸­é—´ä»¶" class="headerlink" title="2.7 é…ç½®è§£æ Token çš„ä¸­é—´ä»¶"></a>2.7 é…ç½®è§£æ Token çš„ä¸­é—´ä»¶</h6><ol>
<li>è¿è¡Œå¦‚ä¸‹çš„å‘½ä»¤ï¼Œå®‰è£…è§£æ Token çš„ä¸­é—´ä»¶ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i express-jwt@<span class="number">5.3</span><span class="number">.3</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>åœ¨ <code>app.js</code> ä¸­æ³¨å†Œè·¯ç”±ä¹‹å‰ï¼Œé…ç½®è§£æ Token çš„ä¸­é—´ä»¶ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥é…ç½®æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">const</span> config = <span class="built_in">require</span>(<span class="string">&#x27;./config&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// è§£æ token çš„ä¸­é—´ä»¶</span></span><br><span class="line"><span class="keyword">const</span> expressJWT = <span class="built_in">require</span>(<span class="string">&#x27;express-jwt&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ .unless(&#123; path: [/^\/api\//] &#125;) æŒ‡å®šå“ªäº›æ¥å£ä¸éœ€è¦è¿›è¡Œ Token çš„èº«ä»½è®¤è¯</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">expressJWT</span>(&#123; <span class="attr">secret</span>: config.<span class="property">jwtSecretKey</span> &#125;).<span class="title function_">unless</span>(&#123; <span class="attr">path</span>: [<span class="regexp">/^\/api\//</span>] &#125;))</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>åœ¨ <code>app.js</code> ä¸­çš„ <code>é”™è¯¯çº§åˆ«ä¸­é—´ä»¶</code> é‡Œé¢ï¼Œæ•è·å¹¶å¤„ç† Token è®¤è¯å¤±è´¥åçš„é”™è¯¯ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é”™è¯¯ä¸­é—´ä»¶</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="keyword">function</span> (<span class="params">err, req, res, next</span>) &#123;</span><br><span class="line">  <span class="comment">// çœç•¥å…¶å®ƒä»£ç ...</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ•è·èº«ä»½è®¤è¯å¤±è´¥çš„é”™è¯¯</span></span><br><span class="line">  <span class="keyword">if</span> (err.<span class="property">name</span> === <span class="string">&#x27;UnauthorizedError&#x27;</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;èº«ä»½è®¤è¯å¤±è´¥ï¼&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æœªçŸ¥é”™è¯¯...</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="ä¸ªäººä¸­å¿ƒ"><a href="#ä¸ªäººä¸­å¿ƒ" class="headerlink" title="ä¸ªäººä¸­å¿ƒ"></a>ä¸ªäººä¸­å¿ƒ</h4><h5 id="è·å–ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯"><a href="#è·å–ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯" class="headerlink" title="è·å–ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯"></a>è·å–ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯</h5><h6 id="å®ç°æ­¥éª¤-2"><a href="#å®ç°æ­¥éª¤-2" class="headerlink" title="å®ç°æ­¥éª¤"></a>å®ç°æ­¥éª¤</h6><ol>
<li>åˆå§‹åŒ– <strong>è·¯ç”±</strong> æ¨¡å—</li>
<li>åˆå§‹åŒ– <strong>è·¯ç”±å¤„ç†å‡½æ•°</strong> æ¨¡å—</li>
<li>è·å–ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯</li>
</ol>
<h6 id="åˆå§‹åŒ–è·¯ç”±æ¨¡å—"><a href="#åˆå§‹åŒ–è·¯ç”±æ¨¡å—" class="headerlink" title="åˆå§‹åŒ–è·¯ç”±æ¨¡å—"></a>åˆå§‹åŒ–è·¯ç”±æ¨¡å—</h6><ol>
<li>åˆ›å»º <code>/router/userinfo.js</code> è·¯ç”±æ¨¡å—ï¼Œå¹¶åˆå§‹åŒ–å¦‚ä¸‹çš„ä»£ç ç»“æ„ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥ express</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="comment">// åˆ›å»ºè·¯ç”±å¯¹è±¡</span></span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/userinfo&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‘å¤–å…±äº«è·¯ç”±å¯¹è±¡</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>åœ¨ <code>app.js</code> ä¸­å¯¼å…¥å¹¶ä½¿ç”¨ä¸ªäººä¸­å¿ƒçš„è·¯ç”±æ¨¡å—ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥å¹¶ä½¿ç”¨ç”¨æˆ·ä¿¡æ¯è·¯ç”±æ¨¡å—</span></span><br><span class="line"><span class="keyword">const</span> userinfoRouter = <span class="built_in">require</span>(<span class="string">&#x27;./router/userinfo&#x27;</span>)</span><br><span class="line"><span class="comment">// æ³¨æ„ï¼šä»¥ /my å¼€å¤´çš„æ¥å£ï¼Œéƒ½æ˜¯æœ‰æƒé™çš„æ¥å£ï¼Œéœ€è¦è¿›è¡Œ Token èº«ä»½è®¤è¯</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/my&#x27;</span>, userinfoRouter)</span><br></pre></td></tr></table></figure>

<h6 id="3-1-2-åˆå§‹åŒ–è·¯ç”±å¤„ç†å‡½æ•°æ¨¡å—"><a href="#3-1-2-åˆå§‹åŒ–è·¯ç”±å¤„ç†å‡½æ•°æ¨¡å—" class="headerlink" title="3.1.2 åˆå§‹åŒ–è·¯ç”±å¤„ç†å‡½æ•°æ¨¡å—"></a>3.1.2 åˆå§‹åŒ–è·¯ç”±å¤„ç†å‡½æ•°æ¨¡å—</h6><ol>
<li>åˆ›å»º <code>/router_handler/userinfo.js</code> è·¯ç”±å¤„ç†å‡½æ•°æ¨¡å—ï¼Œå¹¶åˆå§‹åŒ–å¦‚ä¸‹çš„ä»£ç ç»“æ„ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è·å–ç”¨æˆ·åŸºæœ¬ä¿¡æ¯çš„å¤„ç†å‡½æ•°</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">getUserInfo</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>ä¿®æ”¹ <code>/router/userinfo.js</code> ä¸­çš„ä»£ç å¦‚ä¸‹ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¼å…¥ç”¨æˆ·ä¿¡æ¯çš„å¤„ç†å‡½æ•°æ¨¡å—</span></span><br><span class="line"><span class="keyword">const</span> userinfo_handler = <span class="built_in">require</span>(<span class="string">&#x27;../router_handler/userinfo&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/userinfo&#x27;</span>, userinfo_handler.<span class="property">getUserInfo</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router</span><br></pre></td></tr></table></figure>

<h6 id="3-1-3-è·å–ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯"><a href="#3-1-3-è·å–ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯" class="headerlink" title="3.1.3 è·å–ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯"></a>3.1.3 è·å–ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯</h6><ol>
<li>åœ¨ <code>/router_handler/userinfo.js</code> å¤´éƒ¨å¯¼å…¥æ•°æ®åº“æ“ä½œæ¨¡å—ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥æ•°æ®åº“æ“ä½œæ¨¡å—</span></span><br><span class="line"><span class="keyword">const</span> db = <span class="built_in">require</span>(<span class="string">&#x27;../db/index&#x27;</span>)</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>å®šä¹‰ SQL è¯­å¥ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ ¹æ®ç”¨æˆ·çš„ idï¼ŒæŸ¥è¯¢ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯</span></span><br><span class="line"><span class="comment">// æ³¨æ„ï¼šä¸ºäº†é˜²æ­¢ç”¨æˆ·çš„å¯†ç æ³„éœ²ï¼Œéœ€è¦æ’é™¤ password å­—æ®µ</span></span><br><span class="line"><span class="keyword">const</span> sql = <span class="string">`select id, username, nickname, email, user_pic from ec_user where id=?`</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>è°ƒç”¨ <code>db.query()</code> æ‰§è¡Œ SQL è¯­å¥ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ³¨æ„ï¼šreq å¯¹è±¡ä¸Šçš„ user å±æ€§ï¼Œæ˜¯ Token è§£ææˆåŠŸï¼Œexpress-jwt ä¸­é—´ä»¶å¸®æˆ‘ä»¬æŒ‚è½½ä¸Šå»çš„</span></span><br><span class="line">db.<span class="title function_">query</span>(sql, req.<span class="property">user</span>.<span class="property">id</span>, <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 1. æ‰§è¡Œ SQL è¯­å¥å¤±è´¥</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 2. æ‰§è¡Œ SQL è¯­å¥æˆåŠŸï¼Œä½†æ˜¯æŸ¥è¯¢åˆ°çš„æ•°æ®æ¡æ•°ä¸ç­‰äº 1</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">length</span> !== <span class="number">1</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥ï¼&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 3. å°†ç”¨æˆ·ä¿¡æ¯å“åº”ç»™å®¢æˆ·ç«¯</span></span><br><span class="line">  res.<span class="title function_">send</span>(&#123;</span><br><span class="line">    <span class="attr">status</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">message</span>: <span class="string">&#x27;è·å–ç”¨æˆ·åŸºæœ¬ä¿¡æ¯æˆåŠŸï¼&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>: results[<span class="number">0</span>],</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;status&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;message&quot;</span><span class="punctuation">:</span> <span class="string">&quot;è·å–ç”¨æˆ·ä¿¡æ¯æˆåŠŸï¼&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">2021304495</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;username&quot;</span><span class="punctuation">:</span> <span class="string">&quot;admin&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;nickname&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;email&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;user_pic&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>



<h5 id="æ›´æ–°ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯"><a href="#æ›´æ–°ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯" class="headerlink" title="æ›´æ–°ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯"></a>æ›´æ–°ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯</h5><h6 id="å®ç°æ­¥éª¤-3"><a href="#å®ç°æ­¥éª¤-3" class="headerlink" title="å®ç°æ­¥éª¤"></a>å®ç°æ­¥éª¤</h6><ol>
<li>å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•°</li>
<li>éªŒè¯è¡¨å•æ•°æ®</li>
<li>å®ç°æ›´æ–°ç”¨æˆ·åŸºæœ¬ä¿¡æ¯çš„åŠŸèƒ½</li>
</ol>
<h6 id="å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•°"><a href="#å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•°" class="headerlink" title="å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•°"></a>å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•°</h6><ol>
<li>åœ¨ <code>/router/userinfo.js</code> æ¨¡å—ä¸­ï¼Œæ–°å¢ <code>æ›´æ–°ç”¨æˆ·åŸºæœ¬ä¿¡æ¯</code> çš„è·¯ç”±ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ›´æ–°ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/userinfo&#x27;</span>, userinfo_handler.<span class="property">updateUserInfo</span>)</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>åœ¨ <code>/router_handler/userinfo.js</code> æ¨¡å—ä¸­ï¼Œå®šä¹‰å¹¶å‘å¤–å…±äº« <code>æ›´æ–°ç”¨æˆ·åŸºæœ¬ä¿¡æ¯</code> çš„è·¯ç”±å¤„ç†å‡½æ•°ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ›´æ–°ç”¨æˆ·åŸºæœ¬ä¿¡æ¯çš„å¤„ç†å‡½æ•°</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">updateUserInfo</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="éªŒè¯è¡¨å•æ•°æ®"><a href="#éªŒè¯è¡¨å•æ•°æ®" class="headerlink" title="éªŒè¯è¡¨å•æ•°æ®"></a>éªŒè¯è¡¨å•æ•°æ®</h6><ol>
<li>åœ¨ <code>/schema/user.js</code> éªŒè¯è§„åˆ™æ¨¡å—ä¸­ï¼Œå®šä¹‰ <code>id</code>ï¼Œ<code>nickname</code>ï¼Œ<code>email</code> çš„éªŒè¯è§„åˆ™å¦‚ä¸‹ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰ id, nickname, emial çš„éªŒè¯è§„åˆ™</span></span><br><span class="line"><span class="keyword">const</span> id = joi.<span class="title function_">number</span>().<span class="title function_">integer</span>().<span class="title function_">min</span>(<span class="number">1</span>).required()</span><br><span class="line"><span class="keyword">const</span> nickname = joi.<span class="title function_">string</span>().required()</span><br><span class="line"><span class="keyword">const</span> email = joi.<span class="title function_">string</span>().<span class="title function_">email</span>().required()</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>å¹¶ä½¿ç”¨ <code>exports</code> å‘å¤–å…±äº«å¦‚ä¸‹çš„ <code>éªŒè¯è§„åˆ™å¯¹è±¡</code>ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// éªŒè¯è§„åˆ™å¯¹è±¡ - æ›´æ–°ç”¨æˆ·åŸºæœ¬ä¿¡æ¯</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">update_userinfo_schema</span> = &#123;</span><br><span class="line">  <span class="attr">body</span>: &#123;</span><br><span class="line">    id,</span><br><span class="line">    nickname,</span><br><span class="line">    email,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>åœ¨ <code>/router/userinfo.js</code> æ¨¡å—ä¸­ï¼Œå¯¼å…¥éªŒè¯æ•°æ®åˆæ³•æ€§çš„ä¸­é—´ä»¶ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥éªŒè¯æ•°æ®åˆæ³•æ€§çš„ä¸­é—´ä»¶</span></span><br><span class="line"><span class="keyword">const</span> expressJoi = <span class="built_in">require</span>(<span class="string">&#x27;@escook/express-joi&#x27;</span>)</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>åœ¨ <code>/router/userinfo.js</code> æ¨¡å—ä¸­ï¼Œå¯¼å…¥éœ€è¦çš„éªŒè¯è§„åˆ™å¯¹è±¡ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥éœ€è¦çš„éªŒè¯è§„åˆ™å¯¹è±¡</span></span><br><span class="line"><span class="keyword">const</span> &#123; update_userinfo_schema &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../schema/user&#x27;</span>)</span><br></pre></td></tr></table></figure>

<ol start="5">
<li>åœ¨ <code>/router/userinfo.js</code> æ¨¡å—ä¸­ï¼Œä¿®æ”¹ <code>æ›´æ–°ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯</code> çš„è·¯ç”±å¦‚ä¸‹ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ›´æ–°ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/userinfo&#x27;</span>, <span class="title function_">expressJoi</span>(update_userinfo_schema), userinfo_handler.<span class="property">updateUserInfo</span>)</span><br></pre></td></tr></table></figure>

<h6 id="å®ç°æ›´æ–°ç”¨æˆ·åŸºæœ¬ä¿¡æ¯çš„åŠŸèƒ½"><a href="#å®ç°æ›´æ–°ç”¨æˆ·åŸºæœ¬ä¿¡æ¯çš„åŠŸèƒ½" class="headerlink" title="å®ç°æ›´æ–°ç”¨æˆ·åŸºæœ¬ä¿¡æ¯çš„åŠŸèƒ½"></a>å®ç°æ›´æ–°ç”¨æˆ·åŸºæœ¬ä¿¡æ¯çš„åŠŸèƒ½</h6><ol>
<li>å®šä¹‰å¾…æ‰§è¡Œçš„ SQL è¯­å¥ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sql = <span class="string">`update ec_user set ? where id=?`</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>è°ƒç”¨ <code>db.query()</code> æ‰§è¡Œ SQL è¯­å¥å¹¶ä¼ å‚ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">db.<span class="title function_">query</span>(sql, [req.<span class="property">body</span>, req.<span class="property">body</span>.<span class="property">id</span>], <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// æ‰§è¡Œ SQL è¯­å¥å¤±è´¥</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ‰§è¡Œ SQL è¯­å¥æˆåŠŸï¼Œä½†å½±å“è¡Œæ•°ä¸ä¸º 1</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">affectedRows</span> !== <span class="number">1</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;ä¿®æ”¹ç”¨æˆ·åŸºæœ¬ä¿¡æ¯å¤±è´¥ï¼&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯æˆåŠŸ</span></span><br><span class="line">  <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;ä¿®æ”¹ç”¨æˆ·åŸºæœ¬ä¿¡æ¯æˆåŠŸï¼&#x27;</span>, <span class="number">0</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h5 id="é‡ç½®å¯†ç "><a href="#é‡ç½®å¯†ç " class="headerlink" title="é‡ç½®å¯†ç "></a>é‡ç½®å¯†ç </h5><h6 id="å®ç°æ­¥éª¤-4"><a href="#å®ç°æ­¥éª¤-4" class="headerlink" title="å®ç°æ­¥éª¤"></a>å®ç°æ­¥éª¤</h6><ol>
<li>å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•°</li>
<li>éªŒè¯è¡¨å•æ•°æ®</li>
<li>å®ç°é‡ç½®å¯†ç çš„åŠŸèƒ½</li>
</ol>
<h6 id="å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•°-1"><a href="#å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•°-1" class="headerlink" title="å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•°"></a>å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•°</h6><ol>
<li>åœ¨ <code>/router/userinfo.js</code> æ¨¡å—ä¸­ï¼Œæ–°å¢ <code>é‡ç½®å¯†ç </code> çš„è·¯ç”±ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é‡ç½®å¯†ç çš„è·¯ç”±</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/updatepwd&#x27;</span>, userinfo_handler.<span class="property">updatePassword</span>)</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>åœ¨ <code>/router_handler/userinfo.js</code> æ¨¡å—ä¸­ï¼Œå®šä¹‰å¹¶å‘å¤–å…±äº« <code>é‡ç½®å¯†ç </code> çš„è·¯ç”±å¤„ç†å‡½æ•°ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é‡ç½®å¯†ç çš„å¤„ç†å‡½æ•°</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">updatePassword</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="éªŒè¯è¡¨å•æ•°æ®-1"><a href="#éªŒè¯è¡¨å•æ•°æ®-1" class="headerlink" title="éªŒè¯è¡¨å•æ•°æ®"></a>éªŒè¯è¡¨å•æ•°æ®</h6><blockquote>
<p>æ ¸å¿ƒéªŒè¯æ€è·¯ï¼šæ—§å¯†ç ä¸æ–°å¯†ç ï¼Œå¿…é¡»ç¬¦åˆå¯†ç çš„éªŒè¯è§„åˆ™ï¼Œå¹¶ä¸”æ–°å¯†ç ä¸èƒ½ä¸æ—§å¯†ç ä¸€è‡´ï¼</p>
</blockquote>
<ol>
<li>åœ¨ <code>/schema/user.js</code> æ¨¡å—ä¸­ï¼Œä½¿ç”¨ <code>exports</code> å‘å¤–å…±äº«å¦‚ä¸‹çš„ <code>éªŒè¯è§„åˆ™å¯¹è±¡</code>ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// éªŒè¯è§„åˆ™å¯¹è±¡ - é‡ç½®å¯†ç </span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">update_password_schema</span> = &#123;</span><br><span class="line">  <span class="attr">body</span>: &#123;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨ password è¿™ä¸ªè§„åˆ™ï¼ŒéªŒè¯ req.body.oldPwd çš„å€¼</span></span><br><span class="line">    <span class="attr">oldPwd</span>: password,</span><br><span class="line">    <span class="comment">// ä½¿ç”¨ joi.not(joi.ref(&#x27;oldPwd&#x27;)).concat(password) è§„åˆ™ï¼ŒéªŒè¯ req.body.newPwd çš„å€¼</span></span><br><span class="line">    <span class="comment">// è§£è¯»ï¼š</span></span><br><span class="line">    <span class="comment">// 1. joi.ref(&#x27;oldPwd&#x27;) è¡¨ç¤º newPwd çš„å€¼å¿…é¡»å’Œ oldPwd çš„å€¼ä¿æŒä¸€è‡´</span></span><br><span class="line">    <span class="comment">// 2. joi.not(joi.ref(&#x27;oldPwd&#x27;)) è¡¨ç¤º newPwd çš„å€¼ä¸èƒ½ç­‰äº oldPwd çš„å€¼</span></span><br><span class="line">    <span class="comment">// 3. .concat() ç”¨äºåˆå¹¶ joi.not(joi.ref(&#x27;oldPwd&#x27;)) å’Œ password è¿™ä¸¤æ¡éªŒè¯è§„åˆ™</span></span><br><span class="line">    <span class="attr">newPwd</span>: joi.<span class="title function_">not</span>(joi.<span class="title function_">ref</span>(<span class="string">&#x27;oldPwd&#x27;</span>)).<span class="title function_">concat</span>(password),</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>åœ¨ <code>/router/userinfo.js</code> æ¨¡å—ä¸­ï¼Œå¯¼å…¥éœ€è¦çš„éªŒè¯è§„åˆ™å¯¹è±¡ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥éœ€è¦çš„éªŒè¯è§„åˆ™å¯¹è±¡</span></span><br><span class="line"><span class="keyword">const</span> &#123; update_userinfo_schema, update_password_schema &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../schema/user&#x27;</span>)</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>å¹¶åœ¨ <code>é‡ç½®å¯†ç çš„è·¯ç”±</code> ä¸­ï¼Œä½¿ç”¨ <code>update_password_schema</code> è§„åˆ™éªŒè¯è¡¨å•çš„æ•°æ®ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/updatepwd&#x27;</span>, <span class="title function_">expressJoi</span>(update_password_schema), userinfo_handler.<span class="property">updatePassword</span>)</span><br></pre></td></tr></table></figure>

<h6 id="å®ç°é‡ç½®å¯†ç çš„åŠŸèƒ½"><a href="#å®ç°é‡ç½®å¯†ç çš„åŠŸèƒ½" class="headerlink" title="å®ç°é‡ç½®å¯†ç çš„åŠŸèƒ½"></a>å®ç°é‡ç½®å¯†ç çš„åŠŸèƒ½</h6><ol>
<li>æ ¹æ® <code>id</code> æŸ¥è¯¢ç”¨æˆ·æ˜¯å¦å­˜åœ¨ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰æ ¹æ® id æŸ¥è¯¢ç”¨æˆ·æ•°æ®çš„ SQL è¯­å¥</span></span><br><span class="line"><span class="keyword">const</span> sql = <span class="string">`select * from ec_user where id=?`</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‰§è¡Œ SQL è¯­å¥æŸ¥è¯¢ç”¨æˆ·æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">db.<span class="title function_">query</span>(sql, req.<span class="property">user</span>.<span class="property">id</span>, <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// æ‰§è¡Œ SQL è¯­å¥å¤±è´¥</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ£€æŸ¥æŒ‡å®š id çš„ç”¨æˆ·æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">length</span> !== <span class="number">1</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;ç”¨æˆ·ä¸å­˜åœ¨ï¼&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// TODOï¼šåˆ¤æ–­æäº¤çš„æ—§å¯†ç æ˜¯å¦æ­£ç¡®</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>åˆ¤æ–­æäº¤çš„ <strong>æ—§å¯†ç </strong> æ˜¯å¦æ­£ç¡®ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨å¤´éƒ¨åŒºåŸŸå¯¼å…¥ bcryptjs åï¼Œ</span></span><br><span class="line"><span class="comment">// å³å¯ä½¿ç”¨ bcrypt.compareSync(æäº¤çš„å¯†ç ï¼Œæ•°æ®åº“ä¸­çš„å¯†ç ) æ–¹æ³•éªŒè¯å¯†ç æ˜¯å¦æ­£ç¡®</span></span><br><span class="line"><span class="comment">// compareSync() å‡½æ•°çš„è¿”å›å€¼ä¸ºå¸ƒå°”å€¼ï¼Œtrue è¡¨ç¤ºå¯†ç æ­£ç¡®ï¼Œfalse è¡¨ç¤ºå¯†ç é”™è¯¯</span></span><br><span class="line"><span class="keyword">const</span> bcrypt = <span class="built_in">require</span>(<span class="string">&#x27;bcryptjs&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ¤æ–­æäº¤çš„æ—§å¯†ç æ˜¯å¦æ­£ç¡®</span></span><br><span class="line"><span class="keyword">const</span> compareResult = bcrypt.<span class="title function_">compareSync</span>(req.<span class="property">body</span>.<span class="property">oldPwd</span>, results[<span class="number">0</span>].<span class="property">password</span>)</span><br><span class="line"><span class="keyword">if</span> (!compareResult) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;åŸå¯†ç é”™è¯¯ï¼&#x27;</span>)</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>å¯¹æ–°å¯†ç è¿›è¡Œ <code>bcrypt</code> åŠ å¯†ä¹‹åï¼Œæ›´æ–°åˆ°æ•°æ®åº“ä¸­ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰æ›´æ–°ç”¨æˆ·å¯†ç çš„ SQL è¯­å¥</span></span><br><span class="line"><span class="keyword">const</span> sql = <span class="string">`update ec_user set password=? where id=?`</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¹æ–°å¯†ç è¿›è¡Œ bcrypt åŠ å¯†å¤„ç†</span></span><br><span class="line"><span class="keyword">const</span> newPwd = bcrypt.<span class="title function_">hashSync</span>(req.<span class="property">body</span>.<span class="property">newPwd</span>, <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‰§è¡Œ SQL è¯­å¥ï¼Œæ ¹æ® id æ›´æ–°ç”¨æˆ·çš„å¯†ç </span></span><br><span class="line">db.<span class="title function_">query</span>(sql, [newPwd, req.<span class="property">user</span>.<span class="property">id</span>], <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// SQL è¯­å¥æ‰§è¡Œå¤±è´¥</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// SQL è¯­å¥æ‰§è¡ŒæˆåŠŸï¼Œä½†æ˜¯å½±å“è¡Œæ•°ä¸ç­‰äº 1</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">affectedRows</span> !== <span class="number">1</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;æ›´æ–°å¯†ç å¤±è´¥ï¼&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ›´æ–°å¯†ç æˆåŠŸ</span></span><br><span class="line">  res.<span class="title function_">cc</span>(<span class="string">&#x27;æ›´æ–°å¯†ç æˆåŠŸï¼&#x27;</span>, <span class="number">0</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h5 id="æ›´æ–°ç”¨æˆ·å¤´åƒ"><a href="#æ›´æ–°ç”¨æˆ·å¤´åƒ" class="headerlink" title="æ›´æ–°ç”¨æˆ·å¤´åƒ"></a>æ›´æ–°ç”¨æˆ·å¤´åƒ</h5><h6 id="å®ç°æ­¥éª¤-5"><a href="#å®ç°æ­¥éª¤-5" class="headerlink" title="å®ç°æ­¥éª¤"></a>å®ç°æ­¥éª¤</h6><ol>
<li>å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•°</li>
<li>éªŒè¯è¡¨å•æ•°æ®</li>
<li>å®ç°æ›´æ–°ç”¨æˆ·å¤´åƒçš„åŠŸèƒ½</li>
</ol>
<h6 id="å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•°-2"><a href="#å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•°-2" class="headerlink" title="å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•°"></a>å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•°</h6><ol>
<li>åœ¨ <code>/router/userinfo.js</code> æ¨¡å—ä¸­ï¼Œæ–°å¢ <code>æ›´æ–°ç”¨æˆ·å¤´åƒ</code> çš„è·¯ç”±ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ›´æ–°ç”¨æˆ·å¤´åƒçš„è·¯ç”±</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/update/avatar&#x27;</span>, userinfo_handler.<span class="property">updateAvatar</span>)</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>åœ¨ <code>/router_handler/userinfo.js</code> æ¨¡å—ä¸­ï¼Œå®šä¹‰å¹¶å‘å¤–å…±äº« <code>æ›´æ–°ç”¨æˆ·å¤´åƒ</code> çš„è·¯ç”±å¤„ç†å‡½æ•°ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ›´æ–°ç”¨æˆ·å¤´åƒçš„å¤„ç†å‡½æ•°</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">updateAvatar</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="éªŒè¯è¡¨å•æ•°æ®-2"><a href="#éªŒè¯è¡¨å•æ•°æ®-2" class="headerlink" title="éªŒè¯è¡¨å•æ•°æ®"></a>éªŒè¯è¡¨å•æ•°æ®</h6><ol>
<li>åœ¨ <code>/schema/user.js</code> éªŒè¯è§„åˆ™æ¨¡å—ä¸­ï¼Œå®šä¹‰ <code>avatar</code> çš„éªŒè¯è§„åˆ™å¦‚ä¸‹ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// dataUri() æŒ‡çš„æ˜¯å¦‚ä¸‹æ ¼å¼çš„å­—ç¬¦ä¸²æ•°æ®ï¼š</span></span><br><span class="line"><span class="comment">// data:image/png;base64,VE9PTUFOWVNFQ1JFVFM=</span></span><br><span class="line"><span class="keyword">const</span> avatar = joi.<span class="title function_">string</span>().<span class="title function_">dataUri</span>().required()</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>å¹¶ä½¿ç”¨ <code>exports</code> å‘å¤–å…±äº«å¦‚ä¸‹çš„ <code>éªŒè¯è§„åˆ™å¯¹è±¡</code>ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// éªŒè¯è§„åˆ™å¯¹è±¡ - æ›´æ–°å¤´åƒ</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">update_avatar_schema</span> = &#123;</span><br><span class="line">  <span class="attr">body</span>: &#123;</span><br><span class="line">    avatar,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>åœ¨ <code>/router/userinfo.js</code> æ¨¡å—ä¸­ï¼Œå¯¼å…¥éœ€è¦çš„éªŒè¯è§„åˆ™å¯¹è±¡ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; update_avatar_schema &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../schema/user&#x27;</span>)</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>åœ¨ <code>/router/userinfo.js</code> æ¨¡å—ä¸­ï¼Œä¿®æ”¹ <code>æ›´æ–°ç”¨æˆ·å¤´åƒ</code> çš„è·¯ç”±å¦‚ä¸‹ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/update/avatar&#x27;</span>, <span class="title function_">expressJoi</span>(update_avatar_schema), userinfo_handler.<span class="property">updateAvatar</span>)</span><br></pre></td></tr></table></figure>

<h6 id="å®ç°æ›´æ–°ç”¨æˆ·å¤´åƒçš„åŠŸèƒ½"><a href="#å®ç°æ›´æ–°ç”¨æˆ·å¤´åƒçš„åŠŸèƒ½" class="headerlink" title="å®ç°æ›´æ–°ç”¨æˆ·å¤´åƒçš„åŠŸèƒ½"></a>å®ç°æ›´æ–°ç”¨æˆ·å¤´åƒçš„åŠŸèƒ½</h6><ol>
<li>å®šä¹‰æ›´æ–°ç”¨æˆ·å¤´åƒçš„ SQL è¯­å¥ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sql = <span class="string">&#x27;update ec_user set user_pic=? where id=?&#x27;</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>è°ƒç”¨ <code>db.query()</code> æ‰§è¡Œ SQL è¯­å¥ï¼Œæ›´æ–°å¯¹åº”ç”¨æˆ·çš„å¤´åƒï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">db.<span class="title function_">query</span>(sql, [req.<span class="property">body</span>.<span class="property">avatar</span>, req.<span class="property">user</span>.<span class="property">id</span>], <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// æ‰§è¡Œ SQL è¯­å¥å¤±è´¥</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ‰§è¡Œ SQL è¯­å¥æˆåŠŸï¼Œä½†æ˜¯å½±å“è¡Œæ•°ä¸ç­‰äº 1</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">affectedRows</span> !== <span class="number">1</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;æ›´æ–°å¤´åƒå¤±è´¥ï¼&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ›´æ–°ç”¨æˆ·å¤´åƒæˆåŠŸ</span></span><br><span class="line">  <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;æ›´æ–°å¤´åƒæˆåŠŸï¼&#x27;</span>, <span class="number">0</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="æ–‡ç« åˆ†ç±»ç®¡ç†"><a href="#æ–‡ç« åˆ†ç±»ç®¡ç†" class="headerlink" title="æ–‡ç« åˆ†ç±»ç®¡ç†"></a>æ–‡ç« åˆ†ç±»ç®¡ç†</h4><h5 id="æ–°å»º-ev-article-cate-è¡¨"><a href="#æ–°å»º-ev-article-cate-è¡¨" class="headerlink" title="æ–°å»º ev_article_cate è¡¨"></a>æ–°å»º ev_article_cate è¡¨</h5><h6 id="åˆ›å»ºè¡¨ç»“æ„"><a href="#åˆ›å»ºè¡¨ç»“æ„" class="headerlink" title="åˆ›å»ºè¡¨ç»“æ„"></a>åˆ›å»ºè¡¨ç»“æ„</h6>

<h6 id="æ–°å¢ä¸¤æ¡åˆå§‹æ•°æ®"><a href="#æ–°å¢ä¸¤æ¡åˆå§‹æ•°æ®" class="headerlink" title="æ–°å¢ä¸¤æ¡åˆå§‹æ•°æ®"></a>æ–°å¢ä¸¤æ¡åˆå§‹æ•°æ®</h6>

<h5 id="è·å–æ–‡ç« åˆ†ç±»åˆ—è¡¨"><a href="#è·å–æ–‡ç« åˆ†ç±»åˆ—è¡¨" class="headerlink" title="è·å–æ–‡ç« åˆ†ç±»åˆ—è¡¨"></a>è·å–æ–‡ç« åˆ†ç±»åˆ—è¡¨</h5><h6 id="å®ç°æ­¥éª¤-6"><a href="#å®ç°æ­¥éª¤-6" class="headerlink" title="å®ç°æ­¥éª¤"></a>å®ç°æ­¥éª¤</h6><ol>
<li>åˆå§‹åŒ–è·¯ç”±æ¨¡å—</li>
<li>åˆå§‹åŒ–è·¯ç”±å¤„ç†å‡½æ•°æ¨¡å—</li>
<li>è·å–æ–‡ç« åˆ†ç±»åˆ—è¡¨æ•°æ®</li>
</ol>
<h6 id="åˆå§‹åŒ–è·¯ç”±æ¨¡å—-1"><a href="#åˆå§‹åŒ–è·¯ç”±æ¨¡å—-1" class="headerlink" title="åˆå§‹åŒ–è·¯ç”±æ¨¡å—"></a>åˆå§‹åŒ–è·¯ç”±æ¨¡å—</h6><ol>
<li>åˆ›å»º <code>/router/artcate.js</code> è·¯ç”±æ¨¡å—ï¼Œå¹¶åˆå§‹åŒ–å¦‚ä¸‹çš„ä»£ç ç»“æ„ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥ express</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="comment">// åˆ›å»ºè·¯ç”±å¯¹è±¡</span></span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–æ–‡ç« åˆ†ç±»çš„åˆ—è¡¨æ•°æ®</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/cates&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‘å¤–å…±äº«è·¯ç”±å¯¹è±¡</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>åœ¨ <code>app.js</code> ä¸­å¯¼å…¥å¹¶ä½¿ç”¨æ–‡ç« åˆ†ç±»çš„è·¯ç”±æ¨¡å—ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥å¹¶ä½¿ç”¨æ–‡ç« åˆ†ç±»è·¯ç”±æ¨¡å—</span></span><br><span class="line"><span class="keyword">const</span> artCateRouter = <span class="built_in">require</span>(<span class="string">&#x27;./router/artcate&#x27;</span>)</span><br><span class="line"><span class="comment">// ä¸ºæ–‡ç« åˆ†ç±»çš„è·¯ç”±æŒ‚è½½ç»Ÿä¸€çš„è®¿é—®å‰ç¼€ /my/article</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/my/article&#x27;</span>, artCateRouter)</span><br></pre></td></tr></table></figure>

<h6 id="åˆå§‹åŒ–è·¯ç”±å¤„ç†å‡½æ•°æ¨¡å—"><a href="#åˆå§‹åŒ–è·¯ç”±å¤„ç†å‡½æ•°æ¨¡å—" class="headerlink" title="åˆå§‹åŒ–è·¯ç”±å¤„ç†å‡½æ•°æ¨¡å—"></a>åˆå§‹åŒ–è·¯ç”±å¤„ç†å‡½æ•°æ¨¡å—</h6><ol>
<li>åˆ›å»º <code>/router_handler/artcate.js</code> è·¯ç”±å¤„ç†å‡½æ•°æ¨¡å—ï¼Œå¹¶åˆå§‹åŒ–å¦‚ä¸‹çš„ä»£ç ç»“æ„ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è·å–æ–‡ç« åˆ†ç±»åˆ—è¡¨æ•°æ®çš„å¤„ç†å‡½æ•°</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">getArticleCates</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>ä¿®æ”¹ <code>/router/artcate.js</code> ä¸­çš„ä»£ç å¦‚ä¸‹ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¼å…¥æ–‡ç« åˆ†ç±»çš„è·¯ç”±å¤„ç†å‡½æ•°æ¨¡å—</span></span><br><span class="line"><span class="keyword">const</span> artcate_handler = <span class="built_in">require</span>(<span class="string">&#x27;../router_handler/artcate&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–æ–‡ç« åˆ†ç±»çš„åˆ—è¡¨æ•°æ®</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/cates&#x27;</span>, artcate_handler.<span class="property">getArticleCates</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router</span><br></pre></td></tr></table></figure>

<h6 id="è·å–æ–‡ç« åˆ†ç±»åˆ—è¡¨æ•°æ®"><a href="#è·å–æ–‡ç« åˆ†ç±»åˆ—è¡¨æ•°æ®" class="headerlink" title="è·å–æ–‡ç« åˆ†ç±»åˆ—è¡¨æ•°æ®"></a>è·å–æ–‡ç« åˆ†ç±»åˆ—è¡¨æ•°æ®</h6><ol>
<li>åœ¨ <code>/router_handler/artcate.js</code> å¤´éƒ¨å¯¼å…¥æ•°æ®åº“æ“ä½œæ¨¡å—ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥æ•°æ®åº“æ“ä½œæ¨¡å—</span></span><br><span class="line"><span class="keyword">const</span> db = <span class="built_in">require</span>(<span class="string">&#x27;../db/index&#x27;</span>)</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>å®šä¹‰ SQL è¯­å¥ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ ¹æ®åˆ†ç±»çš„çŠ¶æ€ï¼Œè·å–æ‰€æœ‰æœªè¢«åˆ é™¤çš„åˆ†ç±»åˆ—è¡¨æ•°æ®</span></span><br><span class="line"><span class="comment">// is_delete ä¸º 0 è¡¨ç¤ºæ²¡æœ‰è¢« æ ‡è®°ä¸ºåˆ é™¤ çš„æ•°æ®</span></span><br><span class="line"><span class="keyword">const</span> sql = <span class="string">&#x27;select * from ev_article_cate where is_delete=0 order by id asc&#x27;</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>è°ƒç”¨ <code>db.query()</code> æ‰§è¡Œ SQL è¯­å¥ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">db.<span class="title function_">query</span>(sql, <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 1. æ‰§è¡Œ SQL è¯­å¥å¤±è´¥</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 2. æ‰§è¡Œ SQL è¯­å¥æˆåŠŸ</span></span><br><span class="line">  res.<span class="title function_">send</span>(&#123;</span><br><span class="line">    <span class="attr">status</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">message</span>: <span class="string">&#x27;è·å–æ–‡ç« åˆ†ç±»åˆ—è¡¨æˆåŠŸï¼&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>: results,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h5 id="æ–°å¢æ–‡ç« åˆ†ç±»"><a href="#æ–°å¢æ–‡ç« åˆ†ç±»" class="headerlink" title="æ–°å¢æ–‡ç« åˆ†ç±»"></a>æ–°å¢æ–‡ç« åˆ†ç±»</h5><h6 id="å®ç°æ­¥éª¤-7"><a href="#å®ç°æ­¥éª¤-7" class="headerlink" title="å®ç°æ­¥éª¤"></a>å®ç°æ­¥éª¤</h6><ol>
<li>å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•°</li>
<li>éªŒè¯è¡¨å•æ•°æ®</li>
<li>æŸ¥è¯¢ <code>åˆ†ç±»åç§°</code> ä¸ <code>åˆ†ç±»åˆ«å</code> æ˜¯å¦è¢«å ç”¨</li>
<li>å®ç°æ–°å¢æ–‡ç« åˆ†ç±»çš„åŠŸèƒ½</li>
</ol>
<h6 id="å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•°-3"><a href="#å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•°-3" class="headerlink" title="å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•°"></a>å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•°</h6><ol>
<li>åœ¨ <code>/router/artcate.js</code> æ¨¡å—ä¸­ï¼Œæ·»åŠ  <code>æ–°å¢æ–‡ç« åˆ†ç±»</code> çš„è·¯ç”±ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ–°å¢æ–‡ç« åˆ†ç±»çš„è·¯ç”±</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/addcates&#x27;</span>, artcate_handler.<span class="property">addArticleCates</span>)</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>åœ¨ <code>/router_handler/artcate.js</code> æ¨¡å—ä¸­ï¼Œå®šä¹‰å¹¶å‘å¤–å…±äº« <code>æ–°å¢æ–‡ç« åˆ†ç±»</code> çš„è·¯ç”±å¤„ç†å‡½æ•°ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ–°å¢æ–‡ç« åˆ†ç±»çš„å¤„ç†å‡½æ•°</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">addArticleCates</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="éªŒè¯è¡¨å•æ•°æ®-3"><a href="#éªŒè¯è¡¨å•æ•°æ®-3" class="headerlink" title="éªŒè¯è¡¨å•æ•°æ®"></a>éªŒè¯è¡¨å•æ•°æ®</h6><ol>
<li>åˆ›å»º <code>/schema/artcate.js</code> æ–‡ç« åˆ†ç±»æ•°æ®éªŒè¯æ¨¡å—ï¼Œå¹¶å®šä¹‰å¦‚ä¸‹çš„éªŒè¯è§„åˆ™ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥å®šä¹‰éªŒè¯è§„åˆ™çš„æ¨¡å—</span></span><br><span class="line"><span class="keyword">const</span> joi = <span class="built_in">require</span>(<span class="string">&#x27;@hapi/joi&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ åˆ†ç±»åç§° å’Œ åˆ†ç±»åˆ«å çš„æ ¡éªŒè§„åˆ™</span></span><br><span class="line"><span class="keyword">const</span> name = joi.<span class="title function_">string</span>().required()</span><br><span class="line"><span class="keyword">const</span> alias = joi.<span class="title function_">string</span>().<span class="title function_">alphanum</span>().required()</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ ¡éªŒè§„åˆ™å¯¹è±¡ - æ·»åŠ åˆ†ç±»</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">add_cate_schema</span> = &#123;</span><br><span class="line">  <span class="attr">body</span>: &#123;</span><br><span class="line">    name,</span><br><span class="line">    alias,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>åœ¨ <code>/router/artcate.js</code> æ¨¡å—ä¸­ï¼Œä½¿ç”¨ <code>add_cate_schema</code> å¯¹æ•°æ®è¿›è¡ŒéªŒè¯ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥éªŒè¯æ•°æ®çš„ä¸­é—´ä»¶</span></span><br><span class="line"><span class="keyword">const</span> expressJoi = <span class="built_in">require</span>(<span class="string">&#x27;@escook/express-joi&#x27;</span>)</span><br><span class="line"><span class="comment">// å¯¼å…¥æ–‡ç« åˆ†ç±»çš„éªŒè¯æ¨¡å—</span></span><br><span class="line"><span class="keyword">const</span> &#123; add_cate_schema &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../schema/artcate&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ–°å¢æ–‡ç« åˆ†ç±»çš„è·¯ç”±</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/addcates&#x27;</span>, <span class="title function_">expressJoi</span>(add_cate_schema), artcate_handler.<span class="property">addArticleCates</span>)</span><br></pre></td></tr></table></figure>

<h6 id="æŸ¥è¯¢åˆ†ç±»åç§°ä¸åˆ«åæ˜¯å¦è¢«å ç”¨"><a href="#æŸ¥è¯¢åˆ†ç±»åç§°ä¸åˆ«åæ˜¯å¦è¢«å ç”¨" class="headerlink" title="æŸ¥è¯¢åˆ†ç±»åç§°ä¸åˆ«åæ˜¯å¦è¢«å ç”¨"></a>æŸ¥è¯¢åˆ†ç±»åç§°ä¸åˆ«åæ˜¯å¦è¢«å ç”¨</h6><ol>
<li>å®šä¹‰æŸ¥é‡çš„ SQL è¯­å¥ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰æŸ¥è¯¢ åˆ†ç±»åç§° ä¸ åˆ†ç±»åˆ«å æ˜¯å¦è¢«å ç”¨çš„ SQL è¯­å¥</span></span><br><span class="line"><span class="keyword">const</span> sql = <span class="string">`select * from ev_article_cate where name=? or alias=?`</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>è°ƒç”¨ <code>db.query()</code> æ‰§è¡ŒæŸ¥é‡çš„æ“ä½œï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ‰§è¡ŒæŸ¥é‡æ“ä½œ</span></span><br><span class="line">db.<span class="title function_">query</span>(sql, [req.<span class="property">body</span>.<span class="property">name</span>, req.<span class="property">body</span>.<span class="property">alias</span>], <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// æ‰§è¡Œ SQL è¯­å¥å¤±è´¥</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// åˆ¤æ–­ åˆ†ç±»åç§° å’Œ åˆ†ç±»åˆ«å æ˜¯å¦è¢«å ç”¨</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">length</span> === <span class="number">2</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;åˆ†ç±»åç§°ä¸åˆ«åè¢«å ç”¨ï¼Œè¯·æ›´æ¢åé‡è¯•ï¼&#x27;</span>)</span><br><span class="line">  <span class="comment">// åˆ†åˆ«åˆ¤æ–­ åˆ†ç±»åç§° å’Œ åˆ†ç±»åˆ«å æ˜¯å¦è¢«å ç”¨</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">length</span> === <span class="number">1</span> &amp;&amp; results[<span class="number">0</span>].<span class="property">name</span> === req.<span class="property">body</span>.<span class="property">name</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;åˆ†ç±»åç§°è¢«å ç”¨ï¼Œè¯·æ›´æ¢åé‡è¯•ï¼&#x27;</span>)</span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">length</span> === <span class="number">1</span> &amp;&amp; results[<span class="number">0</span>].<span class="property">alias</span> === req.<span class="property">body</span>.<span class="property">alias</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;åˆ†ç±»åˆ«åè¢«å ç”¨ï¼Œè¯·æ›´æ¢åé‡è¯•ï¼&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// TODOï¼šæ–°å¢æ–‡ç« åˆ†ç±»</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h6 id="å®ç°æ–°å¢æ–‡ç« åˆ†ç±»çš„åŠŸèƒ½"><a href="#å®ç°æ–°å¢æ–‡ç« åˆ†ç±»çš„åŠŸèƒ½" class="headerlink" title="å®ç°æ–°å¢æ–‡ç« åˆ†ç±»çš„åŠŸèƒ½"></a>å®ç°æ–°å¢æ–‡ç« åˆ†ç±»çš„åŠŸèƒ½</h6><ol>
<li>å®šä¹‰æ–°å¢æ–‡ç« åˆ†ç±»çš„ SQL è¯­å¥ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sql = <span class="string">`insert into ev_article_cate set ?`</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>è°ƒç”¨ <code>db.query()</code> æ‰§è¡Œæ–°å¢æ–‡ç« åˆ†ç±»çš„ SQL è¯­å¥ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">db.<span class="title function_">query</span>(sql, req.<span class="property">body</span>, <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// SQL è¯­å¥æ‰§è¡Œå¤±è´¥</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// SQL è¯­å¥æ‰§è¡ŒæˆåŠŸï¼Œä½†æ˜¯å½±å“è¡Œæ•°ä¸ç­‰äº 1</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">affectedRows</span> !== <span class="number">1</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;æ–°å¢æ–‡ç« åˆ†ç±»å¤±è´¥ï¼&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ–°å¢æ–‡ç« åˆ†ç±»æˆåŠŸ</span></span><br><span class="line">  res.<span class="title function_">cc</span>(<span class="string">&#x27;æ–°å¢æ–‡ç« åˆ†ç±»æˆåŠŸï¼&#x27;</span>, <span class="number">0</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h5 id="æ ¹æ®-Id-åˆ é™¤æ–‡ç« åˆ†ç±»"><a href="#æ ¹æ®-Id-åˆ é™¤æ–‡ç« åˆ†ç±»" class="headerlink" title="æ ¹æ® Id åˆ é™¤æ–‡ç« åˆ†ç±»"></a>æ ¹æ® Id åˆ é™¤æ–‡ç« åˆ†ç±»</h5><h6 id="å®ç°æ­¥éª¤-8"><a href="#å®ç°æ­¥éª¤-8" class="headerlink" title="å®ç°æ­¥éª¤"></a>å®ç°æ­¥éª¤</h6><ol>
<li>å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•°</li>
<li>éªŒè¯è¡¨å•æ•°æ®</li>
<li>å®ç°åˆ é™¤æ–‡ç« åˆ†ç±»çš„åŠŸèƒ½</li>
</ol>
<h6 id="å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•°-4"><a href="#å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•°-4" class="headerlink" title="å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•°"></a>å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•°</h6><ol>
<li>åœ¨ <code>/router/artcate.js</code> æ¨¡å—ä¸­ï¼Œæ·»åŠ  <code>åˆ é™¤æ–‡ç« åˆ†ç±»</code> çš„è·¯ç”±ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ é™¤æ–‡ç« åˆ†ç±»çš„è·¯ç”±</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/deletecate/:id&#x27;</span>, artcate_handler.<span class="property">deleteCateById</span>)</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>åœ¨ <code>/router_handler/artcate.js</code> æ¨¡å—ä¸­ï¼Œå®šä¹‰å¹¶å‘å¤–å…±äº« <code>åˆ é™¤æ–‡ç« åˆ†ç±»</code> çš„è·¯ç”±å¤„ç†å‡½æ•°ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ é™¤æ–‡ç« åˆ†ç±»çš„å¤„ç†å‡½æ•°</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">deleteCateById</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="éªŒè¯è¡¨å•æ•°æ®-4"><a href="#éªŒè¯è¡¨å•æ•°æ®-4" class="headerlink" title="éªŒè¯è¡¨å•æ•°æ®"></a>éªŒè¯è¡¨å•æ•°æ®</h6><ol>
<li>åœ¨ <code>/schema/artcate.js</code> éªŒè¯è§„åˆ™æ¨¡å—ä¸­ï¼Œå®šä¹‰ id çš„éªŒè¯è§„åˆ™å¦‚ä¸‹ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰ åˆ†ç±»Id çš„æ ¡éªŒè§„åˆ™</span></span><br><span class="line"><span class="keyword">const</span> id = joi.<span class="title function_">number</span>().<span class="title function_">integer</span>().<span class="title function_">min</span>(<span class="number">1</span>).required()</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>å¹¶ä½¿ç”¨ <code>exports</code> å‘å¤–å…±äº«å¦‚ä¸‹çš„ <code>éªŒè¯è§„åˆ™å¯¹è±¡</code>ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ ¡éªŒè§„åˆ™å¯¹è±¡ - åˆ é™¤åˆ†ç±»</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">delete_cate_schema</span> = &#123;</span><br><span class="line">  <span class="attr">params</span>: &#123;</span><br><span class="line">    id,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>åœ¨ <code>/router/artcate.js</code> æ¨¡å—ä¸­ï¼Œå¯¼å…¥éœ€è¦çš„éªŒè¯è§„åˆ™å¯¹è±¡ï¼Œå¹¶åœ¨è·¯ç”±ä¸­ä½¿ç”¨ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥åˆ é™¤åˆ†ç±»çš„éªŒè¯è§„åˆ™å¯¹è±¡</span></span><br><span class="line"><span class="keyword">const</span> &#123; delete_cate_schema &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../schema/artcate&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ é™¤æ–‡ç« åˆ†ç±»çš„è·¯ç”±</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/deletecate/:id&#x27;</span>, <span class="title function_">expressJoi</span>(delete_cate_schema), artcate_handler.<span class="property">deleteCateById</span>)</span><br></pre></td></tr></table></figure>

<h6 id="å®ç°åˆ é™¤æ–‡ç« åˆ†ç±»çš„åŠŸèƒ½"><a href="#å®ç°åˆ é™¤æ–‡ç« åˆ†ç±»çš„åŠŸèƒ½" class="headerlink" title="å®ç°åˆ é™¤æ–‡ç« åˆ†ç±»çš„åŠŸèƒ½"></a>å®ç°åˆ é™¤æ–‡ç« åˆ†ç±»çš„åŠŸèƒ½</h6><ol>
<li>å®šä¹‰åˆ é™¤æ–‡ç« åˆ†ç±»çš„ SQL è¯­å¥ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sql = <span class="string">`update ev_article_cate set is_delete=1 where id=?`</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>è°ƒç”¨ <code>db.query()</code> æ‰§è¡Œåˆ é™¤æ–‡ç« åˆ†ç±»çš„ SQL è¯­å¥ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">db.<span class="title function_">query</span>(sql, req.<span class="property">params</span>.<span class="property">id</span>, <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// æ‰§è¡Œ SQL è¯­å¥å¤±è´¥</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// SQL è¯­å¥æ‰§è¡ŒæˆåŠŸï¼Œä½†æ˜¯å½±å“è¡Œæ•°ä¸ç­‰äº 1</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">affectedRows</span> !== <span class="number">1</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;åˆ é™¤æ–‡ç« åˆ†ç±»å¤±è´¥ï¼&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// åˆ é™¤æ–‡ç« åˆ†ç±»æˆåŠŸ</span></span><br><span class="line">  res.<span class="title function_">cc</span>(<span class="string">&#x27;åˆ é™¤æ–‡ç« åˆ†ç±»æˆåŠŸï¼&#x27;</span>, <span class="number">0</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h5 id="æ ¹æ®-Id-è·å–æ–‡ç« åˆ†ç±»æ•°æ®"><a href="#æ ¹æ®-Id-è·å–æ–‡ç« åˆ†ç±»æ•°æ®" class="headerlink" title="æ ¹æ® Id è·å–æ–‡ç« åˆ†ç±»æ•°æ®"></a>æ ¹æ® Id è·å–æ–‡ç« åˆ†ç±»æ•°æ®</h5><h6 id="å®ç°æ­¥éª¤-9"><a href="#å®ç°æ­¥éª¤-9" class="headerlink" title="å®ç°æ­¥éª¤"></a>å®ç°æ­¥éª¤</h6><ol>
<li>å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•°</li>
<li>éªŒè¯è¡¨å•æ•°æ®</li>
<li>å®ç°è·å–æ–‡ç« åˆ†ç±»çš„åŠŸèƒ½</li>
</ol>
<h6 id="å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•°-5"><a href="#å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•°-5" class="headerlink" title="å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•°"></a>å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•°</h6><ol>
<li>åœ¨ <code>/router/artcate.js</code> æ¨¡å—ä¸­ï¼Œæ·»åŠ  <code>æ ¹æ® Id è·å–æ–‡ç« åˆ†ç±»</code> çš„è·¯ç”±ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/cates/:id&#x27;</span>, artcate_handler.<span class="property">getArticleById</span>)</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>åœ¨ <code>/router_handler/artcate.js</code> æ¨¡å—ä¸­ï¼Œå®šä¹‰å¹¶å‘å¤–å…±äº« <code>æ ¹æ® Id è·å–æ–‡ç« åˆ†ç±»</code> çš„è·¯ç”±å¤„ç†å‡½æ•°ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ ¹æ® Id è·å–æ–‡ç« åˆ†ç±»çš„å¤„ç†å‡½æ•°</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">getArticleById</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="éªŒè¯è¡¨å•æ•°æ®-5"><a href="#éªŒè¯è¡¨å•æ•°æ®-5" class="headerlink" title="éªŒè¯è¡¨å•æ•°æ®"></a>éªŒè¯è¡¨å•æ•°æ®</h6><ol>
<li>åœ¨ <code>/schema/artcate.js</code> éªŒè¯è§„åˆ™æ¨¡å—ä¸­ï¼Œä½¿ç”¨ <code>exports</code> å‘å¤–å…±äº«å¦‚ä¸‹çš„ <code>éªŒè¯è§„åˆ™å¯¹è±¡</code>ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ ¡éªŒè§„åˆ™å¯¹è±¡ - æ ¹æ® Id è·å–åˆ†ç±»</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">get_cate_schema</span> = &#123;</span><br><span class="line">  <span class="attr">params</span>: &#123;</span><br><span class="line">    id,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>åœ¨ <code>/router/artcate.js</code> æ¨¡å—ä¸­ï¼Œå¯¼å…¥éœ€è¦çš„éªŒè¯è§„åˆ™å¯¹è±¡ï¼Œå¹¶åœ¨è·¯ç”±ä¸­ä½¿ç”¨ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥æ ¹æ® Id è·å–åˆ†ç±»çš„éªŒè¯è§„åˆ™å¯¹è±¡</span></span><br><span class="line"><span class="keyword">const</span> &#123; get_cate_schema &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../schema/artcate&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ ¹æ® Id è·å–æ–‡ç« åˆ†ç±»çš„è·¯ç”±</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/cates/:id&#x27;</span>, <span class="title function_">expressJoi</span>(get_cate_schema), artcate_handler.<span class="property">getArticleById</span>)</span><br></pre></td></tr></table></figure>

<h6 id="å®ç°è·å–æ–‡ç« åˆ†ç±»çš„åŠŸèƒ½"><a href="#å®ç°è·å–æ–‡ç« åˆ†ç±»çš„åŠŸèƒ½" class="headerlink" title="å®ç°è·å–æ–‡ç« åˆ†ç±»çš„åŠŸèƒ½"></a>å®ç°è·å–æ–‡ç« åˆ†ç±»çš„åŠŸèƒ½</h6><ol>
<li>å®šä¹‰æ ¹æ® Id è·å–æ–‡ç« åˆ†ç±»çš„ SQL è¯­å¥ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sql = <span class="string">`select * from ev_article_cate where id=?`</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>è°ƒç”¨ <code>db.query()</code> æ‰§è¡Œ SQL è¯­å¥ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">db.<span class="title function_">query</span>(sql, req.<span class="property">params</span>.<span class="property">id</span>, <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// æ‰§è¡Œ SQL è¯­å¥å¤±è´¥</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// SQL è¯­å¥æ‰§è¡ŒæˆåŠŸï¼Œä½†æ˜¯æ²¡æœ‰æŸ¥è¯¢åˆ°ä»»ä½•æ•°æ®</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">length</span> !== <span class="number">1</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;è·å–æ–‡ç« åˆ†ç±»æ•°æ®å¤±è´¥ï¼&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æŠŠæ•°æ®å“åº”ç»™å®¢æˆ·ç«¯</span></span><br><span class="line">  res.<span class="title function_">send</span>(&#123;</span><br><span class="line">    <span class="attr">status</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">message</span>: <span class="string">&#x27;è·å–æ–‡ç« åˆ†ç±»æ•°æ®æˆåŠŸï¼&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>: results[<span class="number">0</span>],</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h5 id="æ ¹æ®-Id-æ›´æ–°æ–‡ç« åˆ†ç±»æ•°æ®"><a href="#æ ¹æ®-Id-æ›´æ–°æ–‡ç« åˆ†ç±»æ•°æ®" class="headerlink" title="æ ¹æ® Id æ›´æ–°æ–‡ç« åˆ†ç±»æ•°æ®"></a>æ ¹æ® Id æ›´æ–°æ–‡ç« åˆ†ç±»æ•°æ®</h5><h6 id="å®ç°æ­¥éª¤-10"><a href="#å®ç°æ­¥éª¤-10" class="headerlink" title="å®ç°æ­¥éª¤"></a>å®ç°æ­¥éª¤</h6><ol>
<li>å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•°</li>
<li>éªŒè¯è¡¨å•æ•°æ®</li>
<li>æŸ¥è¯¢ <code>åˆ†ç±»åç§°</code> ä¸ <code>åˆ†ç±»åˆ«å</code> æ˜¯å¦è¢«å ç”¨</li>
<li>å®ç°æ›´æ–°æ–‡ç« åˆ†ç±»çš„åŠŸèƒ½</li>
</ol>
<h6 id="å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•°-6"><a href="#å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•°-6" class="headerlink" title="å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•°"></a>å®šä¹‰è·¯ç”±å’Œå¤„ç†å‡½æ•°</h6><ol>
<li>åœ¨ <code>/router/artcate.js</code> æ¨¡å—ä¸­ï¼Œæ·»åŠ  <code>æ›´æ–°æ–‡ç« åˆ†ç±»</code> çš„è·¯ç”±ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ›´æ–°æ–‡ç« åˆ†ç±»çš„è·¯ç”±</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/updatecate&#x27;</span>, artcate_handler.<span class="property">updateCateById</span>)</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>åœ¨ <code>/router_handler/artcate.js</code> æ¨¡å—ä¸­ï¼Œå®šä¹‰å¹¶å‘å¤–å…±äº« <code>æ›´æ–°æ–‡ç« åˆ†ç±»</code> çš„è·¯ç”±å¤„ç†å‡½æ•°ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ›´æ–°æ–‡ç« åˆ†ç±»çš„å¤„ç†å‡½æ•°</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">updateCateById</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="éªŒè¯è¡¨å•æ•°æ®-6"><a href="#éªŒè¯è¡¨å•æ•°æ®-6" class="headerlink" title="éªŒè¯è¡¨å•æ•°æ®"></a>éªŒè¯è¡¨å•æ•°æ®</h6><ol>
<li>åœ¨ <code>/schema/artcate.js</code> éªŒè¯è§„åˆ™æ¨¡å—ä¸­ï¼Œä½¿ç”¨ <code>exports</code> å‘å¤–å…±äº«å¦‚ä¸‹çš„ <code>éªŒè¯è§„åˆ™å¯¹è±¡</code>ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ ¡éªŒè§„åˆ™å¯¹è±¡ - æ›´æ–°åˆ†ç±»</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">update_cate_schema</span> = &#123;</span><br><span class="line">  <span class="attr">body</span>: &#123;</span><br><span class="line">    <span class="title class_">Id</span>: id,</span><br><span class="line">    name,</span><br><span class="line">    alias,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>åœ¨ <code>/router/artcate.js</code> æ¨¡å—ä¸­ï¼Œå¯¼å…¥éœ€è¦çš„éªŒè¯è§„åˆ™å¯¹è±¡ï¼Œå¹¶åœ¨è·¯ç”±ä¸­ä½¿ç”¨ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥æ›´æ–°æ–‡ç« åˆ†ç±»çš„éªŒè¯è§„åˆ™å¯¹è±¡</span></span><br><span class="line"><span class="keyword">const</span> &#123; update_cate_schema &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../schema/artcate&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ›´æ–°æ–‡ç« åˆ†ç±»çš„è·¯ç”±</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/updatecate&#x27;</span>, <span class="title function_">expressJoi</span>(update_cate_schema), artcate_handler.<span class="property">updateCateById</span>)</span><br></pre></td></tr></table></figure>

<h6 id="æŸ¥è¯¢åˆ†ç±»åç§°ä¸åˆ«åæ˜¯å¦è¢«å ç”¨-1"><a href="#æŸ¥è¯¢åˆ†ç±»åç§°ä¸åˆ«åæ˜¯å¦è¢«å ç”¨-1" class="headerlink" title="æŸ¥è¯¢åˆ†ç±»åç§°ä¸åˆ«åæ˜¯å¦è¢«å ç”¨"></a>æŸ¥è¯¢åˆ†ç±»åç§°ä¸åˆ«åæ˜¯å¦è¢«å ç”¨</h6><ol>
<li>å®šä¹‰æŸ¥é‡çš„ SQL è¯­å¥ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰æŸ¥è¯¢ åˆ†ç±»åç§° ä¸ åˆ†ç±»åˆ«å æ˜¯å¦è¢«å ç”¨çš„ SQL è¯­å¥</span></span><br><span class="line"><span class="keyword">const</span> sql = <span class="string">`select * from ev_article_cate where Id&lt;&gt;? and (name=? or alias=?)`</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>è°ƒç”¨ <code>db.query()</code> æ‰§è¡ŒæŸ¥é‡çš„æ“ä½œï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ‰§è¡ŒæŸ¥é‡æ“ä½œ</span></span><br><span class="line">db.<span class="title function_">query</span>(sql, [req.<span class="property">body</span>.<span class="property">Id</span>, req.<span class="property">body</span>.<span class="property">name</span>, req.<span class="property">body</span>.<span class="property">alias</span>], <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// æ‰§è¡Œ SQL è¯­å¥å¤±è´¥</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// åˆ¤æ–­ åˆ†ç±»åç§° å’Œ åˆ†ç±»åˆ«å æ˜¯å¦è¢«å ç”¨</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">length</span> === <span class="number">2</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;åˆ†ç±»åç§°ä¸åˆ«åè¢«å ç”¨ï¼Œè¯·æ›´æ¢åé‡è¯•ï¼&#x27;</span>)</span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">length</span> === <span class="number">1</span> &amp;&amp; results[<span class="number">0</span>].<span class="property">name</span> === req.<span class="property">body</span>.<span class="property">name</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;åˆ†ç±»åç§°è¢«å ç”¨ï¼Œè¯·æ›´æ¢åé‡è¯•ï¼&#x27;</span>)</span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">length</span> === <span class="number">1</span> &amp;&amp; results[<span class="number">0</span>].<span class="property">alias</span> === req.<span class="property">body</span>.<span class="property">alias</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;åˆ†ç±»åˆ«åè¢«å ç”¨ï¼Œè¯·æ›´æ¢åé‡è¯•ï¼&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// TODOï¼šæ›´æ–°æ–‡ç« åˆ†ç±»</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h6 id="å®ç°æ›´æ–°æ–‡ç« åˆ†ç±»çš„åŠŸèƒ½"><a href="#å®ç°æ›´æ–°æ–‡ç« åˆ†ç±»çš„åŠŸèƒ½" class="headerlink" title="å®ç°æ›´æ–°æ–‡ç« åˆ†ç±»çš„åŠŸèƒ½"></a>å®ç°æ›´æ–°æ–‡ç« åˆ†ç±»çš„åŠŸèƒ½</h6><ol>
<li>å®šä¹‰æ›´æ–°æ–‡ç« åˆ†ç±»çš„ SQL è¯­å¥ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sql = <span class="string">`update ev_article_cate set ? where Id=?`</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>è°ƒç”¨ <code>db.query()</code> æ‰§è¡Œ SQL è¯­å¥ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">db.<span class="title function_">query</span>(sql, [req.<span class="property">body</span>, req.<span class="property">body</span>.<span class="property">Id</span>], <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// æ‰§è¡Œ SQL è¯­å¥å¤±è´¥</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// SQL è¯­å¥æ‰§è¡ŒæˆåŠŸï¼Œä½†æ˜¯å½±å“è¡Œæ•°ä¸ç­‰äº 1</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">affectedRows</span> !== <span class="number">1</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;æ›´æ–°æ–‡ç« åˆ†ç±»å¤±è´¥ï¼&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ›´æ–°æ–‡ç« åˆ†ç±»æˆåŠŸ</span></span><br><span class="line">  res.<span class="title function_">cc</span>(<span class="string">&#x27;æ›´æ–°æ–‡ç« åˆ†ç±»æˆåŠŸï¼&#x27;</span>, <span class="number">0</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="æ–‡ç« ç®¡ç†"><a href="#æ–‡ç« ç®¡ç†" class="headerlink" title="æ–‡ç« ç®¡ç†"></a>æ–‡ç« ç®¡ç†</h4><h5 id="æ–°å»º-ev-articles-è¡¨"><a href="#æ–°å»º-ev-articles-è¡¨" class="headerlink" title="æ–°å»º ev_articles è¡¨"></a>æ–°å»º ev_articles è¡¨</h5>

<h5 id="å‘å¸ƒæ–°æ–‡ç« "><a href="#å‘å¸ƒæ–°æ–‡ç« " class="headerlink" title="å‘å¸ƒæ–°æ–‡ç« "></a>å‘å¸ƒæ–°æ–‡ç« </h5><h6 id="å®ç°æ­¥éª¤-11"><a href="#å®ç°æ­¥éª¤-11" class="headerlink" title="å®ç°æ­¥éª¤"></a>å®ç°æ­¥éª¤</h6><ol>
<li>åˆå§‹åŒ–è·¯ç”±æ¨¡å—</li>
<li>åˆå§‹åŒ–è·¯ç”±å¤„ç†å‡½æ•°æ¨¡å—</li>
<li>ä½¿ç”¨ multer è§£æè¡¨å•æ•°æ®</li>
<li>éªŒè¯è¡¨å•æ•°æ®</li>
<li>å®ç°å‘å¸ƒæ–‡ç« çš„åŠŸèƒ½</li>
</ol>
<h6 id="åˆå§‹åŒ–è·¯ç”±æ¨¡å—-2"><a href="#åˆå§‹åŒ–è·¯ç”±æ¨¡å—-2" class="headerlink" title="åˆå§‹åŒ–è·¯ç”±æ¨¡å—"></a>åˆå§‹åŒ–è·¯ç”±æ¨¡å—</h6><ol>
<li>åˆ›å»º <code>/router/article.js</code> è·¯ç”±æ¨¡å—ï¼Œå¹¶åˆå§‹åŒ–å¦‚ä¸‹çš„ä»£ç ç»“æ„ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥ express</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="comment">// åˆ›å»ºè·¯ç”±å¯¹è±¡</span></span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‘å¸ƒæ–°æ–‡ç« </span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/add&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‘å¤–å…±äº«è·¯ç”±å¯¹è±¡</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>åœ¨ <code>app.js</code> ä¸­å¯¼å…¥å¹¶ä½¿ç”¨æ–‡ç« çš„è·¯ç”±æ¨¡å—ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥å¹¶ä½¿ç”¨æ–‡ç« è·¯ç”±æ¨¡å—</span></span><br><span class="line"><span class="keyword">const</span> articleRouter = <span class="built_in">require</span>(<span class="string">&#x27;./router/article&#x27;</span>)</span><br><span class="line"><span class="comment">// ä¸ºæ–‡ç« çš„è·¯ç”±æŒ‚è½½ç»Ÿä¸€çš„è®¿é—®å‰ç¼€ /my/article</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/my/article&#x27;</span>, articleRouter)</span><br></pre></td></tr></table></figure>

<h6 id="åˆå§‹åŒ–è·¯ç”±å¤„ç†å‡½æ•°æ¨¡å—-1"><a href="#åˆå§‹åŒ–è·¯ç”±å¤„ç†å‡½æ•°æ¨¡å—-1" class="headerlink" title="åˆå§‹åŒ–è·¯ç”±å¤„ç†å‡½æ•°æ¨¡å—"></a>åˆå§‹åŒ–è·¯ç”±å¤„ç†å‡½æ•°æ¨¡å—</h6><ol>
<li>åˆ›å»º <code>/router_handler/article.js</code> è·¯ç”±å¤„ç†å‡½æ•°æ¨¡å—ï¼Œå¹¶åˆå§‹åŒ–å¦‚ä¸‹çš„ä»£ç ç»“æ„ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‘å¸ƒæ–°æ–‡ç« çš„å¤„ç†å‡½æ•°</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">addArticle</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>ä¿®æ”¹ <code>/router/article.js</code> ä¸­çš„ä»£ç å¦‚ä¸‹ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¼å…¥æ–‡ç« çš„è·¯ç”±å¤„ç†å‡½æ•°æ¨¡å—</span></span><br><span class="line"><span class="keyword">const</span> article_handler = <span class="built_in">require</span>(<span class="string">&#x27;../router_handler/article&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‘å¸ƒæ–°æ–‡ç« </span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/add&#x27;</span>, article_handler.<span class="property">addArticle</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router</span><br></pre></td></tr></table></figure>

<h6 id="ä½¿ç”¨-multer-è§£æè¡¨å•æ•°æ®"><a href="#ä½¿ç”¨-multer-è§£æè¡¨å•æ•°æ®" class="headerlink" title="ä½¿ç”¨ multer è§£æè¡¨å•æ•°æ®"></a>ä½¿ç”¨ multer è§£æè¡¨å•æ•°æ®</h6><blockquote>
<p>æ³¨æ„ï¼šä½¿ç”¨ <code>express.urlencoded()</code> ä¸­é—´ä»¶æ— æ³•è§£æ <code>multipart/form-data</code> æ ¼å¼çš„è¯·æ±‚ä½“æ•°æ®ã€‚</p>
</blockquote>
<blockquote>
<p>å½“å‰é¡¹ç›®ï¼Œæ¨èä½¿ç”¨ multer æ¥è§£æ <code>multipart/form-data</code> æ ¼å¼çš„è¡¨å•æ•°æ®ã€‚<a target="_blank" rel="noopener" href="https://www.npmjs.com/package/multer">https://www.npmjs.com/package/multer</a></p>
</blockquote>
<ol>
<li>è¿è¡Œå¦‚ä¸‹çš„ç»ˆç«¯å‘½ä»¤ï¼Œåœ¨é¡¹ç›®ä¸­å®‰è£… <code>multer</code>ï¼š</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i multer@1.4.2</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>åœ¨ <code>/router_handler/article.js</code> æ¨¡å—ä¸­å¯¼å…¥å¹¶é…ç½® <code>multer</code>ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥è§£æ formdata æ ¼å¼è¡¨å•æ•°æ®çš„åŒ…</span></span><br><span class="line"><span class="keyword">const</span> multer = <span class="built_in">require</span>(<span class="string">&#x27;multer&#x27;</span>)</span><br><span class="line"><span class="comment">// å¯¼å…¥å¤„ç†è·¯å¾„çš„æ ¸å¿ƒæ¨¡å—</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»º multer çš„å®ä¾‹å¯¹è±¡ï¼Œé€šè¿‡ dest å±æ€§æŒ‡å®šæ–‡ä»¶çš„å­˜æ”¾è·¯å¾„</span></span><br><span class="line"><span class="keyword">const</span> upload = <span class="title function_">multer</span>(&#123; <span class="attr">dest</span>: path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;../uploads&#x27;</span>) &#125;)</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>ä¿®æ”¹ <code>å‘å¸ƒæ–°æ–‡ç« </code> çš„è·¯ç”±å¦‚ä¸‹ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‘å¸ƒæ–°æ–‡ç« çš„è·¯ç”±</span></span><br><span class="line"><span class="comment">// upload.single() æ˜¯ä¸€ä¸ªå±€éƒ¨ç”Ÿæ•ˆçš„ä¸­é—´ä»¶ï¼Œç”¨æ¥è§£æ FormData æ ¼å¼çš„è¡¨å•æ•°æ®</span></span><br><span class="line"><span class="comment">// å°†æ–‡ä»¶ç±»å‹çš„æ•°æ®ï¼Œè§£æå¹¶æŒ‚è½½åˆ° req.file å±æ€§ä¸­</span></span><br><span class="line"><span class="comment">// å°†æ–‡æœ¬ç±»å‹çš„æ•°æ®ï¼Œè§£æå¹¶æŒ‚è½½åˆ° req.body å±æ€§ä¸­</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/add&#x27;</span>, upload.<span class="title function_">single</span>(<span class="string">&#x27;cover_img&#x27;</span>), article_handler.<span class="property">addArticle</span>)</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>åœ¨ <code>/router_handler/article.js</code> æ¨¡å—ä¸­çš„ <code>addArticle</code> å¤„ç†å‡½æ•°ä¸­ï¼Œå°† <code>multer</code> è§£æå‡ºæ¥çš„æ•°æ®è¿›è¡Œæ‰“å°ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‘å¸ƒæ–°æ–‡ç« çš„å¤„ç†å‡½æ•°</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">addArticle</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">body</span>) <span class="comment">// æ–‡æœ¬ç±»å‹çš„æ•°æ®</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;--------åˆ†å‰²çº¿----------&#x27;</span>)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">file</span>) <span class="comment">// æ–‡ä»¶ç±»å‹çš„æ•°æ®</span></span><br><span class="line"></span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h6 id="éªŒè¯è¡¨å•æ•°æ®-7"><a href="#éªŒè¯è¡¨å•æ•°æ®-7" class="headerlink" title="éªŒè¯è¡¨å•æ•°æ®"></a>éªŒè¯è¡¨å•æ•°æ®</h6><blockquote>
<p>å®ç°æ€è·¯ï¼šé€šè¿‡ express-joi <strong>è‡ªåŠ¨éªŒè¯</strong> req.body ä¸­çš„æ–‡æœ¬æ•°æ®ï¼›é€šè¿‡ if åˆ¤æ–­<strong>æ‰‹åŠ¨éªŒè¯</strong> req.file ä¸­çš„æ–‡ä»¶æ•°æ®ï¼›</p>
</blockquote>
<ol>
<li>åˆ›å»º <code>/schema/article.js</code> éªŒè¯è§„åˆ™æ¨¡å—ï¼Œå¹¶åˆå§‹åŒ–å¦‚ä¸‹çš„ä»£ç ç»“æ„ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥å®šä¹‰éªŒè¯è§„åˆ™çš„æ¨¡å—</span></span><br><span class="line"><span class="keyword">const</span> joi = <span class="built_in">require</span>(<span class="string">&#x27;@hapi/joi&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ æ ‡é¢˜ã€åˆ†ç±»Idã€å†…å®¹ã€å‘å¸ƒçŠ¶æ€ çš„éªŒè¯è§„åˆ™</span></span><br><span class="line"><span class="keyword">const</span> title = joi.<span class="title function_">string</span>().required()</span><br><span class="line"><span class="keyword">const</span> cate_id = joi.<span class="title function_">number</span>().<span class="title function_">integer</span>().<span class="title function_">min</span>(<span class="number">1</span>).required()</span><br><span class="line"><span class="keyword">const</span> content = joi.<span class="title function_">string</span>().required().<span class="title function_">allow</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> state = joi.<span class="title function_">string</span>().<span class="title function_">valid</span>(<span class="string">&#x27;å·²å‘å¸ƒ&#x27;</span>, <span class="string">&#x27;è‰ç¨¿&#x27;</span>).required()</span><br><span class="line"></span><br><span class="line"><span class="comment">// éªŒè¯è§„åˆ™å¯¹è±¡ - å‘å¸ƒæ–‡ç« </span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">add_article_schema</span> = &#123;</span><br><span class="line">  <span class="attr">body</span>: &#123;</span><br><span class="line">    title,</span><br><span class="line">    cate_id,</span><br><span class="line">    content,</span><br><span class="line">    state,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>åœ¨ <code>/router/article.js</code> æ¨¡å—ä¸­ï¼Œå¯¼å…¥éœ€è¦çš„éªŒè¯è§„åˆ™å¯¹è±¡ï¼Œå¹¶åœ¨è·¯ç”±ä¸­ä½¿ç”¨ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥éªŒè¯æ•°æ®çš„ä¸­é—´ä»¶</span></span><br><span class="line"><span class="keyword">const</span> expressJoi = <span class="built_in">require</span>(<span class="string">&#x27;@escook/express-joi&#x27;</span>)</span><br><span class="line"><span class="comment">// å¯¼å…¥æ–‡ç« çš„éªŒè¯æ¨¡å—</span></span><br><span class="line"><span class="keyword">const</span> &#123; add_article_schema &#125; = <span class="built_in">require</span>(<span class="string">&#x27;../schema/article&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‘å¸ƒæ–°æ–‡ç« çš„è·¯ç”±</span></span><br><span class="line"><span class="comment">// æ³¨æ„ï¼šåœ¨å½“å‰çš„è·¯ç”±ä¸­ï¼Œå…ˆåä½¿ç”¨äº†ä¸¤ä¸ªä¸­é—´ä»¶ï¼š</span></span><br><span class="line"><span class="comment">//       å…ˆä½¿ç”¨ multer è§£æè¡¨å•æ•°æ®</span></span><br><span class="line"><span class="comment">//       å†ä½¿ç”¨ expressJoi å¯¹è§£æçš„è¡¨å•æ•°æ®è¿›è¡ŒéªŒè¯</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&#x27;/add&#x27;</span>, upload.<span class="title function_">single</span>(<span class="string">&#x27;cover_img&#x27;</span>), <span class="title function_">expressJoi</span>(add_article_schema), article_handler.<span class="property">addArticle</span>)</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>åœ¨ <code>/router_handler/article.js</code> æ¨¡å—ä¸­çš„ <code>addArticle</code> å¤„ç†å‡½æ•°ä¸­ï¼Œé€šè¿‡ <code>if</code> åˆ¤æ–­å®¢æˆ·ç«¯æ˜¯å¦æäº¤äº† <code>å°é¢å›¾ç‰‡</code>ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‘å¸ƒæ–°æ–‡ç« çš„å¤„ç†å‡½æ•°</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">addArticle</span> = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// æ‰‹åŠ¨åˆ¤æ–­æ˜¯å¦ä¸Šä¼ äº†æ–‡ç« å°é¢</span></span><br><span class="line">  <span class="keyword">if</span> (!req.<span class="property">file</span> || req.<span class="property">file</span>.<span class="property">fieldname</span> !== <span class="string">&#x27;cover_img&#x27;</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;æ–‡ç« å°é¢æ˜¯å¿…é€‰å‚æ•°ï¼&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// TODOï¼šè¡¨å•æ•°æ®åˆæ³•ï¼Œç»§ç»­åé¢çš„å¤„ç†æµç¨‹...</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h6 id="å®ç°å‘å¸ƒæ–‡ç« çš„åŠŸèƒ½"><a href="#å®ç°å‘å¸ƒæ–‡ç« çš„åŠŸèƒ½" class="headerlink" title="å®ç°å‘å¸ƒæ–‡ç« çš„åŠŸèƒ½"></a>å®ç°å‘å¸ƒæ–‡ç« çš„åŠŸèƒ½</h6><ol>
<li>æ•´ç†è¦æ’å…¥æ•°æ®åº“çš„æ–‡ç« ä¿¡æ¯å¯¹è±¡ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥å¤„ç†è·¯å¾„çš„ path æ ¸å¿ƒæ¨¡å—</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> articleInfo = &#123;</span><br><span class="line">  <span class="comment">// æ ‡é¢˜ã€å†…å®¹ã€çŠ¶æ€ã€æ‰€å±çš„åˆ†ç±»Id</span></span><br><span class="line">  ...req.<span class="property">body</span>,</span><br><span class="line">  <span class="comment">// æ–‡ç« å°é¢åœ¨æœåŠ¡å™¨ç«¯çš„å­˜æ”¾è·¯å¾„</span></span><br><span class="line">  <span class="attr">cover_img</span>: path.<span class="title function_">join</span>(<span class="string">&#x27;/uploads&#x27;</span>, req.<span class="property">file</span>.<span class="property">filename</span>),</span><br><span class="line">  <span class="comment">// æ–‡ç« å‘å¸ƒæ—¶é—´</span></span><br><span class="line">  <span class="attr">pub_date</span>: <span class="keyword">new</span> <span class="title class_">Date</span>(),</span><br><span class="line">  <span class="comment">// æ–‡ç« ä½œè€…çš„Id</span></span><br><span class="line">  <span class="attr">author_id</span>: req.<span class="property">user</span>.<span class="property">id</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>å®šä¹‰å‘å¸ƒæ–‡ç« çš„ SQL è¯­å¥ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sql = <span class="string">`insert into ev_articles set ?`</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>è°ƒç”¨ <code>db.query()</code> æ‰§è¡Œå‘å¸ƒæ–‡ç« çš„ SQL è¯­å¥ï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥æ•°æ®åº“æ“ä½œæ¨¡å—</span></span><br><span class="line"><span class="keyword">const</span> db = <span class="built_in">require</span>(<span class="string">&#x27;../db/index&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‰§è¡Œ SQL è¯­å¥</span></span><br><span class="line">db.<span class="title function_">query</span>(sql, articleInfo, <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// æ‰§è¡Œ SQL è¯­å¥å¤±è´¥</span></span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> res.<span class="title function_">cc</span>(err)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ‰§è¡Œ SQL è¯­å¥æˆåŠŸï¼Œä½†æ˜¯å½±å“è¡Œæ•°ä¸ç­‰äº 1</span></span><br><span class="line">  <span class="keyword">if</span> (results.<span class="property">affectedRows</span> !== <span class="number">1</span>) <span class="keyword">return</span> res.<span class="title function_">cc</span>(<span class="string">&#x27;å‘å¸ƒæ–‡ç« å¤±è´¥ï¼&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å‘å¸ƒæ–‡ç« æˆåŠŸ</span></span><br><span class="line">  res.<span class="title function_">cc</span>(<span class="string">&#x27;å‘å¸ƒæ–‡ç« æˆåŠŸ&#x27;</span>, <span class="number">0</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>åœ¨ <code>app.js</code> ä¸­ï¼Œä½¿ç”¨ <code>express.static()</code> ä¸­é—´ä»¶ï¼Œå°† <code>uploads</code> ç›®å½•ä¸­çš„å›¾ç‰‡æ‰˜ç®¡ä¸ºé™æ€èµ„æºï¼š</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ‰˜ç®¡é™æ€èµ„æºæ–‡ä»¶</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/uploads&#x27;</span>, express.<span class="title function_">static</span>(<span class="string">&#x27;./uploads&#x27;</span>))</span><br></pre></td></tr></table></figure>
</script></p></blockquote></article><div class="post-copyright"><div class="post-copyright__title"><span class="post-copyright-info"><h>NodeJså­¦ä¹ ç¬”è®°(ä¸‹)</h></span></div><div class="post-copyright__type"><span class="post-copyright-info"><a href="https://ache-lie.github.io/blog/2023/03/29/29-NodeJs-2/">https://ache-lie.github.io/blog/2023/03/29/29-NodeJs-2/</a></span></div><div class="post-copyright-m"><div class="post-copyright-m-info"><div class="post-copyright-a"><h>ä½œè€…</h><div class="post-copyright-cc-info"><h>ache</h></div></div><div class="post-copyright-c"><h>å‘å¸ƒäº</h><div class="post-copyright-cc-info"><h>2023-03-29</h></div></div><div class="post-copyright-u"><h>æ›´æ–°äº</h><div class="post-copyright-cc-info"><h>2023-04-05</h></div></div><div class="post-copyright-c"><h>è®¸å¯åè®®</h><div class="post-copyright-cc-info"><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a rel="noopener" target="_blank" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></div></div></div></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/blog/tags/NodeJs/">NodeJs</a></div><div class="post_share"><div class="social-share" data-image="https://s1.ax1x.com/2023/03/29/ppgU1oR.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/blog/2023/03/29/29-NodeJs-1/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.ax1x.com/2023/03/29/ppgUaOe.jpg" onerror="onerror=null;src='https://s1.ax1x.com/2023/03/21/ppa9N6g.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">NodeJså­¦ä¹ ç¬”è®°(ä¸Š)</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><div><a href="/blog/2023/03/29/29-NodeJs-1/" title="NodeJså­¦ä¹ ç¬”è®°(ä¸Š)"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.ax1x.com/2023/03/29/ppgUaOe.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-29</div><div class="title">NodeJså­¦ä¹ ç¬”è®°(ä¸Š)</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.ax1x.com/2023/03/21/ppapDzD.jpg" onerror="this.onerror=null;this.src='https://s1.ax1x.com/2023/03/21/ppa9dmj.jpg'" alt="avatar"/></div><div class="author-info__name">ache</div><div class="author-info__description">æ¬¢è¿å…‰ä¸´ğŸ¨ğŸ°</div></div><div class="card-info-data site-data is-center"><a href="/blog/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">8</div></a><a href="/blog/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">7</div></a><a href="/blog/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://s1.ax1x.com/2023/03/21/ppaSXxe.jpg"><i class="far fa-image"></i><span>çœ‹çœ‹æˆ‘çš„ç…§ç‰‡</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://im.qq.com/" target="_blank" title="QQ"><i class="fab fa-qq"></i></a><a class="social-icon" href="https://wx.qq.com/" target="_blank" title="å¾®ä¿¡"><i class="fab fa-weixin"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><a class="faa-parent animated-hover"><svg class="faa-tada icon" style="height:25px;width:25px;fill:currentColor;position:relative;top:5px" aria-hidden="true"><use xlink:href="#icon-gonggao"></use></svg></a><span>å…¬å‘Šæ </span></div><div class="announcement_content">æˆ‘åœ¨æ¢¦ä¸­çš„æ¢¦ä¸­åˆåšäº†ä¸ªæ¢¦ğŸ¦„</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#npm%E4%B8%8E%E5%8C%85"><span class="toc-number">1.</span> <span class="toc-text">npmä¸åŒ…</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8C%85"><span class="toc-number">1.1.</span> <span class="toc-text">åŒ…</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8C%85%E7%9A%84%E6%9D%A5%E6%BA%90"><span class="toc-number">1.1.1.</span> <span class="toc-text">åŒ…çš„æ¥æº</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81%E5%8C%85"><span class="toc-number">1.1.2.</span> <span class="toc-text">ä¸ºä»€ä¹ˆéœ€è¦åŒ…</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%8E%E5%93%AA%E9%87%8C%E4%B8%8B%E8%BD%BD%E5%8C%85"><span class="toc-number">1.1.3.</span> <span class="toc-text">ä»å“ªé‡Œä¸‹è½½åŒ…</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E4%B8%8B%E8%BD%BD%E5%8C%85"><span class="toc-number">1.1.4.</span> <span class="toc-text">å¦‚ä½•ä¸‹è½½åŒ…</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#npm-%E5%88%9D%E4%BD%93%E9%AA%8C"><span class="toc-number">1.2.</span> <span class="toc-text">npm åˆä½“éªŒ</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%A0%BC%E5%BC%8F%E5%8C%96%E6%97%B6%E9%97%B4%E7%9A%84%E4%BC%A0%E7%BB%9F%E5%81%9A%E6%B3%95"><span class="toc-number">1.2.1.</span> <span class="toc-text">æ ¼å¼åŒ–æ—¶é—´çš„ä¼ ç»Ÿåšæ³•</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%A0%BC%E5%BC%8F%E5%8C%96%E6%97%B6%E9%97%B4%E7%9A%84%E9%AB%98%E7%BA%A7%E5%81%9A%E6%B3%95"><span class="toc-number">1.2.2.</span> <span class="toc-text">æ ¼å¼åŒ–æ—¶é—´çš„é«˜çº§åšæ³•</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%9C%A8%E9%A1%B9%E7%9B%AE%E4%B8%AD%E5%AE%89%E8%A3%85%E5%8C%85%E7%9A%84%E5%91%BD%E4%BB%A4"><span class="toc-number">1.2.3.</span> <span class="toc-text">åœ¨é¡¹ç›®ä¸­å®‰è£…åŒ…çš„å‘½ä»¤</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%9D%E6%AC%A1%E8%A3%85%E5%8C%85%E5%90%8E%E5%A4%9A%E4%BA%86%E5%93%AA%E4%BA%9B%E6%96%87%E4%BB%B6"><span class="toc-number">1.2.4.</span> <span class="toc-text">åˆæ¬¡è£…åŒ…åå¤šäº†å“ªäº›æ–‡ä»¶</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E6%8C%87%E5%AE%9A%E7%89%88%E6%9C%AC%E7%9A%84%E5%8C%85"><span class="toc-number">1.2.5.</span> <span class="toc-text">å®‰è£…æŒ‡å®šç‰ˆæœ¬çš„åŒ…</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8C%85%E7%9A%84%E8%AF%AD%E4%B9%89%E5%8C%96%E7%89%88%E6%9C%AC%E8%A7%84%E8%8C%83"><span class="toc-number">1.2.6.</span> <span class="toc-text">åŒ…çš„è¯­ä¹‰åŒ–ç‰ˆæœ¬è§„èŒƒ</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8C%85%E7%AE%A1%E7%90%86%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">1.3.</span> <span class="toc-text">åŒ…ç®¡ç†é…ç½®æ–‡ä»¶</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%A4%9A%E4%BA%BA%E5%8D%8F%E4%BD%9C%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">1.3.1.</span> <span class="toc-text">å¤šäººåä½œçš„é—®é¢˜</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%AE%B0%E5%BD%95%E9%A1%B9%E7%9B%AE%E4%B8%AD%E5%AE%89%E8%A3%85%E7%9A%84%E5%8C%85"><span class="toc-number">1.3.2.</span> <span class="toc-text">è®°å½•é¡¹ç›®ä¸­å®‰è£…çš„åŒ…</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%BF%AB%E9%80%9F%E5%88%9B%E5%BB%BA-package-json"><span class="toc-number">1.3.3.</span> <span class="toc-text">å¿«é€Ÿåˆ›å»º package.json</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#dependencies-%E8%8A%82%E7%82%B9"><span class="toc-number">1.3.4.</span> <span class="toc-text">dependencies èŠ‚ç‚¹</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%80%E6%AC%A1%E6%80%A7%E5%AE%89%E8%A3%85%E6%89%80%E6%9C%89%E7%9A%84%E5%8C%85"><span class="toc-number">1.3.5.</span> <span class="toc-text">ä¸€æ¬¡æ€§å®‰è£…æ‰€æœ‰çš„åŒ…</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8D%B8%E8%BD%BD%E5%8C%85"><span class="toc-number">1.3.6.</span> <span class="toc-text">å¸è½½åŒ…</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#devDependencies-%E8%8A%82%E7%82%B9"><span class="toc-number">1.3.7.</span> <span class="toc-text">devDependencies èŠ‚ç‚¹</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%E4%B8%8B%E5%8C%85%E9%80%9F%E5%BA%A6%E6%85%A2%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">1.4.</span> <span class="toc-text">è§£å†³ä¸‹åŒ…é€Ÿåº¦æ…¢çš„é—®é¢˜</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E4%B8%8B%E5%8C%85%E9%80%9F%E5%BA%A6%E6%85%A2"><span class="toc-number">1.4.1.</span> <span class="toc-text">ä¸ºä»€ä¹ˆä¸‹åŒ…é€Ÿåº¦æ…¢</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B7%98%E5%AE%9D-NPM-%E9%95%9C%E5%83%8F%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">1.4.2.</span> <span class="toc-text">æ·˜å® NPM é•œåƒæœåŠ¡å™¨</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%87%E6%8D%A2-npm-%E7%9A%84%E4%B8%8B%E5%8C%85%E9%95%9C%E5%83%8F%E6%BA%90"><span class="toc-number">1.4.3.</span> <span class="toc-text">åˆ‡æ¢ npm çš„ä¸‹åŒ…é•œåƒæº</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#nrm"><span class="toc-number">1.4.4.</span> <span class="toc-text">nrm</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8C%85%E7%9A%84%E5%88%86%E7%B1%BB"><span class="toc-number">1.5.</span> <span class="toc-text">åŒ…çš„åˆ†ç±»</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E5%8C%85"><span class="toc-number">1.5.1.</span> <span class="toc-text">é¡¹ç›®åŒ…</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%A8%E5%B1%80%E5%8C%85"><span class="toc-number">1.5.2.</span> <span class="toc-text">å…¨å±€åŒ…</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#i5ting-toc"><span class="toc-number">1.5.3.</span> <span class="toc-text">i5ting_toc</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%84%E8%8C%83%E7%9A%84%E5%8C%85%E7%BB%93%E6%9E%84"><span class="toc-number">1.6.</span> <span class="toc-text">è§„èŒƒçš„åŒ…ç»“æ„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BC%80%E5%8F%91%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84%E5%8C%85"><span class="toc-number">1.7.</span> <span class="toc-text">å¼€å‘å±äºè‡ªå·±çš„åŒ…</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%9C%80%E8%A6%81%E5%AE%9E%E7%8E%B0%E7%9A%84%E5%8A%9F%E8%83%BD"><span class="toc-number">1.7.1.</span> <span class="toc-text">éœ€è¦å®ç°çš„åŠŸèƒ½</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96%E5%8C%85%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%BB%93%E6%9E%84"><span class="toc-number">1.7.2.</span> <span class="toc-text">åˆå§‹åŒ–åŒ…çš„åŸºæœ¬ç»“æ„</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96-package-json"><span class="toc-number">1.7.3.</span> <span class="toc-text">åˆå§‹åŒ– package.json</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%A0%BC%E5%BC%8F%E5%8C%96%E6%97%B6%E9%97%B4%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-number">1.7.4.</span> <span class="toc-text">æ ¼å¼åŒ–æ—¶é—´çš„æ–¹æ³•</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%BD%AC%E4%B9%89-HTML-%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-number">1.7.5.</span> <span class="toc-text">è½¬ä¹‰ HTML çš„æ–¹æ³•</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%BF%98%E5%8E%9F-HTML-%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-number">1.7.6.</span> <span class="toc-text">è¿˜åŸ HTML çš„æ–¹æ³•</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97%E5%8C%96%E6%8B%86%E5%88%86"><span class="toc-number">1.7.7.</span> <span class="toc-text">æ¨¡å—åŒ–æ‹†åˆ†</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BC%96%E5%86%99%E5%8C%85%E7%9A%84%E8%AF%B4%E6%98%8E%E6%96%87%E6%A1%A3"><span class="toc-number">1.7.8.</span> <span class="toc-text">ç¼–å†™åŒ…çš„è¯´æ˜æ–‡æ¡£</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B0%86%E4%B8%8D%E5%90%8C%E7%9A%84%E5%8A%9F%E8%83%BD%E8%BF%9B%E8%A1%8C%E6%A8%A1%E5%9D%97%E5%8C%96%E6%8B%86%E5%88%86"><span class="toc-number">1.8.</span> <span class="toc-text">å°†ä¸åŒçš„åŠŸèƒ½è¿›è¡Œæ¨¡å—åŒ–æ‹†åˆ†</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B3%A8%E5%86%8C-npm-%E8%B4%A6%E5%8F%B7"><span class="toc-number">1.8.1.</span> <span class="toc-text">æ³¨å†Œ npm è´¦å·</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%99%BB%E5%BD%95-npm-%E8%B4%A6%E5%8F%B7"><span class="toc-number">1.8.2.</span> <span class="toc-text">ç™»å½• npm è´¦å·</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%8A%8A%E5%8C%85%E5%8F%91%E5%B8%83%E5%88%B0-npm-%E4%B8%8A"><span class="toc-number">1.8.3.</span> <span class="toc-text">æŠŠåŒ…å‘å¸ƒåˆ° npm ä¸Š</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E5%B7%B2%E5%8F%91%E5%B8%83%E7%9A%84%E5%8C%85"><span class="toc-number">1.8.4.</span> <span class="toc-text">åˆ é™¤å·²å‘å¸ƒçš„åŒ…</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97%E7%9A%84%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6"><span class="toc-number">2.</span> <span class="toc-text">æ¨¡å—çš„åŠ è½½æœºåˆ¶</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BC%98%E5%85%88%E4%BB%8E%E7%BC%93%E5%AD%98%E4%B8%AD%E5%8A%A0%E8%BD%BD"><span class="toc-number">2.1.</span> <span class="toc-text">ä¼˜å…ˆä»ç¼“å­˜ä¸­åŠ è½½</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97%E7%9A%84%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6"><span class="toc-number">2.2.</span> <span class="toc-text">å†…ç½®æ¨¡å—çš„åŠ è½½æœºåˆ¶</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%A8%A1%E5%9D%97%E7%9A%84%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6"><span class="toc-number">2.3.</span> <span class="toc-text">è‡ªå®šä¹‰æ¨¡å—çš„åŠ è½½æœºåˆ¶</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E6%96%B9%E6%A8%A1%E5%9D%97%E7%9A%84%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6"><span class="toc-number">2.4.</span> <span class="toc-text">ç¬¬ä¸‰æ–¹æ¨¡å—çš„åŠ è½½æœºåˆ¶</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95%E4%BD%9C%E4%B8%BA%E6%A8%A1%E5%9D%97"><span class="toc-number">2.5.</span> <span class="toc-text">ç›®å½•ä½œä¸ºæ¨¡å—</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Express"><span class="toc-number">3.</span> <span class="toc-text">Express</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Express-%E7%AE%80%E4%BB%8B"><span class="toc-number">3.1.</span> <span class="toc-text">Express ç®€ä»‹</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF-Express"><span class="toc-number">3.1.1.</span> <span class="toc-text">ä»€ä¹ˆæ˜¯ Express</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%BF%9B%E4%B8%80%E6%AD%A5%E7%90%86%E8%A7%A3-Express"><span class="toc-number">3.1.2.</span> <span class="toc-text">è¿›ä¸€æ­¥ç†è§£ Express</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Express-%E8%83%BD%E5%81%9A%E4%BB%80%E4%B9%88"><span class="toc-number">3.1.3.</span> <span class="toc-text">Express èƒ½åšä»€ä¹ˆ</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Express-%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-number">3.2.</span> <span class="toc-text">Express çš„åŸºæœ¬ä½¿ç”¨</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%89%E8%A3%85"><span class="toc-number">3.2.1.</span> <span class="toc-text">å®‰è£…</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%9F%BA%E6%9C%AC%E7%9A%84-Web-%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">3.2.2.</span> <span class="toc-text">åˆ›å»ºåŸºæœ¬çš„ Web æœåŠ¡å™¨</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%9B%91%E5%90%AC-GET-%E8%AF%B7%E6%B1%82"><span class="toc-number">3.2.3.</span> <span class="toc-text">ç›‘å¬ GET è¯·æ±‚</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%8A%8A%E5%86%85%E5%AE%B9%E5%93%8D%E5%BA%94%E7%BB%99%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="toc-number">3.2.4.</span> <span class="toc-text">æŠŠå†…å®¹å“åº”ç»™å®¢æˆ·ç«¯</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%9B%91%E5%90%AC-POST-%E8%AF%B7%E6%B1%82"><span class="toc-number">3.2.5.</span> <span class="toc-text">ç›‘å¬ POST è¯·æ±‚</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96-URL-%E4%B8%AD%E6%90%BA%E5%B8%A6%E7%9A%84%E6%9F%A5%E8%AF%A2%E5%8F%82%E6%95%B0"><span class="toc-number">3.2.6.</span> <span class="toc-text">è·å– URL ä¸­æºå¸¦çš„æŸ¥è¯¢å‚æ•°</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96-URL-%E4%B8%AD%E7%9A%84%E5%8A%A8%E6%80%81%E5%8F%82%E6%95%B0"><span class="toc-number">3.2.7.</span> <span class="toc-text">è·å– URL ä¸­çš„åŠ¨æ€å‚æ•°</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%8C%E6%95%B4%E4%BB%A3%E7%A0%81"><span class="toc-number">3.2.8.</span> <span class="toc-text">å®Œæ•´ä»£ç </span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%98%E7%AE%A1%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90"><span class="toc-number">3.3.</span> <span class="toc-text">æ‰˜ç®¡é™æ€èµ„æº</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#express-static"><span class="toc-number">3.3.1.</span> <span class="toc-text">express.static()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%89%98%E7%AE%A1%E5%A4%9A%E4%B8%AA%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E7%9B%AE%E5%BD%95"><span class="toc-number">3.3.2.</span> <span class="toc-text">æ‰˜ç®¡å¤šä¸ªé™æ€èµ„æºç›®å½•</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%8C%82%E8%BD%BD%E8%B7%AF%E5%BE%84%E5%89%8D%E7%BC%80"><span class="toc-number">3.3.3.</span> <span class="toc-text">æŒ‚è½½è·¯å¾„å‰ç¼€</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#nodemon"><span class="toc-number">3.3.4.</span> <span class="toc-text">nodemon</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E4%BD%BF%E7%94%A8-nodemon"><span class="toc-number">3.3.4.1.</span> <span class="toc-text">ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ nodemon</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-nodemon"><span class="toc-number">3.3.4.2.</span> <span class="toc-text">å®‰è£… nodemon</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-nodemon"><span class="toc-number">3.3.4.3.</span> <span class="toc-text">ä½¿ç”¨ nodemon</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Express-%E8%B7%AF%E7%94%B1"><span class="toc-number">3.4.</span> <span class="toc-text">Express è·¯ç”±</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E7%9A%84%E6%A6%82%E5%BF%B5"><span class="toc-number">3.4.1.</span> <span class="toc-text">è·¯ç”±çš„æ¦‚å¿µ</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E8%B7%AF%E7%94%B1"><span class="toc-number">3.4.1.1.</span> <span class="toc-text">ä»€ä¹ˆæ˜¯è·¯ç”±</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%8E%B0%E5%AE%9E%E7%94%9F%E6%B4%BB%E4%B8%AD%E7%9A%84%E8%B7%AF%E7%94%B1"><span class="toc-number">3.4.1.2.</span> <span class="toc-text">ç°å®ç”Ÿæ´»ä¸­çš„è·¯ç”±</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Express-%E4%B8%AD%E7%9A%84%E8%B7%AF%E7%94%B1"><span class="toc-number">3.4.1.3.</span> <span class="toc-text">Express ä¸­çš„è·¯ç”±</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Express-%E4%B8%AD%E7%9A%84%E8%B7%AF%E7%94%B1%E7%9A%84%E4%BE%8B%E5%AD%90"><span class="toc-number">3.4.1.4.</span> <span class="toc-text">Express ä¸­çš„è·¯ç”±çš„ä¾‹å­</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E7%9A%84%E5%8C%B9%E9%85%8D%E8%BF%87%E7%A8%8B"><span class="toc-number">3.4.1.5.</span> <span class="toc-text">è·¯ç”±çš„åŒ¹é…è¿‡ç¨‹</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">3.4.2.</span> <span class="toc-text">è·¯ç”±çš„ä½¿ç”¨</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%9C%80%E7%AE%80%E5%8D%95%E7%9A%84%E7%94%A8%E6%B3%95"><span class="toc-number">3.4.2.1.</span> <span class="toc-text">æœ€ç®€å•çš„ç”¨æ³•</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97%E5%8C%96%E8%B7%AF%E7%94%B1"><span class="toc-number">3.4.2.2.</span> <span class="toc-text">æ¨¡å—åŒ–è·¯ç”±</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E8%B7%AF%E7%94%B1%E6%A8%A1%E5%9D%97"><span class="toc-number">3.4.2.3.</span> <span class="toc-text">åˆ›å»ºè·¯ç”±æ¨¡å—</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%B3%A8%E5%86%8C%E8%B7%AF%E7%94%B1%E6%A8%A1%E5%9D%97"><span class="toc-number">3.4.2.4.</span> <span class="toc-text">æ³¨å†Œè·¯ç”±æ¨¡å—</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%B8%BA%E8%B7%AF%E7%94%B1%E6%A8%A1%E5%9D%97%E6%B7%BB%E5%8A%A0%E5%89%8D%E7%BC%80"><span class="toc-number">3.4.2.5.</span> <span class="toc-text">ä¸ºè·¯ç”±æ¨¡å—æ·»åŠ å‰ç¼€</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%AD%E9%97%B4%E4%BB%B6%E7%9A%84%E6%A6%82%E5%BF%B5"><span class="toc-number">3.4.3.</span> <span class="toc-text">ä¸­é—´ä»¶çš„æ¦‚å¿µ</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">3.4.3.1.</span> <span class="toc-text">ä»€ä¹ˆæ˜¯ä¸­é—´ä»¶</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%8E%B0%E5%AE%9E%E7%94%9F%E6%B4%BB%E4%B8%AD%E7%9A%84%E4%BE%8B%E5%AD%90"><span class="toc-number">3.4.3.2.</span> <span class="toc-text">ç°å®ç”Ÿæ´»ä¸­çš„ä¾‹å­</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Express-%E4%B8%AD%E9%97%B4%E4%BB%B6%E7%9A%84%E8%B0%83%E7%94%A8%E6%B5%81%E7%A8%8B"><span class="toc-number">3.4.3.3.</span> <span class="toc-text">Express ä¸­é—´ä»¶çš„è°ƒç”¨æµç¨‹</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#Express-%E4%B8%AD%E9%97%B4%E4%BB%B6%E7%9A%84%E6%A0%BC%E5%BC%8F"><span class="toc-number">3.4.3.4.</span> <span class="toc-text">Express ä¸­é—´ä»¶çš„æ ¼å¼</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#next-%E5%87%BD%E6%95%B0%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-number">3.4.3.5.</span> <span class="toc-text">next å‡½æ•°çš„ä½œç”¨</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Express-%E4%B8%AD%E9%97%B4%E4%BB%B6%E7%9A%84%E5%88%9D%E4%BD%93%E9%AA%8C"><span class="toc-number">3.5.</span> <span class="toc-text">Express ä¸­é—´ä»¶çš„åˆä½“éªŒ</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E4%B8%AD%E9%97%B4%E4%BB%B6%E5%87%BD%E6%95%B0"><span class="toc-number">3.5.1.</span> <span class="toc-text">å®šä¹‰ä¸­é—´ä»¶å‡½æ•°</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%A8%E5%B1%80%E7%94%9F%E6%95%88%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">3.5.2.</span> <span class="toc-text">å…¨å±€ç”Ÿæ•ˆçš„ä¸­é—´ä»¶</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E5%85%A8%E5%B1%80%E4%B8%AD%E9%97%B4%E4%BB%B6%E7%9A%84%E7%AE%80%E5%8C%96%E5%BD%A2%E5%BC%8F"><span class="toc-number">3.5.3.</span> <span class="toc-text">å®šä¹‰å…¨å±€ä¸­é—´ä»¶çš„ç®€åŒ–å½¢å¼</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%AD%E9%97%B4%E4%BB%B6%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-number">3.5.4.</span> <span class="toc-text">ä¸­é—´ä»¶çš„ä½œç”¨</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E5%A4%9A%E4%B8%AA%E5%85%A8%E5%B1%80%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">3.5.5.</span> <span class="toc-text">å®šä¹‰å¤šä¸ªå…¨å±€ä¸­é—´ä»¶</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B1%80%E9%83%A8%E7%94%9F%E6%95%88%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">3.5.6.</span> <span class="toc-text">å±€éƒ¨ç”Ÿæ•ˆçš„ä¸­é—´ä»¶</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E5%A4%9A%E4%B8%AA%E5%B1%80%E9%83%A8%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">3.5.7.</span> <span class="toc-text">å®šä¹‰å¤šä¸ªå±€éƒ¨ä¸­é—´ä»¶</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BA%86%E8%A7%A3%E4%B8%AD%E9%97%B4%E4%BB%B6%E7%9A%845%E4%B8%AA%E4%BD%BF%E7%94%A8%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">3.5.8.</span> <span class="toc-text">äº†è§£ä¸­é—´ä»¶çš„5ä¸ªä½¿ç”¨æ³¨æ„äº‹é¡¹</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%AD%E9%97%B4%E4%BB%B6%E7%9A%84%E5%88%86%E7%B1%BB"><span class="toc-number">3.6.</span> <span class="toc-text">ä¸­é—´ä»¶çš„åˆ†ç±»</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E7%BA%A7%E5%88%AB%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">3.6.1.</span> <span class="toc-text">åº”ç”¨çº§åˆ«çš„ä¸­é—´ä»¶</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E7%BA%A7%E5%88%AB%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">3.6.2.</span> <span class="toc-text">è·¯ç”±çº§åˆ«çš„ä¸­é—´ä»¶</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%94%99%E8%AF%AF%E7%BA%A7%E5%88%AB%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">3.6.3.</span> <span class="toc-text">é”™è¯¯çº§åˆ«çš„ä¸­é—´ä»¶</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Express%E5%86%85%E7%BD%AE%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">3.6.4.</span> <span class="toc-text">Expresså†…ç½®çš„ä¸­é—´ä»¶</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E6%96%B9%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">3.6.5.</span> <span class="toc-text">ç¬¬ä¸‰æ–¹çš„ä¸­é—´ä»¶</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">3.7.</span> <span class="toc-text">è‡ªå®šä¹‰ä¸­é—´ä»¶</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%9C%80%E6%B1%82%E6%8F%8F%E8%BF%B0%E4%B8%8E%E5%AE%9E%E7%8E%B0%E6%AD%A5%E9%AA%A4"><span class="toc-number">3.7.1.</span> <span class="toc-text">éœ€æ±‚æè¿°ä¸å®ç°æ­¥éª¤</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">3.7.2.</span> <span class="toc-text">å®šä¹‰ä¸­é—´ä»¶</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%9B%91%E5%90%AC-req-%E7%9A%84-data-%E4%BA%8B%E4%BB%B6"><span class="toc-number">3.7.3.</span> <span class="toc-text">ç›‘å¬ req çš„ data äº‹ä»¶</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#querystring-%E8%A7%A3%E6%9E%90%E8%AF%B7%E6%B1%82%E4%BD%93%E6%95%B0%E6%8D%AE"><span class="toc-number">3.7.4.</span> <span class="toc-text">querystring è§£æè¯·æ±‚ä½“æ•°æ®</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B0%86%E8%A7%A3%E6%9E%90%E5%87%BA%E6%9D%A5%E7%9A%84%E6%95%B0%E6%8D%AE%E5%AF%B9%E8%B1%A1%E6%8C%82%E8%BD%BD%E4%B8%BA-req-body"><span class="toc-number">3.7.5.</span> <span class="toc-text">å°†è§£æå‡ºæ¥çš„æ•°æ®å¯¹è±¡æŒ‚è½½ä¸º req.body</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B0%86%E8%87%AA%E5%AE%9A%E4%B9%89%E4%B8%AD%E9%97%B4%E4%BB%B6%E5%B0%81%E8%A3%85%E4%B8%BA%E6%A8%A1%E5%9D%97"><span class="toc-number">3.7.6.</span> <span class="toc-text">å°†è‡ªå®šä¹‰ä¸­é—´ä»¶å°è£…ä¸ºæ¨¡å—</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-Express-%E5%86%99%E6%8E%A5%E5%8F%A3"><span class="toc-number">3.8.</span> <span class="toc-text">ä½¿ç”¨ Express å†™æ¥å£</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%9F%BA%E6%9C%AC%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">3.8.1.</span> <span class="toc-text">åˆ›å»ºåŸºæœ¬çš„æœåŠ¡å™¨</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA-API-%E8%B7%AF%E7%94%B1%E6%A8%A1%E5%9D%97"><span class="toc-number">3.8.2.</span> <span class="toc-text">åˆ›å»º API è·¯ç”±æ¨¡å—</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BC%96%E5%86%99-GET-%E6%8E%A5%E5%8F%A3"><span class="toc-number">3.8.3.</span> <span class="toc-text">ç¼–å†™ GET æ¥å£</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BC%96%E5%86%99-POST-%E6%8E%A5%E5%8F%A3"><span class="toc-number">3.8.4.</span> <span class="toc-text">ç¼–å†™ POST æ¥å£</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#CORS-%E8%B7%A8%E5%9F%9F%E8%B5%84%E6%BA%90%E5%85%B1%E4%BA%AB"><span class="toc-number">3.8.5.</span> <span class="toc-text">CORS è·¨åŸŸèµ„æºå…±äº«</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%8E%A5%E5%8F%A3%E7%9A%84%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98"><span class="toc-number">3.8.5.1.</span> <span class="toc-text">æ¥å£çš„è·¨åŸŸé—®é¢˜</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-cors-%E4%B8%AD%E9%97%B4%E4%BB%B6%E8%A7%A3%E5%86%B3%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98"><span class="toc-number">3.8.5.2.</span> <span class="toc-text">ä½¿ç”¨ cors ä¸­é—´ä»¶è§£å†³è·¨åŸŸé—®é¢˜</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF-CORS"><span class="toc-number">3.8.5.3.</span> <span class="toc-text">ä»€ä¹ˆæ˜¯ CORS</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#CORS-%E7%9A%84%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">3.8.5.4.</span> <span class="toc-text">CORS çš„æ³¨æ„äº‹é¡¹</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#CORS-%E5%93%8D%E5%BA%94%E5%A4%B4%E9%83%A8-Access-Control-Allow-Origin"><span class="toc-number">3.8.5.5.</span> <span class="toc-text">CORS å“åº”å¤´éƒ¨ - Access-Control-Allow-Origin</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#CORS-%E5%93%8D%E5%BA%94%E5%A4%B4%E9%83%A8-Access-Control-Allow-Origin-1"><span class="toc-number">3.8.5.6.</span> <span class="toc-text">CORS å“åº”å¤´éƒ¨ - Access-Control-Allow-Origin</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#CORS-%E5%93%8D%E5%BA%94%E5%A4%B4%E9%83%A8-Access-Control-Allow-Headers"><span class="toc-number">3.8.5.7.</span> <span class="toc-text">CORS å“åº”å¤´éƒ¨ - Access-Control-Allow-Headers</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#CORS-%E5%93%8D%E5%BA%94%E5%A4%B4%E9%83%A8-Access-Control-Allow-Methods"><span class="toc-number">3.8.5.8.</span> <span class="toc-text">CORS å“åº”å¤´éƒ¨ - Access-Control-Allow-Methods</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#CORS%E8%AF%B7%E6%B1%82%E7%9A%84%E5%88%86%E7%B1%BB"><span class="toc-number">3.8.5.9.</span> <span class="toc-text">CORSè¯·æ±‚çš„åˆ†ç±»</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E8%AF%B7%E6%B1%82"><span class="toc-number">3.8.5.10.</span> <span class="toc-text">ç®€å•è¯·æ±‚</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E9%A2%84%E6%A3%80%E8%AF%B7%E6%B1%82"><span class="toc-number">3.8.5.11.</span> <span class="toc-text">é¢„æ£€è¯·æ±‚</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E8%AF%B7%E6%B1%82%E5%92%8C%E9%A2%84%E6%A3%80%E8%AF%B7%E6%B1%82%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">3.8.5.12.</span> <span class="toc-text">ç®€å•è¯·æ±‚å’Œé¢„æ£€è¯·æ±‚çš„åŒºåˆ«</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#JSONP-%E6%8E%A5%E5%8F%A3"><span class="toc-number">3.8.6.</span> <span class="toc-text">JSONP æ¥å£</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%9B%9E%E9%A1%BE-JSONP-%E7%9A%84%E6%A6%82%E5%BF%B5%E4%B8%8E%E7%89%B9%E7%82%B9"><span class="toc-number">3.8.6.1.</span> <span class="toc-text">å›é¡¾ JSONP çš„æ¦‚å¿µä¸ç‰¹ç‚¹</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/blog/2023/03/29/29-NodeJs-2/" title="NodeJså­¦ä¹ ç¬”è®°(ä¸‹)"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.ax1x.com/2023/03/29/ppgU1oR.jpg" onerror="this.onerror=null;this.src='https://s1.ax1x.com/2023/03/21/ppa9N6g.jpg'" alt="NodeJså­¦ä¹ ç¬”è®°(ä¸‹)"/></a><div class="content"><a class="title" href="/blog/2023/03/29/29-NodeJs-2/" title="NodeJså­¦ä¹ ç¬”è®°(ä¸‹)">NodeJså­¦ä¹ ç¬”è®°(ä¸‹)</a><time datetime="2023-03-29T15:00:25.000Z" title="å‘è¡¨äº 2023-03-29 23:00:25">2023-03-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/blog/2023/03/29/29-NodeJs-1/" title="NodeJså­¦ä¹ ç¬”è®°(ä¸Š)"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.ax1x.com/2023/03/29/ppgUaOe.jpg" onerror="this.onerror=null;this.src='https://s1.ax1x.com/2023/03/21/ppa9N6g.jpg'" alt="NodeJså­¦ä¹ ç¬”è®°(ä¸Š)"/></a><div class="content"><a class="title" href="/blog/2023/03/29/29-NodeJs-1/" title="NodeJså­¦ä¹ ç¬”è®°(ä¸Š)">NodeJså­¦ä¹ ç¬”è®°(ä¸Š)</a><time datetime="2023-03-29T15:00:25.000Z" title="å‘è¡¨äº 2023-03-29 23:00:25">2023-03-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/blog/2023/03/29/29-vue/" title="vueçš„ä¸€äº›é—®é¢˜"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.ax1x.com/2023/03/29/ppgUGJx.jpg" onerror="this.onerror=null;this.src='https://s1.ax1x.com/2023/03/21/ppa9N6g.jpg'" alt="vueçš„ä¸€äº›é—®é¢˜"/></a><div class="content"><a class="title" href="/blog/2023/03/29/29-vue/" title="vueçš„ä¸€äº›é—®é¢˜">vueçš„ä¸€äº›é—®é¢˜</a><time datetime="2023-03-28T17:54:00.000Z" title="å‘è¡¨äº 2023-03-29 01:54:00">2023-03-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/blog/2023/03/27/27-Jquery/" title="Jquery"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.ax1x.com/2023/03/27/pps3V9s.jpg" onerror="this.onerror=null;this.src='https://s1.ax1x.com/2023/03/21/ppa9N6g.jpg'" alt="Jquery"/></a><div class="content"><a class="title" href="/blog/2023/03/27/27-Jquery/" title="Jquery">Jquery</a><time datetime="2023-03-26T17:02:08.000Z" title="å‘è¡¨äº 2023-03-27 01:02:08">2023-03-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/blog/2023/03/25/25-SpringBoot%E6%B3%A8%E6%84%8F%E7%82%B9/" title="å…³äºSpringBootçš„ä¸€äº›é—®é¢˜"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.ax1x.com/2023/03/25/ppr9O4H.jpg" onerror="this.onerror=null;this.src='https://s1.ax1x.com/2023/03/21/ppa9N6g.jpg'" alt="å…³äºSpringBootçš„ä¸€äº›é—®é¢˜"/></a><div class="content"><a class="title" href="/blog/2023/03/25/25-SpringBoot%E6%B3%A8%E6%84%8F%E7%82%B9/" title="å…³äºSpringBootçš„ä¸€äº›é—®é¢˜">å…³äºSpringBootçš„ä¸€äº›é—®é¢˜</a><time datetime="2023-03-25T15:33:02.000Z" title="å‘è¡¨äº 2023-03-25 23:33:02">2023-03-25</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2023 By ache</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="ç®€ç¹è½¬æ¢">ç¹</button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  æ•°æ®åº“åŠ è½½ä¸­</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/blog/js/utils.js"></script><script src="/blog/js/main.js"></script><script src="/blog/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/blog/js/search/local-search.js"></script><div class="js-pjax"></div><canvas id="universe"></canvas><script async src="//npm.elemecdn.com/pace-js@1.2.4/pace.min.js"></script><script defer src="//at.alicdn.com/t/c/font_3851233_0q2l7af05f19.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="50" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --><script data-pjax>
  function butterfly_footer_beautify_injector_config(){
    var parent_div_git = document.getElementById('footer-wrap');
    var item_html = '<div id="workboard"></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" data-title="ä¸»é¢˜ç‰ˆæœ¬Butterfly_v4.3.1" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&amp;logo=bitdefender" alt=""/></a><a class="github-badge" target="_blank" href="https://vercel.com/" style="margin-inline:5px" data-title="æœ¬ç«™é‡‡ç”¨å¤šçº¿éƒ¨ç½²ï¼Œä¸»çº¿è·¯æ‰˜ç®¡äºVercel" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Hosted-Vercel-brightgreen?style=flat&amp;logo=Vercel" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="æœ¬ç«™é¡¹ç›®ç”±Githubæ‰˜ç®¡" title=""><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=GitHub" alt=""/></a></p>';
    console.log('å·²æŒ‚è½½butterfly_footer_beautify')
    parent_div_git.insertAdjacentHTML("beforeend",item_html)
    }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_footer_beautify_injector_config();
  }
  else if (epage === cpage){
    butterfly_footer_beautify_injector_config();
  }
  </script><script async src="/blog/js/runtime.js"></script><script async src="//at.alicdn.com/t/font_2032782_8d5kxvn09md.js"></script><div class="js-pjax"><script async="async">var arr = document.getElementsByClassName('recent-post-item');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '2s');
    arr[i].setAttribute('data-wow-delay', '500ms');
    arr[i].setAttribute('data-wow-offset', '100');
    arr[i].setAttribute('data-wow-iteration', '1');
  }</script><script async="async">var arr = document.getElementsByClassName('card-widget');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__bounceInRight');
    arr[i].setAttribute('data-wow-duration', '');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script><script async="async">var arr = document.getElementsByClassName('pagination');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__rotateInDownLeft');
    arr[i].setAttribute('data-wow-duration', '');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script></div><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow.min.js"></script><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow_init.js"></script><!-- hexo injector body_end end --><script src="/blog/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/blog/live2dw/assets/wanko.model.json"},"display":{"position":"left","width":150,"height":300},"mobile":{"show":false},"log":false});</script></body></html>